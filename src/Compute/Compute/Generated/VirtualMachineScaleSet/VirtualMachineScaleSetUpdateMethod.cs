//
// Copyright (c) Microsoft and contributors.  All rights reserved.
//
// Licensed under the Apache License, Version 2.0 (the "License");
// you may not use this file except in compliance with the License.
// You may obtain a copy of the License at
//   http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
//
// See the License for the specific language governing permissions and
// limitations under the License.
//

// Warning: This code was generated by a tool.
//
// Changes to this file may cause incorrect behavior and will be lost if the
// code is regenerated.

using System;
using System.Collections;
using System.Collections.Generic;
using System.Linq;
using System.Xml;
using System.Management.Automation;
using Microsoft.Azure.Commands.Compute.Automation.Models;
using Microsoft.Azure.Commands.ResourceManager.Common.ArgumentCompleters;
using Microsoft.Azure.Management.Compute;
using Microsoft.Azure.Management.Compute.Models;
using Microsoft.WindowsAzure.Commands.Common.CustomAttributes;
using Microsoft.WindowsAzure.Commands.Utilities.Common;
using Microsoft.Azure.Commands.Compute.Common;

namespace Microsoft.Azure.Commands.Compute.Automation
{
    [Cmdlet(VerbsData.Update, ResourceManager.Common.AzureRMConstants.AzureRMPrefix + "Vmss", DefaultParameterSetName = "DefaultParameter", SupportsShouldProcess = true)]
    [OutputType(typeof(PSVirtualMachineScaleSet))]
    public partial class UpdateAzureRmVmss : ComputeAutomationBaseCmdlet
    {
        protected const string ExplicitIdentityParameterSet = "ExplicitIdentityParameterSet";

        public override void ExecuteCmdlet()
        {

            base.ExecuteCmdlet();
            ExecuteClientAction(() =>
            {
                if (ShouldProcess(this.VMScaleSetName, VerbsData.Update))
                {
                    string resourceGroupName = this.ResourceGroupName;
                    string vmScaleSetName = this.VMScaleSetName;
                    if (this.VirtualMachineScaleSet == null)
                    {
                        BuildPatchObject();
                    }
                    else
                    {
                        BuildPutObject();
                    }

                    // check if image reference is being updated, if not remove image reference from payload for SIG 
                    if (this.VirtualMachineScaleSet != null
                            && this.VirtualMachineScaleSet.VirtualMachineProfile != null
                            && this.VirtualMachineScaleSet.VirtualMachineProfile.StorageProfile != null
                            && this.VirtualMachineScaleSet.VirtualMachineProfile.StorageProfile.ImageReference != null
                            && this.VirtualMachineScaleSet.VirtualMachineProfile.StorageProfile.ImageReference.Id != null)
                    {
                        var newImageRef = this.VirtualMachineScaleSet.VirtualMachineProfile.StorageProfile.ImageReference;
                        var currVMSS = VirtualMachineScaleSetsClient.Get(resourceGroupName, vmScaleSetName);
                        var currImageRef = currVMSS.VirtualMachineProfile.StorageProfile.ImageReference;
                        if (currImageRef.Id == newImageRef.Id)
                        {
                            this.VirtualMachineScaleSet.VirtualMachineProfile.StorageProfile.ImageReference = null;
                        }
                    }

                    VirtualMachineScaleSetUpdate parametersupdate = this.VirtualMachineScaleSetUpdate;
                    VirtualMachineScaleSet parameters = new VirtualMachineScaleSet();
                    ComputeAutomationAutoMapperProfile.Mapper.Map<PSVirtualMachineScaleSet, VirtualMachineScaleSet>(this.VirtualMachineScaleSet, parameters);

                    var result = (this.VirtualMachineScaleSetUpdate == null)
                                 ? VirtualMachineScaleSetsClient.CreateOrUpdate(resourceGroupName, vmScaleSetName, parameters, this.IfMatch, this.IfNoneMatch)
                                 : VirtualMachineScaleSetsClient.Update(resourceGroupName, vmScaleSetName, parametersupdate, this.IfMatch, this.IfNoneMatch);
                    var psObject = new PSVirtualMachineScaleSet();
                    ComputeAutomationAutoMapperProfile.Mapper.Map<VirtualMachineScaleSet, PSVirtualMachineScaleSet>(result, psObject);
                    WriteObject(psObject);
                }
            });
        }

        [Parameter(
            Position = 0,
            Mandatory = true,
            ValueFromPipelineByPropertyName = true)]
        [ResourceGroupCompleter]
        public string ResourceGroupName { get; set; }

        [Parameter(
            Position = 1,
            Mandatory = true,
            ValueFromPipelineByPropertyName = true)]
        [ResourceNameCompleter("Microsoft.Compute/virtualMachineScaleSets", "ResourceGroupName")]
        [Alias("Name")]
        public string VMScaleSetName { get; set; }

        public VirtualMachineScaleSetUpdate VirtualMachineScaleSetUpdate { get; set; }

        [Parameter(
            Position = 2,
            Mandatory = false,
            ValueFromPipelineByPropertyName = false,
            ValueFromPipeline = true)]
        [AllowNull]
        public PSVirtualMachineScaleSet VirtualMachineScaleSet { get; set; }

        [Parameter(
            Mandatory = false,
            HelpMessage = "Whether OS upgrades should automatically be applied to scale set instances in a rolling fashion when a newer version of the image becomes available.")]
        public bool AutomaticOSUpgrade { get; set; }

        [Parameter(
            Mandatory = false)]
        [ValidateNotNullOrEmpty]
        public string AutomaticRepairGracePeriod { get; set; }

        [Parameter(
            Mandatory = false)]
        public bool EnableAutomaticRepair { get; set; }

        [Parameter(
            Mandatory = false,
            HelpMessage = "Type of repair action (replace, restart, reimage) that will be used for repairing unhealthy virtual machines in the scale set. Default value is replace.",
            ValueFromPipelineByPropertyName = true)]
        [ValidateSet(ValidateSetValues.Replace, ValidateSetValues.Restart, ValidateSetValues.Reimage, IgnoreCase = true)]
        [PSArgumentCompleter("Replace", "Restart", "Reimage")]
        public string AutomaticRepairAction { get; set; }

        [Parameter(
            Mandatory = false)]
        public bool BootDiagnosticsEnabled { get; set; }

        [Parameter(
            Mandatory = false)]
        [ValidateNotNullOrEmpty]
        public string BootDiagnosticsStorageUri { get; set; }

        [Parameter(
            Mandatory = false)]
        [ValidateNotNullOrEmpty]
        public string CustomData { get; set; }

        [Parameter(
            Mandatory = false)]
        public bool DisableAutoRollback { get; set; }

        [Parameter(
            Mandatory = false)]
        public bool DisablePasswordAuthentication { get; set; }

        [Parameter(
            Mandatory = false)]
        public bool EnableAutomaticUpdate { get; set; }

        [Parameter(
            ParameterSetName = ExplicitIdentityParameterSet,
            Mandatory = false)]
        [ValidateNotNullOrEmpty]
        public string[] IdentityId { get; set; }

        [Parameter(
            ParameterSetName = ExplicitIdentityParameterSet,
            Mandatory = true)]
        [ValidateNotNullOrEmpty]
        public ResourceIdentityType? IdentityType { get; set; }

        [Parameter(
            Mandatory = false)]
        [ValidateNotNullOrEmpty]
        public string ImageReferenceId { get; set; }

        [Parameter(
            Mandatory = false)]
        [ValidateNotNullOrEmpty]
        public string ImageReferenceOffer { get; set; }

        [Parameter(
            Mandatory = false)]
        [ValidateNotNullOrEmpty]
        public string ImageReferencePublisher { get; set; }

        [Parameter(
            Mandatory = false)]
        [ValidateNotNullOrEmpty]
        public string ImageReferenceSku { get; set; }

        [Parameter(
            Mandatory = false)]
        [ValidateNotNullOrEmpty]
        public string ImageReferenceVersion { get; set; }

        [Parameter(
            Mandatory = false)]
        [ValidateNotNullOrEmpty]
        public string ImageUri { get; set; }

        [Parameter(
            Mandatory = false)]
        [ValidateNotNullOrEmpty]
        public string LicenseType { get; set; }

        [Parameter(
            Mandatory = false)]
        [ValidateNotNullOrEmpty]
        [PSArgumentCompleter("Standard_LRS", "Premium_LRS", "StandardSSD_LRS", "UltraSSD_LRS")]
        public string ManagedDiskStorageAccountType { get; set; }

        [Parameter(
            Mandatory = false)]
        public int MaxBatchInstancePercent { get; set; }

        [Parameter(
            Mandatory = false)]
        public double MaxPrice { get; set; }

        [Parameter(
            Mandatory = false)]
        public int MaxUnhealthyInstancePercent { get; set; }

        [Parameter(
            Mandatory = false)]
        public int MaxUnhealthyUpgradedInstancePercent { get; set; }

        [Parameter(
            Mandatory = false)]
        public CachingTypes OsDiskCaching { get; set; }

        [Parameter(
            Mandatory = false)]
        public bool OsDiskWriteAccelerator { get; set; }

        [Parameter(
            Mandatory = false)]
        public bool Overprovision { get; set; }

        [Parameter(
            Mandatory = false)]
        public bool ScaleInPolicyForceDeletion { get; set; }

        [Parameter(
            Mandatory = false)]
        [ValidateNotNullOrEmpty]
        public string PauseTimeBetweenBatches { get; set; }

        [Parameter(
            Mandatory = false)]
        [ValidateNotNullOrEmpty]
        public string PlanName { get; set; }

        [Parameter(
            Mandatory = false)]
        [ValidateNotNullOrEmpty]
        public string PlanProduct { get; set; }

        [Parameter(
            Mandatory = false)]
        [ValidateNotNullOrEmpty]
        public string PlanPromotionCode { get; set; }

        [Parameter(
            Mandatory = false)]
        [ValidateNotNullOrEmpty]
        public string PlanPublisher { get; set; }

        [Parameter(
            Mandatory = false)]
        public bool ProvisionVMAgent { get; set; }

        [Parameter(
            Mandatory = false)]
        [AllowEmptyString]
        public string ProximityPlacementGroupId { get; set; }

        [Parameter(
            Mandatory = false)]
        [ValidateNotNullOrEmpty]
        public string[] ScaleInPolicy { get; set; }

        [Parameter(
            Mandatory = false)]
        public bool SinglePlacementGroup { get; set; }

        [Parameter(
            Mandatory = false)]
        public bool SkipExtensionsOnOverprovisionedVMs { get; set; }

        [Parameter(
            Mandatory = false)]
        public int SkuCapacity { get; set; }

        [Parameter(
            Mandatory = false)]
        [ValidateNotNullOrEmpty]
        public string SkuName { get; set; }

        [Parameter(
            Mandatory = false)]
        [ValidateNotNullOrEmpty]
        public string SkuTier { get; set; }

        [Parameter(
            Mandatory = false)]
        [ValidateNotNullOrEmpty]
        public Hashtable Tag { get; set; }

        [Parameter(
            Mandatory = false,
            ValueFromPipelineByPropertyName = true)]
        public int TerminateScheduledEventNotBeforeTimeoutInMinutes { get; set; }

        [Parameter(
            Mandatory = false,
            ValueFromPipelineByPropertyName = true)]
        public bool TerminateScheduledEvents { get; set; }

        [Parameter(
            Mandatory = false)]
        [ValidateNotNullOrEmpty]
        public string TimeZone { get; set; }

        [Parameter(
          Mandatory = false,
          ValueFromPipelineByPropertyName = true)]
        public bool UltraSSDEnabled { get; set; }

        [Parameter(
            Mandatory = false)]
        public UpgradeMode UpgradePolicyMode { get; set; }

        [Parameter(
            Mandatory = false,
            HelpMessage = "Id of the capacity reservation Group that is used to allocate.")]
        [ResourceIdCompleter("Microsoft.Compute/capacityReservationGroups")]
        public string CapacityReservationGroupId { get; set; }

        [Parameter(
            Mandatory = false)]
        [ValidateNotNullOrEmpty]
        public string[] VhdContainer { get; set; }

        [Parameter(Mandatory = false, HelpMessage = "Run cmdlet in the background")]
        public SwitchParameter AsJob { get; set; }

        [Parameter(
            Mandatory = false)]
        public bool EncryptionAtHost { get; set; }

        [Parameter(
            Mandatory = false,
            HelpMessage = "UserData for the Vmss, which will be Base64 encoded. Customer should not pass any secrets in here.",
            ValueFromPipelineByPropertyName = true)]
        public string UserData { get; set; }

        [Parameter(
            Mandatory = false,
            HelpMessage = "The number of VMs that should be regular priority VMs before adding any Spot VMs",
            ValueFromPipelineByPropertyName = true)]
        public int BaseRegularPriorityCount { get; set; }

        [Parameter(
            Mandatory = false,
            HelpMessage = "The percentage of VMs that should be regular priority after the base number of regular priority VMs has been reached",
            ValueFromPipelineByPropertyName = true)]
        public int RegularPriorityPercentage { get; set; }

        [Parameter(
            Mandatory = false,
            HelpMessage = "Specified the shared gallery image unique id for vm deployment. This can be fetched from shared gallery image GET call.")]
        public string SharedGalleryImageId { get; set; }

        [Parameter(
            Mandatory = false,
            HelpMessage = "Specifies whether the OS Image Scheduled event is enabled or disabled.")]
        public SwitchParameter OSImageScheduledEventEnabled { get; set; }

        [Parameter(
            Mandatory = false,
            HelpMessage = "The length of time a virtual machine being reimaged or having its OS upgraded will have to potentially approve the OS Image Scheduled Event before the event is auto approved (timed out). The configuration is specified in ISO 8601 format, with the value set to 15 minutes (PT15M).")]
        public string OSImageScheduledEventNotBeforeTimeoutInMinutes { get; set; }

        [Parameter(
           HelpMessage = "Specifies the SecurityType of the virtual machine. It has to be set to any specified value to enable UefiSettings. UefiSettings will not be enabled unless this property is set.",
           ValueFromPipelineByPropertyName = true,
           Mandatory = false)]
        [ValidateSet(ValidateSetValues.TrustedLaunch, ValidateSetValues.ConfidentialVM, ValidateSetValues.Standard, IgnoreCase = true)]
        [PSArgumentCompleter("TrustedLaunch", "ConfidentialVM", "Standard")]
        public string SecurityType { get; set; }

        [Parameter(
        HelpMessage = "Specifies whether vTPM should be enabled on the virtual machine.",
        ValueFromPipelineByPropertyName = true,
        Mandatory = false)]
        public bool? EnableVtpm { get; set; } = null;

        [Parameter(
           HelpMessage = "Specifies whether secure boot should be enabled on the virtual machine.",
           ValueFromPipelineByPropertyName = true,
           Mandatory = false)]
        public bool? EnableSecureBoot { get; set; } = null;

        [Parameter(
            Mandatory = false,
            ValueFromPipelineByPropertyName = true,
            HelpMessage = "used to make a request conditional for the PUT and other non-safe methods. The server will only return the requested resources if the resource matches one of the listed ETag values. Omit this value to always overwrite the current resource. Specify the last-seen ETag value to prevent accidentally overwriting concurrent changes.")]
        public string IfMatch { get; set; }

        [Parameter(
            Mandatory = false,
            ValueFromPipelineByPropertyName = true,
            HelpMessage = "Used to make a request conditional for the GET and HEAD methods. The server will only return the requested resources if none of the listed ETag values match the current entity. Used to make a request conditional for the GET and HEAD methods. The server will only return the requested resources if none of the listed ETag values match the current entity. Set to '*' to allow a new record set to be created, but to prevent updating an existing record set. Other values will result in error from server as they are not supported.")]
        public string IfNoneMatch { get; set; }

        [Parameter(
            Mandatory = false,
            HelpMessage = "Array of VM sizes for the scale set.",
            ValueFromPipelineByPropertyName = true)]
        public string[] SkuProfileVmSize { get; set; }

        [Parameter(
            Mandatory = false,
            HelpMessage = "Allocation strategy for the SKU profile.",
            ValueFromPipelineByPropertyName = true)]
        [ValidateSet("LowestPrice", "CapacityOptimized")]
        public string SkuProfileAllocationStrategy { get; set; }

        [Parameter(
            Mandatory = false,
            HelpMessage = "Specifies whether resilient VM creation should be enabled on the virtual machine scale set. The default value is false.")]
        public bool EnableResilientVMCreate { get; set; }

        [Parameter(
            Mandatory = false,
            HelpMessage = "Specifies whether resilient VM deletion should be enabled on the virtual machine scale set. The default value is false.")]
        public bool EnableResilientVMDelete { get; set; }

        private void BuildPatchObject()
        {
            if (this.IsParameterBound(c => c.AutomaticOSUpgrade))
            {
                if (this.VirtualMachineScaleSetUpdate == null)
                {
                    this.VirtualMachineScaleSetUpdate = new VirtualMachineScaleSetUpdate();
                }
                if (this.VirtualMachineScaleSetUpdate.UpgradePolicy == null)
                {
                    this.VirtualMachineScaleSetUpdate.UpgradePolicy = new UpgradePolicy();
                }
                if (this.VirtualMachineScaleSetUpdate.UpgradePolicy.AutomaticOSUpgradePolicy == null)
                {
                    this.VirtualMachineScaleSetUpdate.UpgradePolicy.AutomaticOSUpgradePolicy = new AutomaticOSUpgradePolicy();
                }
                this.VirtualMachineScaleSetUpdate.UpgradePolicy.AutomaticOSUpgradePolicy.EnableAutomaticOSUpgrade = this.AutomaticOSUpgrade;
            }

            if (this.IsParameterBound(c => c.AutomaticRepairGracePeriod))
            {
                if (this.VirtualMachineScaleSetUpdate == null)
                {
                    this.VirtualMachineScaleSetUpdate = new VirtualMachineScaleSetUpdate();
                }
                if (this.VirtualMachineScaleSetUpdate.AutomaticRepairsPolicy == null)
                {
                    this.VirtualMachineScaleSetUpdate.AutomaticRepairsPolicy = new AutomaticRepairsPolicy();
                }
                this.VirtualMachineScaleSetUpdate.AutomaticRepairsPolicy.GracePeriod = this.AutomaticRepairGracePeriod;
            }

            if (this.IsParameterBound(c => c.EnableAutomaticRepair))
            {
                if (this.VirtualMachineScaleSetUpdate == null)
                {
                    this.VirtualMachineScaleSetUpdate = new VirtualMachineScaleSetUpdate();
                }
                if (this.VirtualMachineScaleSetUpdate.AutomaticRepairsPolicy == null)
                {
                    this.VirtualMachineScaleSetUpdate.AutomaticRepairsPolicy = new AutomaticRepairsPolicy();
                }
                this.VirtualMachineScaleSetUpdate.AutomaticRepairsPolicy.Enabled = this.EnableAutomaticRepair;
            }

            if (this.IsParameterBound(c => c.AutomaticRepairAction))
            {
                if (this.VirtualMachineScaleSetUpdate == null)
                {
                    this.VirtualMachineScaleSetUpdate = new VirtualMachineScaleSetUpdate();
                }
                if (this.VirtualMachineScaleSetUpdate.AutomaticRepairsPolicy == null)
                {
                    this.VirtualMachineScaleSetUpdate.AutomaticRepairsPolicy = new AutomaticRepairsPolicy();
                }
                this.VirtualMachineScaleSetUpdate.AutomaticRepairsPolicy.RepairAction = this.AutomaticRepairAction;
            }

            if (this.IsParameterBound(c => c.BootDiagnosticsEnabled))
            {
                if (this.VirtualMachineScaleSetUpdate == null)
                {
                    this.VirtualMachineScaleSetUpdate = new VirtualMachineScaleSetUpdate();
                }
                if (this.VirtualMachineScaleSetUpdate.VirtualMachineProfile == null)
                {
                    this.VirtualMachineScaleSetUpdate.VirtualMachineProfile = new VirtualMachineScaleSetUpdateVMProfile();
                }
                if (this.VirtualMachineScaleSetUpdate.VirtualMachineProfile.DiagnosticsProfile == null)
                {
                    this.VirtualMachineScaleSetUpdate.VirtualMachineProfile.DiagnosticsProfile = new DiagnosticsProfile();
                }
                if (this.VirtualMachineScaleSetUpdate.VirtualMachineProfile.DiagnosticsProfile.BootDiagnostics == null)
                {
                    this.VirtualMachineScaleSetUpdate.VirtualMachineProfile.DiagnosticsProfile.BootDiagnostics = new BootDiagnostics();
                }
                this.VirtualMachineScaleSetUpdate.VirtualMachineProfile.DiagnosticsProfile.BootDiagnostics.Enabled = this.BootDiagnosticsEnabled;
            }

            if (this.IsParameterBound(c => c.BootDiagnosticsStorageUri))
            {
                if (this.VirtualMachineScaleSetUpdate == null)
                {
                    this.VirtualMachineScaleSetUpdate = new VirtualMachineScaleSetUpdate();
                }
                if (this.VirtualMachineScaleSetUpdate.VirtualMachineProfile == null)
                {
                    this.VirtualMachineScaleSetUpdate.VirtualMachineProfile = new VirtualMachineScaleSetUpdateVMProfile();
                }
                if (this.VirtualMachineScaleSetUpdate.VirtualMachineProfile.DiagnosticsProfile == null)
                {
                    this.VirtualMachineScaleSetUpdate.VirtualMachineProfile.DiagnosticsProfile = new DiagnosticsProfile();
                }
                if (this.VirtualMachineScaleSetUpdate.VirtualMachineProfile.DiagnosticsProfile.BootDiagnostics == null)
                {
                    this.VirtualMachineScaleSetUpdate.VirtualMachineProfile.DiagnosticsProfile.BootDiagnostics = new BootDiagnostics();
                }
                this.VirtualMachineScaleSetUpdate.VirtualMachineProfile.DiagnosticsProfile.BootDiagnostics.StorageUri = this.BootDiagnosticsStorageUri;
            }

            if (this.IsParameterBound(c => c.CustomData))
            {
                if (this.VirtualMachineScaleSetUpdate == null)
                {
                    this.VirtualMachineScaleSetUpdate = new VirtualMachineScaleSetUpdate();
                }
                if (this.VirtualMachineScaleSetUpdate.VirtualMachineProfile == null)
                {
                    this.VirtualMachineScaleSetUpdate.VirtualMachineProfile = new VirtualMachineScaleSetUpdateVMProfile();
                }
                if (this.VirtualMachineScaleSetUpdate.VirtualMachineProfile.OsProfile == null)
                {
                    this.VirtualMachineScaleSetUpdate.VirtualMachineProfile.OsProfile = new VirtualMachineScaleSetUpdateOSProfile();
                }
                this.VirtualMachineScaleSetUpdate.VirtualMachineProfile.OsProfile.CustomData = this.CustomData;
            }

            if (this.IsParameterBound(c => c.DisableAutoRollback))
            {
                if (this.VirtualMachineScaleSetUpdate == null)
                {
                    this.VirtualMachineScaleSetUpdate = new VirtualMachineScaleSetUpdate();
                }
                if (this.VirtualMachineScaleSetUpdate.UpgradePolicy == null)
                {
                    this.VirtualMachineScaleSetUpdate.UpgradePolicy = new UpgradePolicy();
                }
                if (this.VirtualMachineScaleSetUpdate.UpgradePolicy.AutomaticOSUpgradePolicy == null)
                {
                    this.VirtualMachineScaleSetUpdate.UpgradePolicy.AutomaticOSUpgradePolicy = new AutomaticOSUpgradePolicy();
                }
                this.VirtualMachineScaleSetUpdate.UpgradePolicy.AutomaticOSUpgradePolicy.DisableAutomaticRollback = this.DisableAutoRollback;
            }

            if (this.IsParameterBound(c => c.DisablePasswordAuthentication))
            {
                if (this.VirtualMachineScaleSetUpdate == null)
                {
                    this.VirtualMachineScaleSetUpdate = new VirtualMachineScaleSetUpdate();
                }
                if (this.VirtualMachineScaleSetUpdate.VirtualMachineProfile == null)
                {
                    this.VirtualMachineScaleSetUpdate.VirtualMachineProfile = new VirtualMachineScaleSetUpdateVMProfile();
                }
                if (this.VirtualMachineScaleSetUpdate.VirtualMachineProfile.OsProfile == null)
                {
                    this.VirtualMachineScaleSetUpdate.VirtualMachineProfile.OsProfile = new VirtualMachineScaleSetUpdateOSProfile();
                }
                if (this.VirtualMachineScaleSetUpdate.VirtualMachineProfile.OsProfile.LinuxConfiguration == null)
                {
                    this.VirtualMachineScaleSetUpdate.VirtualMachineProfile.OsProfile.LinuxConfiguration = new LinuxConfiguration();
                }
                this.VirtualMachineScaleSetUpdate.VirtualMachineProfile.OsProfile.LinuxConfiguration.DisablePasswordAuthentication = this.DisablePasswordAuthentication;
            }

            if (this.IsParameterBound(c => c.EnableAutomaticUpdate))
            {
                if (this.VirtualMachineScaleSetUpdate == null)
                {
                    this.VirtualMachineScaleSetUpdate = new VirtualMachineScaleSetUpdate();
                }
                if (this.VirtualMachineScaleSetUpdate.VirtualMachineProfile == null)
                {
                    this.VirtualMachineScaleSetUpdate.VirtualMachineProfile = new VirtualMachineScaleSetUpdateVMProfile();
                }
                if (this.VirtualMachineScaleSetUpdate.VirtualMachineProfile.OsProfile == null)
                {
                    this.VirtualMachineScaleSetUpdate.VirtualMachineProfile.OsProfile = new VirtualMachineScaleSetUpdateOSProfile();
                }
                if (this.VirtualMachineScaleSetUpdate.VirtualMachineProfile.OsProfile.WindowsConfiguration == null)
                {
                    this.VirtualMachineScaleSetUpdate.VirtualMachineProfile.OsProfile.WindowsConfiguration = new WindowsConfiguration();
                }
                this.VirtualMachineScaleSetUpdate.VirtualMachineProfile.OsProfile.WindowsConfiguration.EnableAutomaticUpdates = this.EnableAutomaticUpdate;
            }

            if (this.IsParameterBound(c => c.IdentityId))
            {
                if (this.VirtualMachineScaleSetUpdate == null)
                {
                    this.VirtualMachineScaleSetUpdate = new VirtualMachineScaleSetUpdate();
                }
                if (this.VirtualMachineScaleSetUpdate.Identity == null)
                {
                    this.VirtualMachineScaleSetUpdate.Identity = new VirtualMachineScaleSetIdentity();
                }

                this.VirtualMachineScaleSetUpdate.Identity.UserAssignedIdentities = new Dictionary<string, UserAssignedIdentitiesValue>();

                foreach (var id in this.IdentityId)
                {
                    if (!this.VirtualMachineScaleSetUpdate.Identity.UserAssignedIdentities.ContainsKey(id))
                    {
                        this.VirtualMachineScaleSetUpdate.Identity.UserAssignedIdentities.Add(id, new UserAssignedIdentitiesValue());
                    }
                }
            }

            if (this.IsParameterBound(c => c.IdentityType))
            {
                if (this.VirtualMachineScaleSetUpdate == null)
                {
                    this.VirtualMachineScaleSetUpdate = new VirtualMachineScaleSetUpdate();
                }
                if (this.VirtualMachineScaleSetUpdate.Identity == null)
                {
                    this.VirtualMachineScaleSetUpdate.Identity = new VirtualMachineScaleSetIdentity();
                }
                this.VirtualMachineScaleSetUpdate.Identity.Type = this.IdentityType;
            }

            if (this.IsParameterBound(c => c.ImageReferenceId))
            {
                if (this.VirtualMachineScaleSetUpdate == null)
                {
                    this.VirtualMachineScaleSetUpdate = new VirtualMachineScaleSetUpdate();
                }
                if (this.VirtualMachineScaleSetUpdate.VirtualMachineProfile == null)
                {
                    this.VirtualMachineScaleSetUpdate.VirtualMachineProfile = new VirtualMachineScaleSetUpdateVMProfile();
                }
                if (this.VirtualMachineScaleSetUpdate.VirtualMachineProfile.StorageProfile == null)
                {
                    this.VirtualMachineScaleSetUpdate.VirtualMachineProfile.StorageProfile = new VirtualMachineScaleSetUpdateStorageProfile();
                }
                if (this.VirtualMachineScaleSetUpdate.VirtualMachineProfile.StorageProfile.ImageReference == null)
                {
                    this.VirtualMachineScaleSetUpdate.VirtualMachineProfile.StorageProfile.ImageReference = new ImageReference();
                }
                this.VirtualMachineScaleSetUpdate.VirtualMachineProfile.StorageProfile.ImageReference.Id = this.ImageReferenceId;
            }

            if (this.IsParameterBound(c => c.SharedGalleryImageId))
            {
                if (this.VirtualMachineScaleSetUpdate == null)
                {
                    this.VirtualMachineScaleSetUpdate = new VirtualMachineScaleSetUpdate();
                }
                if (this.VirtualMachineScaleSetUpdate.VirtualMachineProfile == null)
                {
                    this.VirtualMachineScaleSetUpdate.VirtualMachineProfile = new VirtualMachineScaleSetUpdateVMProfile();
                }
                if (this.VirtualMachineScaleSetUpdate.VirtualMachineProfile.StorageProfile == null)
                {
                    this.VirtualMachineScaleSetUpdate.VirtualMachineProfile.StorageProfile = new VirtualMachineScaleSetUpdateStorageProfile();
                }
                if (this.VirtualMachineScaleSetUpdate.VirtualMachineProfile.StorageProfile.ImageReference == null)
                {
                    this.VirtualMachineScaleSetUpdate.VirtualMachineProfile.StorageProfile.ImageReference = new ImageReference();
                }
                this.VirtualMachineScaleSetUpdate.VirtualMachineProfile.StorageProfile.ImageReference.SharedGalleryImageId = this.SharedGalleryImageId;
            }


            if (this.IsParameterBound(c => c.ImageReferenceOffer))
            {
                if (this.VirtualMachineScaleSetUpdate == null)
                {
                    this.VirtualMachineScaleSetUpdate = new VirtualMachineScaleSetUpdate();
                }
                if (this.VirtualMachineScaleSetUpdate.VirtualMachineProfile == null)
                {
                    this.VirtualMachineScaleSetUpdate.VirtualMachineProfile = new VirtualMachineScaleSetUpdateVMProfile();
                }
                if (this.VirtualMachineScaleSetUpdate.VirtualMachineProfile.StorageProfile == null)
                {
                    this.VirtualMachineScaleSetUpdate.VirtualMachineProfile.StorageProfile = new VirtualMachineScaleSetUpdateStorageProfile();
                }
                if (this.VirtualMachineScaleSetUpdate.VirtualMachineProfile.StorageProfile.ImageReference == null)
                {
                    this.VirtualMachineScaleSetUpdate.VirtualMachineProfile.StorageProfile.ImageReference = new ImageReference();
                }
                this.VirtualMachineScaleSetUpdate.VirtualMachineProfile.StorageProfile.ImageReference.Offer = this.ImageReferenceOffer;
            }

            if (this.IsParameterBound(c => c.ImageReferencePublisher))
            {
                if (this.VirtualMachineScaleSetUpdate == null)
                {
                    this.VirtualMachineScaleSetUpdate = new VirtualMachineScaleSetUpdate();
                }
                if (this.VirtualMachineScaleSetUpdate.VirtualMachineProfile == null)
                {
                    this.VirtualMachineScaleSetUpdate.VirtualMachineProfile = new VirtualMachineScaleSetUpdateVMProfile();
                }
                if (this.VirtualMachineScaleSetUpdate.VirtualMachineProfile.StorageProfile == null)
                {
                    this.VirtualMachineScaleSetUpdate.VirtualMachineProfile.StorageProfile = new VirtualMachineScaleSetUpdateStorageProfile();
                }
                if (this.VirtualMachineScaleSetUpdate.VirtualMachineProfile.StorageProfile.ImageReference == null)
                {
                    this.VirtualMachineScaleSetUpdate.VirtualMachineProfile.StorageProfile.ImageReference = new ImageReference();
                }
                this.VirtualMachineScaleSetUpdate.VirtualMachineProfile.StorageProfile.ImageReference.Publisher = this.ImageReferencePublisher;
            }

            if (this.IsParameterBound(c => c.ImageReferenceSku))
            {
                if (this.VirtualMachineScaleSetUpdate == null)
                {
                    this.VirtualMachineScaleSetUpdate = new VirtualMachineScaleSetUpdate();
                }
                if (this.VirtualMachineScaleSetUpdate.VirtualMachineProfile == null)
                {
                    this.VirtualMachineScaleSetUpdate.VirtualMachineProfile = new VirtualMachineScaleSetUpdateVMProfile();
                }
                if (this.VirtualMachineScaleSetUpdate.VirtualMachineProfile.StorageProfile == null)
                {
                    this.VirtualMachineScaleSetUpdate.VirtualMachineProfile.StorageProfile = new VirtualMachineScaleSetUpdateStorageProfile();
                }
                if (this.VirtualMachineScaleSetUpdate.VirtualMachineProfile.StorageProfile.ImageReference == null)
                {
                    this.VirtualMachineScaleSetUpdate.VirtualMachineProfile.StorageProfile.ImageReference = new ImageReference();
                }
                this.VirtualMachineScaleSetUpdate.VirtualMachineProfile.StorageProfile.ImageReference.Sku = this.ImageReferenceSku;
            }

            if (this.IsParameterBound(c => c.ImageReferenceVersion))
            {
                if (this.VirtualMachineScaleSetUpdate == null)
                {
                    this.VirtualMachineScaleSetUpdate = new VirtualMachineScaleSetUpdate();
                }
                if (this.VirtualMachineScaleSetUpdate.VirtualMachineProfile == null)
                {
                    this.VirtualMachineScaleSetUpdate.VirtualMachineProfile = new VirtualMachineScaleSetUpdateVMProfile();
                }
                if (this.VirtualMachineScaleSetUpdate.VirtualMachineProfile.StorageProfile == null)
                {
                    this.VirtualMachineScaleSetUpdate.VirtualMachineProfile.StorageProfile = new VirtualMachineScaleSetUpdateStorageProfile();
                }
                if (this.VirtualMachineScaleSetUpdate.VirtualMachineProfile.StorageProfile.ImageReference == null)
                {
                    this.VirtualMachineScaleSetUpdate.VirtualMachineProfile.StorageProfile.ImageReference = new ImageReference();
                }
                this.VirtualMachineScaleSetUpdate.VirtualMachineProfile.StorageProfile.ImageReference.Version = this.ImageReferenceVersion;
            }

            if (this.IsParameterBound(c => c.ImageUri))
            {
                if (this.VirtualMachineScaleSetUpdate == null)
                {
                    this.VirtualMachineScaleSetUpdate = new VirtualMachineScaleSetUpdate();
                }
                if (this.VirtualMachineScaleSetUpdate.VirtualMachineProfile == null)
                {
                    this.VirtualMachineScaleSetUpdate.VirtualMachineProfile = new VirtualMachineScaleSetUpdateVMProfile();
                }
                if (this.VirtualMachineScaleSetUpdate.VirtualMachineProfile.StorageProfile == null)
                {
                    this.VirtualMachineScaleSetUpdate.VirtualMachineProfile.StorageProfile = new VirtualMachineScaleSetUpdateStorageProfile();
                }
                if (this.VirtualMachineScaleSetUpdate.VirtualMachineProfile.StorageProfile.OsDisk == null)
                {
                    this.VirtualMachineScaleSetUpdate.VirtualMachineProfile.StorageProfile.OsDisk = new VirtualMachineScaleSetUpdateOSDisk();
                }
                if (this.VirtualMachineScaleSetUpdate.VirtualMachineProfile.StorageProfile.OsDisk.Image == null)
                {
                    this.VirtualMachineScaleSetUpdate.VirtualMachineProfile.StorageProfile.OsDisk.Image = new VirtualHardDisk();
                }
                this.VirtualMachineScaleSetUpdate.VirtualMachineProfile.StorageProfile.OsDisk.Image.Uri = this.ImageUri;
            }

            if (this.IsParameterBound(c => c.LicenseType))
            {
                if (this.VirtualMachineScaleSetUpdate == null)
                {
                    this.VirtualMachineScaleSetUpdate = new VirtualMachineScaleSetUpdate();
                }
                if (this.VirtualMachineScaleSetUpdate.VirtualMachineProfile == null)
                {
                    this.VirtualMachineScaleSetUpdate.VirtualMachineProfile = new VirtualMachineScaleSetUpdateVMProfile();
                }
                this.VirtualMachineScaleSetUpdate.VirtualMachineProfile.LicenseType = this.LicenseType;
            }

            if (this.IsParameterBound(c => c.ManagedDiskStorageAccountType))
            {
                if (this.VirtualMachineScaleSetUpdate == null)
                {
                    this.VirtualMachineScaleSetUpdate = new VirtualMachineScaleSetUpdate();
                }
                if (this.VirtualMachineScaleSetUpdate.VirtualMachineProfile == null)
                {
                    this.VirtualMachineScaleSetUpdate.VirtualMachineProfile = new VirtualMachineScaleSetUpdateVMProfile();
                }
                if (this.VirtualMachineScaleSetUpdate.VirtualMachineProfile.StorageProfile == null)
                {
                    this.VirtualMachineScaleSetUpdate.VirtualMachineProfile.StorageProfile = new VirtualMachineScaleSetUpdateStorageProfile();
                }
                if (this.VirtualMachineScaleSetUpdate.VirtualMachineProfile.StorageProfile.OsDisk == null)
                {
                    this.VirtualMachineScaleSetUpdate.VirtualMachineProfile.StorageProfile.OsDisk = new VirtualMachineScaleSetUpdateOSDisk();
                }
                if (this.VirtualMachineScaleSetUpdate.VirtualMachineProfile.StorageProfile.OsDisk.ManagedDisk == null)
                {
                    this.VirtualMachineScaleSetUpdate.VirtualMachineProfile.StorageProfile.OsDisk.ManagedDisk = new VirtualMachineScaleSetManagedDiskParameters();
                }
                this.VirtualMachineScaleSetUpdate.VirtualMachineProfile.StorageProfile.OsDisk.ManagedDisk.StorageAccountType = this.ManagedDiskStorageAccountType;
            }

            if (this.IsParameterBound(c => c.MaxBatchInstancePercent))
            {
                if (this.VirtualMachineScaleSetUpdate == null)
                {
                    this.VirtualMachineScaleSetUpdate = new VirtualMachineScaleSetUpdate();
                }
                if (this.VirtualMachineScaleSetUpdate.UpgradePolicy == null)
                {
                    this.VirtualMachineScaleSetUpdate.UpgradePolicy = new UpgradePolicy();
                }
                if (this.VirtualMachineScaleSetUpdate.UpgradePolicy.RollingUpgradePolicy == null)
                {
                    this.VirtualMachineScaleSetUpdate.UpgradePolicy.RollingUpgradePolicy = new RollingUpgradePolicy();
                }
                this.VirtualMachineScaleSetUpdate.UpgradePolicy.RollingUpgradePolicy.MaxBatchInstancePercent = this.MaxBatchInstancePercent;
            }

            if (this.IsParameterBound(c => c.MaxPrice))
            {
                if (this.VirtualMachineScaleSetUpdate == null)
                {
                    this.VirtualMachineScaleSetUpdate = new VirtualMachineScaleSetUpdate();
                }
                if (this.VirtualMachineScaleSetUpdate.VirtualMachineProfile == null)
                {
                    this.VirtualMachineScaleSetUpdate.VirtualMachineProfile = new VirtualMachineScaleSetUpdateVMProfile();
                }
                if (this.VirtualMachineScaleSetUpdate.VirtualMachineProfile.BillingProfile == null)
                {
                    this.VirtualMachineScaleSetUpdate.VirtualMachineProfile.BillingProfile = new BillingProfile();
                }
                this.VirtualMachineScaleSetUpdate.VirtualMachineProfile.BillingProfile.MaxPrice = this.MaxPrice;
            }

            if (this.IsParameterBound(c => c.MaxUnhealthyInstancePercent))
            {
                if (this.VirtualMachineScaleSetUpdate == null)
                {
                    this.VirtualMachineScaleSetUpdate = new VirtualMachineScaleSetUpdate();
                }
                if (this.VirtualMachineScaleSetUpdate.UpgradePolicy == null)
                {
                    this.VirtualMachineScaleSetUpdate.UpgradePolicy = new UpgradePolicy();
                }
                if (this.VirtualMachineScaleSetUpdate.UpgradePolicy.RollingUpgradePolicy == null)
                {
                    this.VirtualMachineScaleSetUpdate.UpgradePolicy.RollingUpgradePolicy = new RollingUpgradePolicy();
                }
                this.VirtualMachineScaleSetUpdate.UpgradePolicy.RollingUpgradePolicy.MaxUnhealthyInstancePercent = this.MaxUnhealthyInstancePercent;
            }

            if (this.IsParameterBound(c => c.MaxUnhealthyUpgradedInstancePercent))
            {
                if (this.VirtualMachineScaleSetUpdate == null)
                {
                    this.VirtualMachineScaleSetUpdate = new VirtualMachineScaleSetUpdate();
                }
                if (this.VirtualMachineScaleSetUpdate.UpgradePolicy == null)
                {
                    this.VirtualMachineScaleSetUpdate.UpgradePolicy = new UpgradePolicy();
                }
                if (this.VirtualMachineScaleSetUpdate.UpgradePolicy.RollingUpgradePolicy == null)
                {
                    this.VirtualMachineScaleSetUpdate.UpgradePolicy.RollingUpgradePolicy = new RollingUpgradePolicy();
                }
                this.VirtualMachineScaleSetUpdate.UpgradePolicy.RollingUpgradePolicy.MaxUnhealthyUpgradedInstancePercent = this.MaxUnhealthyUpgradedInstancePercent;
            }

            if (this.IsParameterBound(c => c.OsDiskCaching))
            {
                if (this.VirtualMachineScaleSetUpdate == null)
                {
                    this.VirtualMachineScaleSetUpdate = new VirtualMachineScaleSetUpdate();
                }
                if (this.VirtualMachineScaleSetUpdate.VirtualMachineProfile == null)
                {
                    this.VirtualMachineScaleSetUpdate.VirtualMachineProfile = new VirtualMachineScaleSetUpdateVMProfile();
                }
                if (this.VirtualMachineScaleSetUpdate.VirtualMachineProfile.StorageProfile == null)
                {
                    this.VirtualMachineScaleSetUpdate.VirtualMachineProfile.StorageProfile = new VirtualMachineScaleSetUpdateStorageProfile();
                }
                if (this.VirtualMachineScaleSetUpdate.VirtualMachineProfile.StorageProfile.OsDisk == null)
                {
                    this.VirtualMachineScaleSetUpdate.VirtualMachineProfile.StorageProfile.OsDisk = new VirtualMachineScaleSetUpdateOSDisk();
                }
                this.VirtualMachineScaleSetUpdate.VirtualMachineProfile.StorageProfile.OsDisk.Caching = this.OsDiskCaching;
            }

            if (this.IsParameterBound(c => c.OsDiskWriteAccelerator))
            {
                if (this.VirtualMachineScaleSetUpdate == null)
                {
                    this.VirtualMachineScaleSetUpdate = new VirtualMachineScaleSetUpdate();
                }
                if (this.VirtualMachineScaleSetUpdate.VirtualMachineProfile == null)
                {
                    this.VirtualMachineScaleSetUpdate.VirtualMachineProfile = new VirtualMachineScaleSetUpdateVMProfile();
                }
                if (this.VirtualMachineScaleSetUpdate.VirtualMachineProfile.StorageProfile == null)
                {
                    this.VirtualMachineScaleSetUpdate.VirtualMachineProfile.StorageProfile = new VirtualMachineScaleSetUpdateStorageProfile();
                }
                if (this.VirtualMachineScaleSetUpdate.VirtualMachineProfile.StorageProfile.OsDisk == null)
                {
                    this.VirtualMachineScaleSetUpdate.VirtualMachineProfile.StorageProfile.OsDisk = new VirtualMachineScaleSetUpdateOSDisk();
                }
                this.VirtualMachineScaleSetUpdate.VirtualMachineProfile.StorageProfile.OsDisk.WriteAcceleratorEnabled = this.OsDiskWriteAccelerator;
            }

            if (this.IsParameterBound(c => c.Overprovision))
            {
                if (this.VirtualMachineScaleSetUpdate == null)
                {
                    this.VirtualMachineScaleSetUpdate = new VirtualMachineScaleSetUpdate();
                }
                this.VirtualMachineScaleSetUpdate.Overprovision = this.Overprovision;
            }

            if (this.IsParameterBound(c => c.PauseTimeBetweenBatches))
            {
                if (this.VirtualMachineScaleSetUpdate == null)
                {
                    this.VirtualMachineScaleSetUpdate = new VirtualMachineScaleSetUpdate();
                }
                if (this.VirtualMachineScaleSetUpdate.UpgradePolicy == null)
                {
                    this.VirtualMachineScaleSetUpdate.UpgradePolicy = new UpgradePolicy();
                }
                if (this.VirtualMachineScaleSetUpdate.UpgradePolicy.RollingUpgradePolicy == null)
                {
                    this.VirtualMachineScaleSetUpdate.UpgradePolicy.RollingUpgradePolicy = new RollingUpgradePolicy();
                }
                this.VirtualMachineScaleSetUpdate.UpgradePolicy.RollingUpgradePolicy.PauseTimeBetweenBatches = this.PauseTimeBetweenBatches;
            }

            if (this.IsParameterBound(c => c.PlanName))
            {
                if (this.VirtualMachineScaleSetUpdate == null)
                {
                    this.VirtualMachineScaleSetUpdate = new VirtualMachineScaleSetUpdate();
                }
                if (this.VirtualMachineScaleSetUpdate.Plan == null)
                {
                    this.VirtualMachineScaleSetUpdate.Plan = new Plan();
                }
                this.VirtualMachineScaleSetUpdate.Plan.Name = this.PlanName;
            }

            if (this.IsParameterBound(c => c.PlanProduct))
            {
                if (this.VirtualMachineScaleSetUpdate == null)
                {
                    this.VirtualMachineScaleSetUpdate = new VirtualMachineScaleSetUpdate();
                }
                if (this.VirtualMachineScaleSetUpdate.Plan == null)
                {
                    this.VirtualMachineScaleSetUpdate.Plan = new Plan();
                }
                this.VirtualMachineScaleSetUpdate.Plan.Product = this.PlanProduct;
            }

            if (this.IsParameterBound(c => c.PlanPromotionCode))
            {
                if (this.VirtualMachineScaleSetUpdate == null)
                {
                    this.VirtualMachineScaleSetUpdate = new VirtualMachineScaleSetUpdate();
                }
                if (this.VirtualMachineScaleSetUpdate.Plan == null)
                {
                    this.VirtualMachineScaleSetUpdate.Plan = new Plan();
                }
                this.VirtualMachineScaleSetUpdate.Plan.PromotionCode = this.PlanPromotionCode;
            }

            if (this.IsParameterBound(c => c.PlanPublisher))
            {
                if (this.VirtualMachineScaleSetUpdate == null)
                {
                    this.VirtualMachineScaleSetUpdate = new VirtualMachineScaleSetUpdate();
                }
                if (this.VirtualMachineScaleSetUpdate.Plan == null)
                {
                    this.VirtualMachineScaleSetUpdate.Plan = new Plan();
                }
                this.VirtualMachineScaleSetUpdate.Plan.Publisher = this.PlanPublisher;
            }

            if (this.IsParameterBound(c => c.ProvisionVMAgent))
            {
                if (this.VirtualMachineScaleSetUpdate == null)
                {
                    this.VirtualMachineScaleSetUpdate = new VirtualMachineScaleSetUpdate();
                }
                if (this.VirtualMachineScaleSetUpdate.VirtualMachineProfile == null)
                {
                    this.VirtualMachineScaleSetUpdate.VirtualMachineProfile = new VirtualMachineScaleSetUpdateVMProfile();
                }
                if (this.VirtualMachineScaleSetUpdate.VirtualMachineProfile.OsProfile == null)
                {
                    this.VirtualMachineScaleSetUpdate.VirtualMachineProfile.OsProfile = new VirtualMachineScaleSetUpdateOSProfile();
                }
                if (this.VirtualMachineScaleSetUpdate.VirtualMachineProfile.OsProfile.WindowsConfiguration == null)
                {
                    this.VirtualMachineScaleSetUpdate.VirtualMachineProfile.OsProfile.WindowsConfiguration = new WindowsConfiguration();
                }
                this.VirtualMachineScaleSetUpdate.VirtualMachineProfile.OsProfile.WindowsConfiguration.ProvisionVMAgent = this.ProvisionVMAgent;
            }

            if (this.IsParameterBound(c => c.ProximityPlacementGroupId))
            {
                if (this.VirtualMachineScaleSetUpdate == null)
                {
                    this.VirtualMachineScaleSetUpdate = new VirtualMachineScaleSetUpdate();
                }
                if (this.VirtualMachineScaleSetUpdate.ProximityPlacementGroup == null)
                {
                    this.VirtualMachineScaleSetUpdate.ProximityPlacementGroup = new SubResource();
                }
                this.VirtualMachineScaleSetUpdate.ProximityPlacementGroup.Id = this.ProximityPlacementGroupId;
            }

            if (this.IsParameterBound(c => c.ScaleInPolicy))
            {
                if (this.VirtualMachineScaleSetUpdate == null)
                {
                    this.VirtualMachineScaleSetUpdate = new VirtualMachineScaleSetUpdate();
                }
                if (this.VirtualMachineScaleSetUpdate.ScaleInPolicy == null)
                {
                    this.VirtualMachineScaleSetUpdate.ScaleInPolicy = new ScaleInPolicy();
                }
                this.VirtualMachineScaleSetUpdate.ScaleInPolicy.Rules = this.ScaleInPolicy;
            }

            if (this.IsParameterBound(c => c.ScaleInPolicyForceDeletion))
            {
                if (this.VirtualMachineScaleSetUpdate == null)
                {
                    this.VirtualMachineScaleSetUpdate = new VirtualMachineScaleSetUpdate();
                }
                if (this.VirtualMachineScaleSetUpdate.ScaleInPolicy == null)
                {
                    this.VirtualMachineScaleSetUpdate.ScaleInPolicy = new ScaleInPolicy();
                }
                this.VirtualMachineScaleSetUpdate.ScaleInPolicy.ForceDeletion = this.ScaleInPolicyForceDeletion;
            }

            if (this.IsParameterBound(c => c.SinglePlacementGroup))
            {
                if (this.VirtualMachineScaleSetUpdate == null)
                {
                    this.VirtualMachineScaleSetUpdate = new VirtualMachineScaleSetUpdate();
                }
                this.VirtualMachineScaleSetUpdate.SinglePlacementGroup = this.SinglePlacementGroup;
            }

            if (this.IsParameterBound(c => c.SkipExtensionsOnOverprovisionedVMs))
            {
                if (this.VirtualMachineScaleSetUpdate == null)
                {
                    this.VirtualMachineScaleSetUpdate = new VirtualMachineScaleSetUpdate();
                }
                this.VirtualMachineScaleSetUpdate.DoNotRunExtensionsOnOverprovisionedVMs = this.SkipExtensionsOnOverprovisionedVMs;
            }

            if (this.IsParameterBound(c => c.SkuCapacity))
            {
                if (this.VirtualMachineScaleSetUpdate == null)
                {
                    this.VirtualMachineScaleSetUpdate = new VirtualMachineScaleSetUpdate();
                }
                if (this.VirtualMachineScaleSetUpdate.Sku == null)
                {
                    this.VirtualMachineScaleSetUpdate.Sku = new Sku();
                }
                this.VirtualMachineScaleSetUpdate.Sku.Capacity = this.SkuCapacity;
            }

            if (this.IsParameterBound(c => c.SkuName))
            {
                if (this.VirtualMachineScaleSetUpdate == null)
                {
                    this.VirtualMachineScaleSetUpdate = new VirtualMachineScaleSetUpdate();
                }
                if (this.VirtualMachineScaleSetUpdate.Sku == null)
                {
                    this.VirtualMachineScaleSetUpdate.Sku = new Sku();
                }
                this.VirtualMachineScaleSetUpdate.Sku.Name = this.SkuName;
            }

            if (this.IsParameterBound(c => c.SkuTier))
            {
                if (this.VirtualMachineScaleSetUpdate == null)
                {
                    this.VirtualMachineScaleSetUpdate = new VirtualMachineScaleSetUpdate();
                }
                if (this.VirtualMachineScaleSetUpdate.Sku == null)
                {
                    this.VirtualMachineScaleSetUpdate.Sku = new Sku();
                }
                this.VirtualMachineScaleSetUpdate.Sku.Tier = this.SkuTier;
            }

            if (this.IsParameterBound(c => c.Tag))
            {
                if (this.VirtualMachineScaleSetUpdate == null)
                {
                    this.VirtualMachineScaleSetUpdate = new VirtualMachineScaleSetUpdate();
                }
                this.VirtualMachineScaleSetUpdate.Tags = this.Tag.Cast<DictionaryEntry>().ToDictionary(ht => (string)ht.Key, ht => (string)ht.Value);
            }

            if (this.IsParameterBound(c => c.TerminateScheduledEventNotBeforeTimeoutInMinutes))
            {
                if (this.VirtualMachineScaleSetUpdate == null)
                {
                    this.VirtualMachineScaleSetUpdate = new VirtualMachineScaleSetUpdate();
                }
                if (this.VirtualMachineScaleSetUpdate.VirtualMachineProfile == null)
                {
                    this.VirtualMachineScaleSetUpdate.VirtualMachineProfile = new VirtualMachineScaleSetUpdateVMProfile();
                }
                if (this.VirtualMachineScaleSetUpdate.VirtualMachineProfile.ScheduledEventsProfile == null)
                {
                    this.VirtualMachineScaleSetUpdate.VirtualMachineProfile.ScheduledEventsProfile = new ScheduledEventsProfile();
                }
                if (this.VirtualMachineScaleSetUpdate.VirtualMachineProfile.ScheduledEventsProfile.TerminateNotificationProfile == null)
                {
                    this.VirtualMachineScaleSetUpdate.VirtualMachineProfile.ScheduledEventsProfile.TerminateNotificationProfile = new TerminateNotificationProfile();
                }
                this.VirtualMachineScaleSetUpdate.VirtualMachineProfile.ScheduledEventsProfile.TerminateNotificationProfile.NotBeforeTimeout = XmlConvert.ToString(new TimeSpan(0, this.TerminateScheduledEventNotBeforeTimeoutInMinutes, 0));
            }

            if (this.IsParameterBound(c => c.TerminateScheduledEvents))
            {
                if (this.VirtualMachineScaleSetUpdate == null)
                {
                    this.VirtualMachineScaleSetUpdate = new VirtualMachineScaleSetUpdate();
                }
                if (this.VirtualMachineScaleSetUpdate.VirtualMachineProfile == null)
                {
                    this.VirtualMachineScaleSetUpdate.VirtualMachineProfile = new VirtualMachineScaleSetUpdateVMProfile();
                }
                if (this.VirtualMachineScaleSetUpdate.VirtualMachineProfile.ScheduledEventsProfile == null)
                {
                    this.VirtualMachineScaleSetUpdate.VirtualMachineProfile.ScheduledEventsProfile = new ScheduledEventsProfile();
                }
                if (this.VirtualMachineScaleSetUpdate.VirtualMachineProfile.ScheduledEventsProfile.TerminateNotificationProfile == null)
                {
                    this.VirtualMachineScaleSetUpdate.VirtualMachineProfile.ScheduledEventsProfile.TerminateNotificationProfile = new TerminateNotificationProfile();
                }
                this.VirtualMachineScaleSetUpdate.VirtualMachineProfile.ScheduledEventsProfile.TerminateNotificationProfile.Enable = this.TerminateScheduledEvents;
            }

            if (this.IsParameterBound(c => c.TimeZone))
            {
                if (this.VirtualMachineScaleSetUpdate == null)
                {
                    this.VirtualMachineScaleSetUpdate = new VirtualMachineScaleSetUpdate();
                }
                if (this.VirtualMachineScaleSetUpdate.VirtualMachineProfile == null)
                {
                    this.VirtualMachineScaleSetUpdate.VirtualMachineProfile = new VirtualMachineScaleSetUpdateVMProfile();
                }
                if (this.VirtualMachineScaleSetUpdate.VirtualMachineProfile.OsProfile == null)
                {
                    this.VirtualMachineScaleSetUpdate.VirtualMachineProfile.OsProfile = new VirtualMachineScaleSetUpdateOSProfile();
                }
                if (this.VirtualMachineScaleSetUpdate.VirtualMachineProfile.OsProfile.WindowsConfiguration == null)
                {
                    this.VirtualMachineScaleSetUpdate.VirtualMachineProfile.OsProfile.WindowsConfiguration = new WindowsConfiguration();
                }
                this.VirtualMachineScaleSetUpdate.VirtualMachineProfile.OsProfile.WindowsConfiguration.TimeZone = this.TimeZone;
            }

            if (this.IsParameterBound(c => c.UltraSSDEnabled))
            {
                if (this.VirtualMachineScaleSetUpdate == null)
                {
                    this.VirtualMachineScaleSetUpdate = new VirtualMachineScaleSetUpdate();
                }
                if (this.VirtualMachineScaleSetUpdate.AdditionalCapabilities == null)
                {
                    this.VirtualMachineScaleSetUpdate.AdditionalCapabilities = new AdditionalCapabilities();
                }
                this.VirtualMachineScaleSetUpdate.AdditionalCapabilities.UltraSSDEnabled = this.UltraSSDEnabled;
            }

            if (this.IsParameterBound(c => c.UpgradePolicyMode))
            {
                if (this.VirtualMachineScaleSetUpdate == null)
                {
                    this.VirtualMachineScaleSetUpdate = new VirtualMachineScaleSetUpdate();
                }
                if (this.VirtualMachineScaleSetUpdate.UpgradePolicy == null)
                {
                    this.VirtualMachineScaleSetUpdate.UpgradePolicy = new UpgradePolicy();
                }
                this.VirtualMachineScaleSetUpdate.UpgradePolicy.Mode = this.UpgradePolicyMode;
            }

            if (this.IsParameterBound(c => c.VhdContainer))
            {
                if (this.VirtualMachineScaleSetUpdate == null)
                {
                    this.VirtualMachineScaleSetUpdate = new VirtualMachineScaleSetUpdate();
                }
                if (this.VirtualMachineScaleSetUpdate.VirtualMachineProfile == null)
                {
                    this.VirtualMachineScaleSetUpdate.VirtualMachineProfile = new VirtualMachineScaleSetUpdateVMProfile();
                }
                if (this.VirtualMachineScaleSetUpdate.VirtualMachineProfile.StorageProfile == null)
                {
                    this.VirtualMachineScaleSetUpdate.VirtualMachineProfile.StorageProfile = new VirtualMachineScaleSetUpdateStorageProfile();
                }
                if (this.VirtualMachineScaleSetUpdate.VirtualMachineProfile.StorageProfile.OsDisk == null)
                {
                    this.VirtualMachineScaleSetUpdate.VirtualMachineProfile.StorageProfile.OsDisk = new VirtualMachineScaleSetUpdateOSDisk();
                }
                this.VirtualMachineScaleSetUpdate.VirtualMachineProfile.StorageProfile.OsDisk.VhdContainers = this.VhdContainer;
            }

            if (this.IsParameterBound(c => c.EncryptionAtHost))
            {
                if (this.VirtualMachineScaleSetUpdate == null)
                {
                    this.VirtualMachineScaleSetUpdate = new VirtualMachineScaleSetUpdate();
                }
                if (this.VirtualMachineScaleSetUpdate.VirtualMachineProfile == null)
                {
                    this.VirtualMachineScaleSetUpdate.VirtualMachineProfile = new VirtualMachineScaleSetUpdateVMProfile();
                }
                if (this.VirtualMachineScaleSetUpdate.VirtualMachineProfile.SecurityProfile == null)
                {
                    this.VirtualMachineScaleSetUpdate.VirtualMachineProfile.SecurityProfile = new SecurityProfile();
                }
                this.VirtualMachineScaleSetUpdate.VirtualMachineProfile.SecurityProfile.EncryptionAtHost = this.EncryptionAtHost;
            }

            if (this.VirtualMachineScaleSetUpdate != null
                && this.VirtualMachineScaleSetUpdate.ProximityPlacementGroup != null
                && string.IsNullOrEmpty(this.VirtualMachineScaleSetUpdate.ProximityPlacementGroup.Id))
            {
                this.VirtualMachineScaleSetUpdate.ProximityPlacementGroup.Id = null;
            }

            if (this.IsParameterBound(c => c.UserData))
            {
                if (!ValidateBase64EncodedString.ValidateStringIsBase64Encoded(this.UserData))
                {
                    this.UserData = ValidateBase64EncodedString.EncodeStringToBase64(this.UserData);
                    this.WriteInformation(ValidateBase64EncodedString.UserDataEncodeNotification, new string[] { "PSHOST" });
                }

                if (this.VirtualMachineScaleSet.VirtualMachineProfile == null)
                {
                    this.VirtualMachineScaleSet.VirtualMachineProfile = new PSVirtualMachineScaleSetVMProfile();
                }
                this.VirtualMachineScaleSet.VirtualMachineProfile.UserData = this.UserData;
            }

            if (this.IsParameterBound(c => c.OSImageScheduledEventEnabled))
            {
                if (this.VirtualMachineScaleSetUpdate == null)
                {
                    this.VirtualMachineScaleSetUpdate = new VirtualMachineScaleSetUpdate();
                }
                if (this.VirtualMachineScaleSetUpdate.VirtualMachineProfile == null)
                {
                    this.VirtualMachineScaleSetUpdate.VirtualMachineProfile = new VirtualMachineScaleSetUpdateVMProfile();
                }
                if (this.VirtualMachineScaleSetUpdate.VirtualMachineProfile.ScheduledEventsProfile == null)
                {
                    this.VirtualMachineScaleSetUpdate.VirtualMachineProfile.ScheduledEventsProfile = new ScheduledEventsProfile();
                }
                if (this.VirtualMachineScaleSetUpdate.VirtualMachineProfile.ScheduledEventsProfile.OsImageNotificationProfile == null)
                {
                    this.VirtualMachineScaleSetUpdate.VirtualMachineProfile.ScheduledEventsProfile.OsImageNotificationProfile = new OSImageNotificationProfile();
                }
                this.VirtualMachineScaleSetUpdate.VirtualMachineProfile.ScheduledEventsProfile.OsImageNotificationProfile.Enable = this.OSImageScheduledEventEnabled;
            }

            if (this.IsParameterBound(c => c.OSImageScheduledEventNotBeforeTimeoutInMinutes))
            {
                if (this.VirtualMachineScaleSetUpdate == null)
                {
                    this.VirtualMachineScaleSetUpdate = new VirtualMachineScaleSetUpdate();
                }
                if (this.VirtualMachineScaleSetUpdate.VirtualMachineProfile == null)
                {
                    this.VirtualMachineScaleSetUpdate.VirtualMachineProfile = new VirtualMachineScaleSetUpdateVMProfile();
                }
                if (this.VirtualMachineScaleSetUpdate.VirtualMachineProfile.ScheduledEventsProfile == null)
                {
                    this.VirtualMachineScaleSetUpdate.VirtualMachineProfile.ScheduledEventsProfile = new ScheduledEventsProfile();
                }
                if (this.VirtualMachineScaleSetUpdate.VirtualMachineProfile.ScheduledEventsProfile.OsImageNotificationProfile == null)
                {
                    this.VirtualMachineScaleSetUpdate.VirtualMachineProfile.ScheduledEventsProfile.OsImageNotificationProfile = new OSImageNotificationProfile();
                }
                this.VirtualMachineScaleSetUpdate.VirtualMachineProfile.ScheduledEventsProfile.OsImageNotificationProfile.NotBeforeTimeout = this.OSImageScheduledEventNotBeforeTimeoutInMinutes;
            }

            // SecurityType, includes TrustedLaunch and ConfidentialVM and Standard. 
            if (this.IsParameterBound(c => c.SecurityType))
            {
                if (this.VirtualMachineScaleSetUpdate == null)
                {
                    this.VirtualMachineScaleSetUpdate = new VirtualMachineScaleSetUpdate();
                }
                if (this.VirtualMachineScaleSetUpdate.VirtualMachineProfile == null)
                {
                    this.VirtualMachineScaleSetUpdate.VirtualMachineProfile = new VirtualMachineScaleSetUpdateVMProfile();
                }
                if (this.VirtualMachineScaleSetUpdate.VirtualMachineProfile.SecurityProfile == null)
                {
                    this.VirtualMachineScaleSetUpdate.VirtualMachineProfile.SecurityProfile = new SecurityProfile();
                }
                if (this.VirtualMachineScaleSetUpdate.VirtualMachineProfile.SecurityProfile.UefiSettings == null)
                {
                    this.VirtualMachineScaleSetUpdate.VirtualMachineProfile.SecurityProfile.UefiSettings = new UefiSettings();
                }
                this.VirtualMachineScaleSetUpdate.VirtualMachineProfile.SecurityProfile.SecurityType = this.SecurityType;
                if (this.VirtualMachineScaleSetUpdate.VirtualMachineProfile.SecurityProfile.SecurityType?.ToLower() == ConstantValues.TrustedLaunchSecurityType || this.VirtualMachineScaleSetUpdate.VirtualMachineProfile.SecurityProfile.SecurityType?.ToLower() == ConstantValues.ConfidentialVMSecurityType)
                {
                    this.VirtualMachineScaleSetUpdate.VirtualMachineProfile.SecurityProfile.UefiSettings.VTpmEnabled = this.VirtualMachineScaleSetUpdate.VirtualMachineProfile.SecurityProfile.UefiSettings.VTpmEnabled == null ? true : this.EnableVtpm;
                    this.VirtualMachineScaleSetUpdate.VirtualMachineProfile.SecurityProfile.UefiSettings.SecureBootEnabled = this.VirtualMachineScaleSetUpdate.VirtualMachineProfile.SecurityProfile.UefiSettings.SecureBootEnabled == null ? true : this.EnableSecureBoot;
                }
            }
            // Only used for SecurityType == TrustedLaunch
            if (this.IsParameterBound(c => c.EnableVtpm))
            {
                if (this.VirtualMachineScaleSetUpdate == null)
                {
                    this.VirtualMachineScaleSetUpdate = new VirtualMachineScaleSetUpdate();
                }
                if (this.VirtualMachineScaleSetUpdate.VirtualMachineProfile == null)
                {
                    this.VirtualMachineScaleSetUpdate.VirtualMachineProfile = new VirtualMachineScaleSetUpdateVMProfile();
                }
                if (this.VirtualMachineScaleSetUpdate.VirtualMachineProfile.SecurityProfile == null)
                {
                    this.VirtualMachineScaleSetUpdate.VirtualMachineProfile.SecurityProfile = new SecurityProfile();
                }
                if (this.VirtualMachineScaleSetUpdate.VirtualMachineProfile.SecurityProfile.UefiSettings == null)
                {
                    this.VirtualMachineScaleSetUpdate.VirtualMachineProfile.SecurityProfile.UefiSettings = new UefiSettings();
                }
                this.VirtualMachineScaleSetUpdate.VirtualMachineProfile.SecurityProfile.UefiSettings.VTpmEnabled = this.EnableVtpm;
            }
            // Only used for SecurityType == TrustedLaunch
            if (this.IsParameterBound(c => c.EnableSecureBoot))
            {
                if (this.VirtualMachineScaleSetUpdate == null)
                {
                    this.VirtualMachineScaleSetUpdate = new VirtualMachineScaleSetUpdate();
                }
                if (this.VirtualMachineScaleSetUpdate.VirtualMachineProfile == null)
                {
                    this.VirtualMachineScaleSetUpdate.VirtualMachineProfile = new VirtualMachineScaleSetUpdateVMProfile();
                }
                if (this.VirtualMachineScaleSetUpdate.VirtualMachineProfile.SecurityProfile == null)
                {
                    this.VirtualMachineScaleSetUpdate.VirtualMachineProfile.SecurityProfile = new SecurityProfile();
                }
                if (this.VirtualMachineScaleSetUpdate.VirtualMachineProfile.SecurityProfile.UefiSettings == null)
                {
                    this.VirtualMachineScaleSetUpdate.VirtualMachineProfile.SecurityProfile.UefiSettings = new UefiSettings();
                }
                this.VirtualMachineScaleSetUpdate.VirtualMachineProfile.SecurityProfile.UefiSettings.SecureBootEnabled = this.EnableSecureBoot;
            }

            if (this.VirtualMachineScaleSetUpdate != null
                && this.VirtualMachineScaleSetUpdate.VirtualMachineProfile != null
                && this.VirtualMachineScaleSetUpdate.VirtualMachineProfile.OsProfile != null
                && this.VirtualMachineScaleSetUpdate.VirtualMachineProfile.OsProfile.WindowsConfiguration != null
                && this.VirtualMachineScaleSetUpdate.VirtualMachineProfile.OsProfile.LinuxConfiguration != null)
            {
                throw new ArgumentException(Microsoft.Azure.Commands.Compute.Properties.Resources.BothWindowsAndLinuxConfigurationsSpecified);
            }

            // New Feature Implementation
            if (this.IsParameterBound(c => c.EnableResilientVMCreate))
            {
                if (this.VirtualMachineScaleSetUpdate == null)
                {
                    this.VirtualMachineScaleSetUpdate = new VirtualMachineScaleSetUpdate();
                }
                if (this.VirtualMachineScaleSetUpdate.ResiliencyPolicy == null)
                {
                    this.VirtualMachineScaleSetUpdate.ResiliencyPolicy = new ResiliencyPolicy();
                }
                this.VirtualMachineScaleSetUpdate.ResiliencyPolicy.ResilientVMCreationPolicy = new ResilientVMCreationPolicy(this.EnableResilientVMCreate);
            }

            if (this.IsParameterBound(c => c.EnableResilientVMDelete))
            {
                if (this.VirtualMachineScaleSetUpdate == null)
                {
                    this.VirtualMachineScaleSetUpdate = new VirtualMachineScaleSetUpdate();
                }
                if (this.VirtualMachineScaleSetUpdate.ResiliencyPolicy == null)
                {
                    this.VirtualMachineScaleSetUpdate.ResiliencyPolicy = new ResiliencyPolicy();
                }
                this.VirtualMachineScaleSetUpdate.ResiliencyPolicy.ResilientVMDeletionPolicy = new ResilientVMDeletionPolicy(this.EnableResilientVMDelete);
            }
        }

        private void BuildPutObject()
        {
            if (this.IsParameterBound(c => c.AutomaticOSUpgrade))
            {
                if (this.VirtualMachineScaleSet.UpgradePolicy == null)
                {
                    this.VirtualMachineScaleSet.UpgradePolicy = new UpgradePolicy();
                }
                if (this.VirtualMachineScaleSet.UpgradePolicy.AutomaticOSUpgradePolicy == null)
                {
                    this.VirtualMachineScaleSet.UpgradePolicy.AutomaticOSUpgradePolicy = new AutomaticOSUpgradePolicy();
                }
                this.VirtualMachineScaleSet.UpgradePolicy.AutomaticOSUpgradePolicy.EnableAutomaticOSUpgrade = this.AutomaticOSUpgrade;
            }

            if (this.IsParameterBound(c => c.BootDiagnosticsEnabled))
            {
                if (this.VirtualMachineScaleSet.VirtualMachineProfile == null)
                {
                    this.VirtualMachineScaleSet.VirtualMachineProfile = new PSVirtualMachineScaleSetVMProfile();
                }
                if (this.VirtualMachineScaleSet.VirtualMachineProfile.DiagnosticsProfile == null)
                {
                    this.VirtualMachineScaleSet.VirtualMachineProfile.DiagnosticsProfile = new DiagnosticsProfile();
                }
                if (this.VirtualMachineScaleSet.VirtualMachineProfile.DiagnosticsProfile.BootDiagnostics == null)
                {
                    this.VirtualMachineScaleSet.VirtualMachineProfile.DiagnosticsProfile.BootDiagnostics = new BootDiagnostics();
                }
                this.VirtualMachineScaleSet.VirtualMachineProfile.DiagnosticsProfile.BootDiagnostics.Enabled = this.BootDiagnosticsEnabled;
            }

            if (this.IsParameterBound(c => c.BootDiagnosticsStorageUri))
            {
                if (this.VirtualMachineScaleSet.VirtualMachineProfile == null)
                {
                    this.VirtualMachineScaleSet.VirtualMachineProfile = new PSVirtualMachineScaleSetVMProfile();
                }
                if (this.VirtualMachineScaleSet.VirtualMachineProfile.DiagnosticsProfile == null)
                {
                    this.VirtualMachineScaleSet.VirtualMachineProfile.DiagnosticsProfile = new DiagnosticsProfile();
                }
                if (this.VirtualMachineScaleSet.VirtualMachineProfile.DiagnosticsProfile.BootDiagnostics == null)
                {
                    this.VirtualMachineScaleSet.VirtualMachineProfile.DiagnosticsProfile.BootDiagnostics = new BootDiagnostics();
                }
                this.VirtualMachineScaleSet.VirtualMachineProfile.DiagnosticsProfile.BootDiagnostics.StorageUri = this.BootDiagnosticsStorageUri;
            }

            if (this.IsParameterBound(c => c.CapacityReservationGroupId))
            {
                if (this.VirtualMachineScaleSet.VirtualMachineProfile == null)
                {
                    this.VirtualMachineScaleSet.VirtualMachineProfile = new PSVirtualMachineScaleSetVMProfile();
                }
                if (this.VirtualMachineScaleSet.VirtualMachineProfile.CapacityReservation == null)
                {
                    this.VirtualMachineScaleSet.VirtualMachineProfile.CapacityReservation = new CapacityReservationProfile();
                }
                if (this.VirtualMachineScaleSet.VirtualMachineProfile.CapacityReservation.CapacityReservationGroup == null)
                {
                    this.VirtualMachineScaleSet.VirtualMachineProfile.CapacityReservation.CapacityReservationGroup = new SubResource();
                }
                this.VirtualMachineScaleSet.VirtualMachineProfile.CapacityReservation.CapacityReservationGroup.Id = this.CapacityReservationGroupId;
            }

            if (this.IsParameterBound(c => c.CustomData))
            {
                if (this.VirtualMachineScaleSet.VirtualMachineProfile == null)
                {
                    this.VirtualMachineScaleSet.VirtualMachineProfile = new PSVirtualMachineScaleSetVMProfile();
                }
                if (this.VirtualMachineScaleSet.VirtualMachineProfile.OsProfile == null)
                {
                    this.VirtualMachineScaleSet.VirtualMachineProfile.OsProfile = new VirtualMachineScaleSetOSProfile();
                }
                this.VirtualMachineScaleSet.VirtualMachineProfile.OsProfile.CustomData = this.CustomData;
            }

            if (this.IsParameterBound(c => c.DisableAutoRollback))
            {
                if (this.VirtualMachineScaleSet.UpgradePolicy == null)
                {
                    this.VirtualMachineScaleSet.UpgradePolicy = new UpgradePolicy();
                }
                if (this.VirtualMachineScaleSet.UpgradePolicy.AutomaticOSUpgradePolicy == null)
                {
                    this.VirtualMachineScaleSet.UpgradePolicy.AutomaticOSUpgradePolicy = new AutomaticOSUpgradePolicy();
                }
                this.VirtualMachineScaleSet.UpgradePolicy.AutomaticOSUpgradePolicy.DisableAutomaticRollback = this.DisableAutoRollback;
            }

            if (this.IsParameterBound(c => c.DisablePasswordAuthentication))
            {
                if (this.VirtualMachineScaleSet.VirtualMachineProfile == null)
                {
                    this.VirtualMachineScaleSet.VirtualMachineProfile = new PSVirtualMachineScaleSetVMProfile();
                }
                if (this.VirtualMachineScaleSet.VirtualMachineProfile.OsProfile == null)
                {
                    this.VirtualMachineScaleSet.VirtualMachineProfile.OsProfile = new VirtualMachineScaleSetOSProfile();
                }
                if (this.VirtualMachineScaleSet.VirtualMachineProfile.OsProfile.LinuxConfiguration == null)
                {
                    this.VirtualMachineScaleSet.VirtualMachineProfile.OsProfile.LinuxConfiguration = new LinuxConfiguration();
                }
                this.VirtualMachineScaleSet.VirtualMachineProfile.OsProfile.LinuxConfiguration.DisablePasswordAuthentication = this.DisablePasswordAuthentication;
            }

            if (this.IsParameterBound(c => c.EnableAutomaticRepair))
            {
                if (this.VirtualMachineScaleSet.AutomaticRepairsPolicy == null)
                {
                    this.VirtualMachineScaleSet.AutomaticRepairsPolicy = new AutomaticRepairsPolicy();
                }
                this.VirtualMachineScaleSet.AutomaticRepairsPolicy.Enabled = this.EnableAutomaticRepair;
            }

            if (this.IsParameterBound(c => c.AutomaticRepairAction))
            {
                if (this.VirtualMachineScaleSet.AutomaticRepairsPolicy == null)
                {
                    this.VirtualMachineScaleSet.AutomaticRepairsPolicy = new AutomaticRepairsPolicy();
                }
                this.VirtualMachineScaleSet.AutomaticRepairsPolicy.RepairAction = this.AutomaticRepairAction;
            }

            if (this.IsParameterBound(c => c.AutomaticRepairGracePeriod))
            {
                if (this.VirtualMachineScaleSet.AutomaticRepairsPolicy == null)
                {
                    this.VirtualMachineScaleSet.AutomaticRepairsPolicy = new AutomaticRepairsPolicy();
                }
                this.VirtualMachineScaleSet.AutomaticRepairsPolicy.GracePeriod = this.AutomaticRepairGracePeriod;
            }

            if (this.IsParameterBound(c => c.EnableAutomaticUpdate))
            {
                if (this.VirtualMachineScaleSet.VirtualMachineProfile == null)
                {
                    this.VirtualMachineScaleSet.VirtualMachineProfile = new PSVirtualMachineScaleSetVMProfile();
                }
                if (this.VirtualMachineScaleSet.VirtualMachineProfile.OsProfile == null)
                {
                    this.VirtualMachineScaleSet.VirtualMachineProfile.OsProfile = new VirtualMachineScaleSetOSProfile();
                }
                if (this.VirtualMachineScaleSet.VirtualMachineProfile.OsProfile.WindowsConfiguration == null)
                {
                    this.VirtualMachineScaleSet.VirtualMachineProfile.OsProfile.WindowsConfiguration = new WindowsConfiguration();
                }
                this.VirtualMachineScaleSet.VirtualMachineProfile.OsProfile.WindowsConfiguration.EnableAutomaticUpdates = this.EnableAutomaticUpdate;
            }

            if (this.IsParameterBound(c => c.IdentityId))
            {
                if (this.VirtualMachineScaleSet.Identity == null)
                {
                    this.VirtualMachineScaleSet.Identity = new VirtualMachineScaleSetIdentity();
                }

                this.VirtualMachineScaleSet.Identity.UserAssignedIdentities = new Dictionary<string, UserAssignedIdentitiesValue>();

                foreach (var id in this.IdentityId)
                {
                    if (!this.VirtualMachineScaleSet.Identity.UserAssignedIdentities.ContainsKey(id))
                    {
                        this.VirtualMachineScaleSet.Identity.UserAssignedIdentities.Add(id, new UserAssignedIdentitiesValue());
                    }
                }
            }

            if (this.IsParameterBound(c => c.IdentityType))
            {
                if (this.VirtualMachineScaleSet.Identity == null)
                {
                    this.VirtualMachineScaleSet.Identity = new VirtualMachineScaleSetIdentity();
                }
                this.VirtualMachineScaleSet.Identity.Type = this.IdentityType;
            }

            if (this.IsParameterBound(c => c.ImageReferenceId))
            {
                if (this.VirtualMachineScaleSet.VirtualMachineProfile == null)
                {
                    this.VirtualMachineScaleSet.VirtualMachineProfile = new PSVirtualMachineScaleSetVMProfile();
                }
                if (this.VirtualMachineScaleSet.VirtualMachineProfile.StorageProfile == null)
                {
                    this.VirtualMachineScaleSet.VirtualMachineProfile.StorageProfile = new VirtualMachineScaleSetStorageProfile();
                }
                if (this.VirtualMachineScaleSet.VirtualMachineProfile.StorageProfile.ImageReference == null)
                {
                    this.VirtualMachineScaleSet.VirtualMachineProfile.StorageProfile.ImageReference = new ImageReference();
                }
                this.VirtualMachineScaleSet.VirtualMachineProfile.StorageProfile.ImageReference.Id = this.ImageReferenceId;
            }

            if (this.IsParameterBound(c => c.SharedGalleryImageId))
            {
                if (this.VirtualMachineScaleSetUpdate == null)
                {
                    this.VirtualMachineScaleSetUpdate = new VirtualMachineScaleSetUpdate();
                }
                if (this.VirtualMachineScaleSetUpdate.VirtualMachineProfile == null)
                {
                    this.VirtualMachineScaleSetUpdate.VirtualMachineProfile = new VirtualMachineScaleSetUpdateVMProfile();
                }
                if (this.VirtualMachineScaleSetUpdate.VirtualMachineProfile.StorageProfile == null)
                {
                    this.VirtualMachineScaleSetUpdate.VirtualMachineProfile.StorageProfile = new VirtualMachineScaleSetUpdateStorageProfile();
                }
                if (this.VirtualMachineScaleSetUpdate.VirtualMachineProfile.StorageProfile.ImageReference == null)
                {
                    this.VirtualMachineScaleSetUpdate.VirtualMachineProfile.StorageProfile.ImageReference = new ImageReference();
                }
                this.VirtualMachineScaleSetUpdate.VirtualMachineProfile.StorageProfile.ImageReference.SharedGalleryImageId = this.SharedGalleryImageId;
            }

            if (this.IsParameterBound(c => c.ImageReferenceOffer))
            {
                if (this.VirtualMachineScaleSet.VirtualMachineProfile == null)
                {
                    this.VirtualMachineScaleSet.VirtualMachineProfile = new PSVirtualMachineScaleSetVMProfile();
                }
                if (this.VirtualMachineScaleSet.VirtualMachineProfile.StorageProfile == null)
                {
                    this.VirtualMachineScaleSet.VirtualMachineProfile.StorageProfile = new VirtualMachineScaleSetStorageProfile();
                }
                if (this.VirtualMachineScaleSet.VirtualMachineProfile.StorageProfile.ImageReference == null)
                {
                    this.VirtualMachineScaleSet.VirtualMachineProfile.StorageProfile.ImageReference = new ImageReference();
                }
                this.VirtualMachineScaleSet.VirtualMachineProfile.StorageProfile.ImageReference.Offer = this.ImageReferenceOffer;
            }

            if (this.IsParameterBound(c => c.ImageReferencePublisher))
            {
                if (this.VirtualMachineScaleSet.VirtualMachineProfile == null)
                {
                    this.VirtualMachineScaleSet.VirtualMachineProfile = new PSVirtualMachineScaleSetVMProfile();
                }
                if (this.VirtualMachineScaleSet.VirtualMachineProfile.StorageProfile == null)
                {
                    this.VirtualMachineScaleSet.VirtualMachineProfile.StorageProfile = new VirtualMachineScaleSetStorageProfile();
                }
                if (this.VirtualMachineScaleSet.VirtualMachineProfile.StorageProfile.ImageReference == null)
                {
                    this.VirtualMachineScaleSet.VirtualMachineProfile.StorageProfile.ImageReference = new ImageReference();
                }
                this.VirtualMachineScaleSet.VirtualMachineProfile.StorageProfile.ImageReference.Publisher = this.ImageReferencePublisher;
            }

            if (this.IsParameterBound(c => c.ImageReferenceSku))
            {
                if (this.VirtualMachineScaleSet.VirtualMachineProfile == null)
                {
                    this.VirtualMachineScaleSet.VirtualMachineProfile = new PSVirtualMachineScaleSetVMProfile();
                }
                if (this.VirtualMachineScaleSet.VirtualMachineProfile.StorageProfile == null)
                {
                    this.VirtualMachineScaleSet.VirtualMachineProfile.StorageProfile = new VirtualMachineScaleSetStorageProfile();
                }
                if (this.VirtualMachineScaleSet.VirtualMachineProfile.StorageProfile.ImageReference == null)
                {
                    this.VirtualMachineScaleSet.VirtualMachineProfile.StorageProfile.ImageReference = new ImageReference();
                }
                this.VirtualMachineScaleSet.VirtualMachineProfile.StorageProfile.ImageReference.Sku = this.ImageReferenceSku;
            }

            if (this.IsParameterBound(c => c.ImageReferenceVersion))
            {
                if (this.VirtualMachineScaleSet.VirtualMachineProfile == null)
                {
                    this.VirtualMachineScaleSet.VirtualMachineProfile = new PSVirtualMachineScaleSetVMProfile();
                }
                if (this.VirtualMachineScaleSet.VirtualMachineProfile.StorageProfile == null)
                {
                    this.VirtualMachineScaleSet.VirtualMachineProfile.StorageProfile = new VirtualMachineScaleSetStorageProfile();
                }
                if (this.VirtualMachineScaleSet.VirtualMachineProfile.StorageProfile.ImageReference == null)
                {
                    this.VirtualMachineScaleSet.VirtualMachineProfile.StorageProfile.ImageReference = new ImageReference();
                }
                this.VirtualMachineScaleSet.VirtualMachineProfile.StorageProfile.ImageReference.Version = this.ImageReferenceVersion;
            }

            if (this.IsParameterBound(c => c.ImageUri))
            {
                if (this.VirtualMachineScaleSet.VirtualMachineProfile == null)
                {
                    this.VirtualMachineScaleSet.VirtualMachineProfile = new PSVirtualMachineScaleSetVMProfile();
                }
                if (this.VirtualMachineScaleSet.VirtualMachineProfile.StorageProfile == null)
                {
                    this.VirtualMachineScaleSet.VirtualMachineProfile.StorageProfile = new VirtualMachineScaleSetStorageProfile();
                }
                if (this.VirtualMachineScaleSet.VirtualMachineProfile.StorageProfile.OsDisk == null)
                {
                    this.VirtualMachineScaleSet.VirtualMachineProfile.StorageProfile.OsDisk = new VirtualMachineScaleSetOSDisk();
                }
                if (this.VirtualMachineScaleSet.VirtualMachineProfile.StorageProfile.OsDisk.Image == null)
                {
                    this.VirtualMachineScaleSet.VirtualMachineProfile.StorageProfile.OsDisk.Image = new VirtualHardDisk();
                }
                this.VirtualMachineScaleSet.VirtualMachineProfile.StorageProfile.OsDisk.Image.Uri = this.ImageUri;
            }

            if (this.IsParameterBound(c => c.LicenseType))
            {
                if (this.VirtualMachineScaleSet.VirtualMachineProfile == null)
                {
                    this.VirtualMachineScaleSet.VirtualMachineProfile = new PSVirtualMachineScaleSetVMProfile();
                }
                this.VirtualMachineScaleSet.VirtualMachineProfile.LicenseType = this.LicenseType;
            }

            if (this.IsParameterBound(c => c.ManagedDiskStorageAccountType))
            {
                if (this.VirtualMachineScaleSet.VirtualMachineProfile == null)
                {
                    this.VirtualMachineScaleSet.VirtualMachineProfile = new PSVirtualMachineScaleSetVMProfile();
                }
                if (this.VirtualMachineScaleSet.VirtualMachineProfile.StorageProfile == null)
                {
                    this.VirtualMachineScaleSet.VirtualMachineProfile.StorageProfile = new VirtualMachineScaleSetStorageProfile();
                }
                if (this.VirtualMachineScaleSet.VirtualMachineProfile.StorageProfile.OsDisk == null)
                {
                    this.VirtualMachineScaleSet.VirtualMachineProfile.StorageProfile.OsDisk = new VirtualMachineScaleSetOSDisk();
                }
                if (this.VirtualMachineScaleSet.VirtualMachineProfile.StorageProfile.OsDisk.ManagedDisk == null)
                {
                    this.VirtualMachineScaleSet.VirtualMachineProfile.StorageProfile.OsDisk.ManagedDisk = new VirtualMachineScaleSetManagedDiskParameters();
                }
                this.VirtualMachineScaleSet.VirtualMachineProfile.StorageProfile.OsDisk.ManagedDisk.StorageAccountType = this.ManagedDiskStorageAccountType;
            }

            if (this.IsParameterBound(c => c.MaxBatchInstancePercent))
            {
                if (this.VirtualMachineScaleSet.UpgradePolicy == null)
                {
                    this.VirtualMachineScaleSet.UpgradePolicy = new UpgradePolicy();
                }
                if (this.VirtualMachineScaleSet.UpgradePolicy.RollingUpgradePolicy == null)
                {
                    this.VirtualMachineScaleSet.UpgradePolicy.RollingUpgradePolicy = new RollingUpgradePolicy();
                }
                this.VirtualMachineScaleSet.UpgradePolicy.RollingUpgradePolicy.MaxBatchInstancePercent = this.MaxBatchInstancePercent;
            }

            if (this.IsParameterBound(c => c.MaxPrice))
            {
                if (this.VirtualMachineScaleSet.VirtualMachineProfile == null)
                {
                    this.VirtualMachineScaleSet.VirtualMachineProfile = new PSVirtualMachineScaleSetVMProfile();
                }
                if (this.VirtualMachineScaleSet.VirtualMachineProfile.BillingProfile == null)
                {
                    this.VirtualMachineScaleSet.VirtualMachineProfile.BillingProfile = new BillingProfile();
                }
                this.VirtualMachineScaleSet.VirtualMachineProfile.BillingProfile.MaxPrice = this.MaxPrice;
            }

            if (this.IsParameterBound(c => c.MaxUnhealthyInstancePercent))
            {
                if (this.VirtualMachineScaleSet.UpgradePolicy == null)
                {
                    this.VirtualMachineScaleSet.UpgradePolicy = new UpgradePolicy();
                }
                if (this.VirtualMachineScaleSet.UpgradePolicy.RollingUpgradePolicy == null)
                {
                    this.VirtualMachineScaleSet.UpgradePolicy.RollingUpgradePolicy = new RollingUpgradePolicy();
                }
                this.VirtualMachineScaleSet.UpgradePolicy.RollingUpgradePolicy.MaxUnhealthyInstancePercent = this.MaxUnhealthyInstancePercent;
            }

            if (this.IsParameterBound(c => c.MaxUnhealthyUpgradedInstancePercent))
            {
                if (this.VirtualMachineScaleSet.UpgradePolicy == null)
                {
                    this.VirtualMachineScaleSet.UpgradePolicy = new UpgradePolicy();
                }
                if (this.VirtualMachineScaleSet.UpgradePolicy.RollingUpgradePolicy == null)
                {
                    this.VirtualMachineScaleSet.UpgradePolicy.RollingUpgradePolicy = new RollingUpgradePolicy();
                }
                this.VirtualMachineScaleSet.UpgradePolicy.RollingUpgradePolicy.MaxUnhealthyUpgradedInstancePercent = this.MaxUnhealthyUpgradedInstancePercent;
            }

            if (this.IsParameterBound(c => c.OsDiskCaching))
            {
                if (this.VirtualMachineScaleSet.VirtualMachineProfile == null)
                {
                    this.VirtualMachineScaleSet.VirtualMachineProfile = new PSVirtualMachineScaleSetVMProfile();
                }
                if (this.VirtualMachineScaleSet.VirtualMachineProfile.StorageProfile == null)
                {
                    this.VirtualMachineScaleSet.VirtualMachineProfile.StorageProfile = new VirtualMachineScaleSetStorageProfile();
                }
                if (this.VirtualMachineScaleSet.VirtualMachineProfile.StorageProfile.OsDisk == null)
                {
                    this.VirtualMachineScaleSet.VirtualMachineProfile.StorageProfile.OsDisk = new VirtualMachineScaleSetOSDisk();
                }
                this.VirtualMachineScaleSet.VirtualMachineProfile.StorageProfile.OsDisk.Caching = this.OsDiskCaching;
            }

            if (this.IsParameterBound(c => c.OsDiskWriteAccelerator))
            {
                if (this.VirtualMachineScaleSet.VirtualMachineProfile == null)
                {
                    this.VirtualMachineScaleSet.VirtualMachineProfile = new PSVirtualMachineScaleSetVMProfile();
                }
                if (this.VirtualMachineScaleSet.VirtualMachineProfile.StorageProfile == null)
                {
                    this.VirtualMachineScaleSet.VirtualMachineProfile.StorageProfile = new VirtualMachineScaleSetStorageProfile();
                }
                if (this.VirtualMachineScaleSet.VirtualMachineProfile.StorageProfile.OsDisk == null)
                {
                    this.VirtualMachineScaleSet.VirtualMachineProfile.StorageProfile.OsDisk = new VirtualMachineScaleSetOSDisk();
                }
                this.VirtualMachineScaleSet.VirtualMachineProfile.StorageProfile.OsDisk.WriteAcceleratorEnabled = this.OsDiskWriteAccelerator;
            }

            if (this.IsParameterBound(c => c.Overprovision))
            {
                this.VirtualMachineScaleSet.Overprovision = this.Overprovision;
            }

            if (this.IsParameterBound(c => c.PauseTimeBetweenBatches))
            {
                if (this.VirtualMachineScaleSet.UpgradePolicy == null)
                {
                    this.VirtualMachineScaleSet.UpgradePolicy = new UpgradePolicy();
                }
                if (this.VirtualMachineScaleSet.UpgradePolicy.RollingUpgradePolicy == null)
                {
                    this.VirtualMachineScaleSet.UpgradePolicy.RollingUpgradePolicy = new RollingUpgradePolicy();
                }
                this.VirtualMachineScaleSet.UpgradePolicy.RollingUpgradePolicy.PauseTimeBetweenBatches = this.PauseTimeBetweenBatches;
            }

            if (this.IsParameterBound(c => c.PlanName))
            {
                if (this.VirtualMachineScaleSet.Plan == null)
                {
                    this.VirtualMachineScaleSet.Plan = new Plan();
                }
                this.VirtualMachineScaleSet.Plan.Name = this.PlanName;
            }

            if (this.IsParameterBound(c => c.PlanProduct))
            {
                if (this.VirtualMachineScaleSet.Plan == null)
                {
                    this.VirtualMachineScaleSet.Plan = new Plan();
                }
                this.VirtualMachineScaleSet.Plan.Product = this.PlanProduct;
            }

            if (this.IsParameterBound(c => c.PlanPromotionCode))
            {
                if (this.VirtualMachineScaleSet.Plan == null)
                {
                    this.VirtualMachineScaleSet.Plan = new Plan();
                }
                this.VirtualMachineScaleSet.Plan.PromotionCode = this.PlanPromotionCode;
            }

            if (this.IsParameterBound(c => c.PlanPublisher))
            {
                if (this.VirtualMachineScaleSet.Plan == null)
                {
                    this.VirtualMachineScaleSet.Plan = new Plan();
                }
                this.VirtualMachineScaleSet.Plan.Publisher = this.PlanPublisher;
            }

            if (this.IsParameterBound(c => c.ProvisionVMAgent))
            {
                if (this.VirtualMachineScaleSet.VirtualMachineProfile == null)
                {
                    this.VirtualMachineScaleSet.VirtualMachineProfile = new PSVirtualMachineScaleSetVMProfile();
                }
                if (this.VirtualMachineScaleSet.VirtualMachineProfile.OsProfile == null)
                {
                    this.VirtualMachineScaleSet.VirtualMachineProfile.OsProfile = new VirtualMachineScaleSetOSProfile();
                }
                if (this.VirtualMachineScaleSet.VirtualMachineProfile.OsProfile.WindowsConfiguration == null)
                {
                    this.VirtualMachineScaleSet.VirtualMachineProfile.OsProfile.WindowsConfiguration = new WindowsConfiguration();
                }
                this.VirtualMachineScaleSet.VirtualMachineProfile.OsProfile.WindowsConfiguration.ProvisionVMAgent = this.ProvisionVMAgent;
            }

            if (this.IsParameterBound(c => c.ProximityPlacementGroupId))
            {
                if (this.VirtualMachineScaleSet.ProximityPlacementGroup == null)
                {
                    this.VirtualMachineScaleSet.ProximityPlacementGroup = new SubResource();
                }
                this.VirtualMachineScaleSet.ProximityPlacementGroup.Id = this.ProximityPlacementGroupId;
            }

            if (this.IsParameterBound(c => c.ScaleInPolicy))
            {
                if (this.VirtualMachineScaleSet.ScaleInPolicy == null)
                {
                    this.VirtualMachineScaleSet.ScaleInPolicy = new ScaleInPolicy();
                }
                this.VirtualMachineScaleSet.ScaleInPolicy.Rules = this.ScaleInPolicy;
            }

            if (this.IsParameterBound(c => c.ScaleInPolicyForceDeletion))
            {
                if (this.VirtualMachineScaleSet.ScaleInPolicy == null)
                {
                    this.VirtualMachineScaleSet.ScaleInPolicy = new ScaleInPolicy();
                }
                this.VirtualMachineScaleSet.ScaleInPolicy.ForceDeletion = this.ScaleInPolicyForceDeletion;
            }

            if (this.IsParameterBound(c => c.SinglePlacementGroup))
            {
                this.VirtualMachineScaleSet.SinglePlacementGroup = this.SinglePlacementGroup;
            }

            if (this.IsParameterBound(c => c.SkipExtensionsOnOverprovisionedVMs))
            {
                this.VirtualMachineScaleSet.DoNotRunExtensionsOnOverprovisionedVMs = this.SkipExtensionsOnOverprovisionedVMs;
            }

            if (this.IsParameterBound(c => c.SkuCapacity))
            {
                if (this.VirtualMachineScaleSet.Sku == null)
                {
                    this.VirtualMachineScaleSet.Sku = new Sku();
                }
                this.VirtualMachineScaleSet.Sku.Capacity = this.SkuCapacity;
            }

            if (this.IsParameterBound(c => c.SkuName))
            {
                if (this.VirtualMachineScaleSet.Sku == null)
                {
                    this.VirtualMachineScaleSet.Sku = new Sku();
                }
                this.VirtualMachineScaleSet.Sku.Name = this.SkuName;
            }

            if (this.IsParameterBound(c => c.SkuTier))
            {
                if (this.VirtualMachineScaleSet.Sku == null)
                {
                    this.VirtualMachineScaleSet.Sku = new Sku();
                }
                this.VirtualMachineScaleSet.Sku.Tier = this.SkuTier;
            }

            if (this.IsParameterBound(c => c.Tag))
            {
                this.VirtualMachineScaleSet.Tags = this.Tag.Cast<DictionaryEntry>().ToDictionary(ht => (string)ht.Key, ht => (string)ht.Value);
            }

            if (this.IsParameterBound(c => c.TerminateScheduledEventNotBeforeTimeoutInMinutes))
            {
                if (this.VirtualMachineScaleSet.VirtualMachineProfile == null)
                {
                    this.VirtualMachineScaleSet.VirtualMachineProfile = new PSVirtualMachineScaleSetVMProfile();
                }
                if (this.VirtualMachineScaleSet.VirtualMachineProfile.ScheduledEventsProfile == null)
                {
                    this.VirtualMachineScaleSet.VirtualMachineProfile.ScheduledEventsProfile = new ScheduledEventsProfile();
                }
                if (this.VirtualMachineScaleSet.VirtualMachineProfile.ScheduledEventsProfile.TerminateNotificationProfile == null)
                {
                    this.VirtualMachineScaleSet.VirtualMachineProfile.ScheduledEventsProfile.TerminateNotificationProfile = new TerminateNotificationProfile();
                }
                this.VirtualMachineScaleSet.VirtualMachineProfile.ScheduledEventsProfile.TerminateNotificationProfile.NotBeforeTimeout = XmlConvert.ToString(new TimeSpan(0, this.TerminateScheduledEventNotBeforeTimeoutInMinutes, 0));
            }

            if (this.IsParameterBound(c => c.TerminateScheduledEvents))
            {
                if (this.VirtualMachineScaleSet.VirtualMachineProfile == null)
                {
                    this.VirtualMachineScaleSet.VirtualMachineProfile = new PSVirtualMachineScaleSetVMProfile();
                }
                if (this.VirtualMachineScaleSet.VirtualMachineProfile.ScheduledEventsProfile == null)
                {
                    this.VirtualMachineScaleSet.VirtualMachineProfile.ScheduledEventsProfile = new ScheduledEventsProfile();
                }
                if (this.VirtualMachineScaleSet.VirtualMachineProfile.ScheduledEventsProfile.TerminateNotificationProfile == null)
                {
                    this.VirtualMachineScaleSet.VirtualMachineProfile.ScheduledEventsProfile.TerminateNotificationProfile = new TerminateNotificationProfile();
                }
                this.VirtualMachineScaleSet.VirtualMachineProfile.ScheduledEventsProfile.TerminateNotificationProfile.Enable = this.TerminateScheduledEvents;
            }

            if (this.IsParameterBound(c => c.TimeZone))
            {
                if (this.VirtualMachineScaleSet.VirtualMachineProfile == null)
                {
                    this.VirtualMachineScaleSet.VirtualMachineProfile = new PSVirtualMachineScaleSetVMProfile();
                }
                if (this.VirtualMachineScaleSet.VirtualMachineProfile.OsProfile == null)
                {
                    this.VirtualMachineScaleSet.VirtualMachineProfile.OsProfile = new VirtualMachineScaleSetOSProfile();
                }
                if (this.VirtualMachineScaleSet.VirtualMachineProfile.OsProfile.WindowsConfiguration == null)
                {
                    this.VirtualMachineScaleSet.VirtualMachineProfile.OsProfile.WindowsConfiguration = new WindowsConfiguration();
                }
                this.VirtualMachineScaleSet.VirtualMachineProfile.OsProfile.WindowsConfiguration.TimeZone = this.TimeZone;
            }

            if (this.IsParameterBound(c => c.UltraSSDEnabled))
            {
                if (this.VirtualMachineScaleSet.AdditionalCapabilities == null)
                {
                    this.VirtualMachineScaleSet.AdditionalCapabilities = new AdditionalCapabilities();
                }
                this.VirtualMachineScaleSet.AdditionalCapabilities.UltraSSDEnabled = this.UltraSSDEnabled;
            }

            if (this.IsParameterBound(c => c.UpgradePolicyMode))
            {
                if (this.VirtualMachineScaleSet.UpgradePolicy == null)
                {
                    this.VirtualMachineScaleSet.UpgradePolicy = new UpgradePolicy();
                }
                this.VirtualMachineScaleSet.UpgradePolicy.Mode = this.UpgradePolicyMode;
            }

            if (this.IsParameterBound(c => c.VhdContainer))
            {
                if (this.VirtualMachineScaleSet.VirtualMachineProfile == null)
                {
                    this.VirtualMachineScaleSet.VirtualMachineProfile = new PSVirtualMachineScaleSetVMProfile();
                }
                if (this.VirtualMachineScaleSet.VirtualMachineProfile.StorageProfile == null)
                {
                    this.VirtualMachineScaleSet.VirtualMachineProfile.StorageProfile = new VirtualMachineScaleSetStorageProfile();
                }
                if (this.VirtualMachineScaleSet.VirtualMachineProfile.StorageProfile.OsDisk == null)
                {
                    this.VirtualMachineScaleSet.VirtualMachineProfile.StorageProfile.OsDisk = new VirtualMachineScaleSetOSDisk();
                }
                this.VirtualMachineScaleSet.VirtualMachineProfile.StorageProfile.OsDisk.VhdContainers = this.VhdContainer;
            }

            if (this.IsParameterBound(c => c.EncryptionAtHost))
            {
                if (this.VirtualMachineScaleSet.VirtualMachineProfile == null)
                {
                    this.VirtualMachineScaleSet.VirtualMachineProfile = new PSVirtualMachineScaleSetVMProfile();
                }
                if (this.VirtualMachineScaleSet.VirtualMachineProfile.SecurityProfile == null)
                {
                    this.VirtualMachineScaleSet.VirtualMachineProfile.SecurityProfile = new SecurityProfile();
                }
                this.VirtualMachineScaleSet.VirtualMachineProfile.SecurityProfile.EncryptionAtHost = this.EncryptionAtHost;
            }

            if (this.VirtualMachineScaleSet != null
                && this.VirtualMachineScaleSet.ProximityPlacementGroup != null
                && string.IsNullOrEmpty(this.VirtualMachineScaleSet.ProximityPlacementGroup.Id))
            {
                this.VirtualMachineScaleSet.ProximityPlacementGroup.Id = null;
            }

            if (this.IsParameterBound(c => c.UserData))
            {
                if (!ValidateBase64EncodedString.ValidateStringIsBase64Encoded(this.UserData))
                {
                    this.UserData = ValidateBase64EncodedString.EncodeStringToBase64(this.UserData);
                    this.WriteInformation(ValidateBase64EncodedString.UserDataEncodeNotification, new string[] { "PSHOST" });
                }

                if (this.VirtualMachineScaleSet.VirtualMachineProfile == null)
                {
                    this.VirtualMachineScaleSet.VirtualMachineProfile = new PSVirtualMachineScaleSetVMProfile();
                }
                this.VirtualMachineScaleSet.VirtualMachineProfile.UserData = this.UserData;
            }

            if (this.IsParameterBound(c => c.BaseRegularPriorityCount))
            {
                if (this.VirtualMachineScaleSet.PriorityMixPolicy == null)
                {
                    this.VirtualMachineScaleSet.PriorityMixPolicy = new PriorityMixPolicy();
                }
                this.VirtualMachineScaleSet.PriorityMixPolicy.BaseRegularPriorityCount = this.BaseRegularPriorityCount;
            }

            if (this.IsParameterBound(c => c.RegularPriorityPercentage))
            {
                if (this.VirtualMachineScaleSet.PriorityMixPolicy == null)
                {
                    this.VirtualMachineScaleSet.PriorityMixPolicy = new PriorityMixPolicy();
                }
                this.VirtualMachineScaleSet.PriorityMixPolicy.RegularPriorityPercentageAboveBase = this.RegularPriorityPercentage;
            }

            if (this.IsParameterBound(c => c.SkuProfileVmSize))
            {
                if (this.VirtualMachineScaleSet.SkuProfile == null)
                {
                    this.VirtualMachineScaleSet.SkuProfile = new SkuProfile();
                    this.VirtualMachineScaleSet.SkuProfile.VmSizes = new List<SkuProfileVMSize>();
                }
                foreach (string vmSize in this.SkuProfileVmSize)
                {
                    this.VirtualMachineScaleSet.SkuProfile.VmSizes.Add(new SkuProfileVMSize()
                    {
                        Name = vmSize,
                    });
                }

                if (this.IsParameterBound(c => c.SkuProfileAllocationStrategy))
                {
                    this.VirtualMachineScaleSet.SkuProfile.AllocationStrategy = this.SkuProfileAllocationStrategy;
                }
                else if (this.VirtualMachineScaleSet.SkuProfile.AllocationStrategy == null)
                {
                    this.VirtualMachineScaleSet.SkuProfile.AllocationStrategy = "LowestPrice";
                }
            }

            if (this.IsParameterBound(c => c.SecurityType))
            {
                if (this.VirtualMachineScaleSet.VirtualMachineProfile == null)
                {
                    this.VirtualMachineScaleSet.VirtualMachineProfile = new PSVirtualMachineScaleSetVMProfile();
                }
                if (this.VirtualMachineScaleSet.VirtualMachineProfile.SecurityProfile == null)
                {
                    this.VirtualMachineScaleSet.VirtualMachineProfile.SecurityProfile = new SecurityProfile();
                }
                if (this.VirtualMachineScaleSet.VirtualMachineProfile.SecurityProfile.UefiSettings == null)
                {
                    this.VirtualMachineScaleSet.VirtualMachineProfile.SecurityProfile.UefiSettings = new UefiSettings();
                }
                this.VirtualMachineScaleSet.VirtualMachineProfile.SecurityProfile.SecurityType = this.SecurityType;
                if (this.VirtualMachineScaleSet.VirtualMachineProfile.SecurityProfile.SecurityType?.ToLower() == ConstantValues.TrustedLaunchSecurityType || this.VirtualMachineScaleSet.VirtualMachineProfile.SecurityProfile.SecurityType?.ToLower() == ConstantValues.ConfidentialVMSecurityType)
                {
                    this.VirtualMachineScaleSet.VirtualMachineProfile.SecurityProfile.UefiSettings.VTpmEnabled = this.VirtualMachineScaleSet.VirtualMachineProfile.SecurityProfile.UefiSettings.VTpmEnabled == null ? true : this.EnableVtpm;
                    this.VirtualMachineScaleSet.VirtualMachineProfile.SecurityProfile.UefiSettings.SecureBootEnabled = this.VirtualMachineScaleSet.VirtualMachineProfile.SecurityProfile.UefiSettings.SecureBootEnabled == null ? true : this.EnableSecureBoot;
                }
            }
            // Only used for SecurityType == TrustedLaunch
            if (this.IsParameterBound(c => c.EnableVtpm))
            {
                if (this.VirtualMachineScaleSet.VirtualMachineProfile == null)
                {
                    this.VirtualMachineScaleSet.VirtualMachineProfile = new PSVirtualMachineScaleSetVMProfile();
                }
                if (this.VirtualMachineScaleSet.VirtualMachineProfile.SecurityProfile == null)
                {
                    this.VirtualMachineScaleSet.VirtualMachineProfile.SecurityProfile = new SecurityProfile();
                }
                if (this.VirtualMachineScaleSet.VirtualMachineProfile.SecurityProfile.UefiSettings == null)
                {
                    this.VirtualMachineScaleSet.VirtualMachineProfile.SecurityProfile.UefiSettings = new UefiSettings();
                }
                this.VirtualMachineScaleSet.VirtualMachineProfile.SecurityProfile.UefiSettings.VTpmEnabled = this.EnableVtpm;
            }
            // Only used for SecurityType == TrustedLaunch
            if (this.IsParameterBound(c => c.EnableSecureBoot))
            {
                if (this.VirtualMachineScaleSet.VirtualMachineProfile == null)
                {
                    this.VirtualMachineScaleSet.VirtualMachineProfile = new PSVirtualMachineScaleSetVMProfile();
                }
                if (this.VirtualMachineScaleSet.VirtualMachineProfile.SecurityProfile == null)
                {
                    this.VirtualMachineScaleSet.VirtualMachineProfile.SecurityProfile = new SecurityProfile();
                }
                if (this.VirtualMachineScaleSet.VirtualMachineProfile.SecurityProfile.UefiSettings == null)
                {
                    this.VirtualMachineScaleSet.VirtualMachineProfile.SecurityProfile.UefiSettings = new UefiSettings();
                }
                this.VirtualMachineScaleSet.VirtualMachineProfile.SecurityProfile.UefiSettings.SecureBootEnabled = this.EnableSecureBoot;
            }

            if (this.VirtualMachineScaleSet != null
                && this.VirtualMachineScaleSet.VirtualMachineProfile != null
                && this.VirtualMachineScaleSet.VirtualMachineProfile.OsProfile != null
                && this.VirtualMachineScaleSet.VirtualMachineProfile.OsProfile.WindowsConfiguration != null
                && this.VirtualMachineScaleSet.VirtualMachineProfile.OsProfile.LinuxConfiguration != null)
            {
                throw new ArgumentException(Microsoft.Azure.Commands.Compute.Properties.Resources.BothWindowsAndLinuxConfigurationsSpecified);
            }

            if (this.IsParameterBound(c => c.EnableResilientVMCreate))
            {
                if (this.VirtualMachineScaleSet.VirtualMachineProfile == null)
                {
                    this.VirtualMachineScaleSet.VirtualMachineProfile = new PSVirtualMachineScaleSetVMProfile();
                }
                if (this.VirtualMachineScaleSet.ResiliencyPolicy == null)
                {
                    this.VirtualMachineScaleSet.ResiliencyPolicy = new ResiliencyPolicy();
                }
                this.VirtualMachineScaleSet.ResiliencyPolicy.ResilientVMCreationPolicy = new ResilientVMCreationPolicy(this.EnableResilientVMCreate);
            }

            if (this.IsParameterBound(c => c.EnableResilientVMDelete))
            {
                if (this.VirtualMachineScaleSet.VirtualMachineProfile == null)
                {
                    this.VirtualMachineScaleSet.VirtualMachineProfile = new PSVirtualMachineScaleSetVMProfile();
                }
                if (this.VirtualMachineScaleSet.ResiliencyPolicy == null)
                {
                    this.VirtualMachineScaleSet.ResiliencyPolicy = new ResiliencyPolicy();
                }
                this.VirtualMachineScaleSet.ResiliencyPolicy.ResilientVMDeletionPolicy = new ResilientVMDeletionPolicy(this.EnableResilientVMDelete);
            }
        }
    }
}