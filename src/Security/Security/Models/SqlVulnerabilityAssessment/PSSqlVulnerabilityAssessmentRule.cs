using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;

namespace Microsoft.Azure.Commands.SecurityCenter.Models.SqlVulnerabilityAssessment
{
    public class PSSqlVulnerabilityAssessmentRule
    {
        public string RuleId { get; set; }
        public string Severity { get; set; }
        public string Category { get; set; }
        public string RuleType { get; set; }
        public string Title { get; set; }
        public string Description { get; set; }
        public string Rationale { get; set; }
        public PSSqlVulnerabilityAssessmentQueryCheck QueryCheck { get; set; }
        public IList<PSSqlVulnerabilityBenchmarkReference> BenchmarkReferences { get; set; }

        public override string ToString()
        {
            return string.Join(Environment.NewLine, $"{{",
                $"Rule id:      {RuleId}",
                $"Severity:     {Severity}",
                $"Category:     {Category}",
                $"Rule type:    {RuleType}",
                $"Title:        {Title}",
                $"Description:  {Description}",
                $"Rationale:    {Rationale}",
                $"Query check:",
                $"{QueryCheck}",
                "Benchmark References:",
                (BenchmarkReferences.Any() ? $"{string.Join(", ", BenchmarkReferences)}" : "{}"),
                $"}}");
        }
    }
}
