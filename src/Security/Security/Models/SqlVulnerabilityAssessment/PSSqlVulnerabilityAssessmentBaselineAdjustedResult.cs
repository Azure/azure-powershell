using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;

namespace Microsoft.Azure.Commands.SecurityCenter.Models.SqlVulnerabilityAssessment
{
    public class PSSqlVulnerabilityAssessmentBaselineAdjustedResult
    {
        public string Status { get; set; }

        public string[][] ResultsNotInBaseline { get; set; }

        public string[][] ResultsOnlyInBaseline { get; set; }

        public PSSqlVulnerabilityAssessmentBaseline Baseline { get; set; }

        public override string ToString()
        {
            if (string.IsNullOrEmpty(Status) &&
                !ResultsNotInBaseline.Any() &&
                !ResultsOnlyInBaseline.Any() &&
                Baseline == null)
            {
                return "{}";
            }

            return string.Join(Environment.NewLine, $"{{",
                $"Status: {Status}" ,
                $"Results not in baseline:",
                    (ResultsNotInBaseline.Any() ? $"{string.Join(Environment.NewLine, ResultsNotInBaseline.Select(row => $"{{{string.Join(", ", row)}}}"))}" : "{}"),
                $"Results only in baseline:",
                (ResultsOnlyInBaseline.Any() ? $"{string.Join(Environment.NewLine, ResultsOnlyInBaseline.Select(row => $"{{{string.Join(", ", row)}}}"))}" : "{}"),
                $"Baseline:",
                $"{Baseline}",
                $"}}");
        }
    }
}
