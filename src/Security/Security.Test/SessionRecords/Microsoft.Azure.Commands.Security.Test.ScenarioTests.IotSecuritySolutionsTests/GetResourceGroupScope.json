{
  "Entries": [
    {
      "RequestUri": "/subscriptions/075423e9-7d33-4166-8bdf-3920b04e3735/resourceGroups/MichalResourceGroup/providers/Microsoft.Security/iotSecuritySolutions/MichalDemoHub?api-version=2019-08-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvMDc1NDIzZTktN2QzMy00MTY2LThiZGYtMzkyMGIwNGUzNzM1L3Jlc291cmNlR3JvdXBzL01pY2hhbFJlc291cmNlR3JvdXAvcHJvdmlkZXJzL01pY3Jvc29mdC5TZWN1cml0eS9pb3RTZWN1cml0eVNvbHV0aW9ucy9NaWNoYWxEZW1vSHViP2FwaS12ZXJzaW9uPTIwMTktMDgtMDE=",
      "RequestMethod": "PUT",
      "RequestBody": "{\r\n  \"location\": \"West US\",\r\n  \"properties\": {\r\n    \"workspace\": \"/subscriptions/075423e9-7d33-4166-8bdf-3920b04e3735/resourceGroups/MichalResourceGroup/providers/Microsoft.OperationalInsights/workspaces/IoTHubWorkspace\",\r\n    \"displayName\": \"MichalDemoHub\",\r\n    \"status\": \"Enabled\",\r\n    \"iotHubs\": [\r\n      \"/subscriptions/075423e9-7d33-4166-8bdf-3920b04e3735/resourceGroups/MichalResourceGroup/providers/Microsoft.Devices/IotHubs/MichalDemoHub\"\r\n    ]\r\n  }\r\n}",
      "RequestHeaders": {
        "x-ms-client-request-id": [
          "d69193a2-2791-4e4b-ac0e-32baa88a4f34"
        ],
        "Accept-Language": [
          "en-US"
        ],
        "User-Agent": [
          "FxVersion/4.6.28207.03",
          "OSName/Windows",
          "OSVersion/Microsoft.Windows.10.0.18363.",
          "Microsoft.Azure.Management.Security.SecurityCenterClient/1.1.1.0"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Content-Length": [
          "463"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Server": [
          "Microsoft-HTTPAPI/2.0"
        ],
        "x-ms-ratelimit-remaining-subscription-resource-requests": [
          "249"
        ],
        "x-ms-request-id": [
          "c84806a6-9058-45ad-a630-6273db000ec9"
        ],
        "x-ms-correlation-request-id": [
          "c84806a6-9058-45ad-a630-6273db000ec9"
        ],
        "x-ms-routing-request-id": [
          "WESTEUROPE:20200416T094521Z:c84806a6-9058-45ad-a630-6273db000ec9"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Thu, 16 Apr 2020 09:45:21 GMT"
        ],
        "Content-Length": [
          "3080"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ]
      },
      "ResponseBody": "{\r\n  \"id\": \"/subscriptions/075423e9-7d33-4166-8bdf-3920b04e3735/resourceGroups/MichalResourceGroup/providers/Microsoft.Security/IoTSecuritySolutions/MichalDemoHub\",\r\n  \"name\": \"MichalDemoHub\",\r\n  \"type\": \"Microsoft.Security/IoTSecuritySolutions\",\r\n  \"location\": \"West US\",\r\n  \"properties\": {\r\n    \"displayName\": \"MichalDemoHub\",\r\n    \"status\": \"Enabled\",\r\n    \"export\": [],\r\n    \"disabledDataSources\": [],\r\n    \"workspace\": \"/subscriptions/075423e9-7d33-4166-8bdf-3920b04e3735/resourcegroups/michalresourcegroup/providers/microsoft.operationalinsights/workspaces/iothubworkspace\",\r\n    \"additionalWorkspaces\": null,\r\n    \"iotHubs\": [\r\n      \"/subscriptions/075423e9-7d33-4166-8bdf-3920b04e3735/resourcegroups/michalresourcegroup/providers/microsoft.devices/iothubs/michaldemohub\"\r\n    ],\r\n    \"userDefinedResources\": {\r\n      \"query\": null,\r\n      \"querySubscriptions\": null\r\n    },\r\n    \"recommendationsConfiguration\": [\r\n      {\r\n        \"recommendationType\": \"IoT_ACRAuthentication\",\r\n        \"name\": \"Service prinicpal not used with ACR repository\",\r\n        \"status\": \"Enabled\"\r\n      },\r\n      {\r\n        \"recommendationType\": \"IoT_AgentSendsUnutilizedMessages\",\r\n        \"name\": \"Agent sending underutilized messages\",\r\n        \"status\": \"Enabled\"\r\n      },\r\n      {\r\n        \"recommendationType\": \"IoT_Baseline\",\r\n        \"name\": \"Operating system (OS) baseline validation failure\",\r\n        \"status\": \"Enabled\"\r\n      },\r\n      {\r\n        \"recommendationType\": \"IoT_EdgeHubMemOptimize\",\r\n        \"name\": \"IoT Edge Hub memory can be optimized\",\r\n        \"status\": \"Enabled\"\r\n      },\r\n      {\r\n        \"recommendationType\": \"IoT_EdgeLoggingOptions\",\r\n        \"name\": \"No logging configured for IoT Edge module\",\r\n        \"status\": \"Enabled\"\r\n      },\r\n      {\r\n        \"recommendationType\": \"IoT_InconsistentModuleSettings\",\r\n        \"name\": \"SecurityGroup has inconsistent module settings\",\r\n        \"status\": \"Enabled\"\r\n      },\r\n      {\r\n        \"recommendationType\": \"IoT_InstallAgent\",\r\n        \"name\": \"Install the Azure IoT Security agent\",\r\n        \"status\": \"Enabled\"\r\n      },\r\n      {\r\n        \"recommendationType\": \"IoT_IPFilter_DenyAll\",\r\n        \"name\": \"Default IP filter policy should be deny\",\r\n        \"status\": \"Enabled\"\r\n      },\r\n      {\r\n        \"recommendationType\": \"IoT_IPFilter_PermissiveRule\",\r\n        \"name\": \"IP filter rule includes a large IP range\",\r\n        \"status\": \"Enabled\"\r\n      },\r\n      {\r\n        \"recommendationType\": \"IoT_OpenPorts\",\r\n        \"name\": \"Device has open ports\",\r\n        \"status\": \"Enabled\"\r\n      },\r\n      {\r\n        \"recommendationType\": \"IoT_PermissiveFirewallPolicy\",\r\n        \"name\": \"Permissive firewall policy in one of the chains\",\r\n        \"status\": \"Enabled\"\r\n      },\r\n      {\r\n        \"recommendationType\": \"IoT_PermissiveInputFirewallRules\",\r\n        \"name\": \"Permissive firewall rule in the input chain\",\r\n        \"status\": \"Enabled\"\r\n      },\r\n      {\r\n        \"recommendationType\": \"IoT_PermissiveOutputFirewallRules\",\r\n        \"name\": \"Permissive firewall rule in the output chain\",\r\n        \"status\": \"Enabled\"\r\n      },\r\n      {\r\n        \"recommendationType\": \"IoT_PrivilegedDockerOptions\",\r\n        \"name\": \"High level permissions configured in IoT Edge model twin for IoT Edge module\",\r\n        \"status\": \"Enabled\"\r\n      },\r\n      {\r\n        \"recommendationType\": \"IoT_RecommendedIpRulesByBaseLine\",\r\n        \"name\": \"Recommended Rules for ip filter\",\r\n        \"status\": \"Enabled\"\r\n      },\r\n      {\r\n        \"recommendationType\": \"IoT_SharedCredentials\",\r\n        \"name\": \"Same authentication credentials used by multiple devices\",\r\n        \"status\": \"Enabled\"\r\n      },\r\n      {\r\n        \"recommendationType\": \"IoT_VulnerableTLSCipherSuite\",\r\n        \"name\": \"TLS cipher suite upgrade needed\",\r\n        \"status\": \"Enabled\"\r\n      }\r\n    ],\r\n    \"autoDiscoveredResources\": [\r\n      \"/subscriptions/075423e9-7d33-4166-8bdf-3920b04e3735/resourcegroups/michalresourcegroup/providers/microsoft.devices/iothubs/michaldemohub\"\r\n    ],\r\n    \"unmaskedIpLoggingStatus\": \"Disabled\"\r\n  },\r\n  \"tags\": {}\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/075423e9-7d33-4166-8bdf-3920b04e3735/resourceGroups/MichalResourceGroup/providers/Microsoft.Security/iotSecuritySolutions?api-version=2019-08-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvMDc1NDIzZTktN2QzMy00MTY2LThiZGYtMzkyMGIwNGUzNzM1L3Jlc291cmNlR3JvdXBzL01pY2hhbFJlc291cmNlR3JvdXAvcHJvdmlkZXJzL01pY3Jvc29mdC5TZWN1cml0eS9pb3RTZWN1cml0eVNvbHV0aW9ucz9hcGktdmVyc2lvbj0yMDE5LTA4LTAx",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "x-ms-client-request-id": [
          "a53e0ecf-edc7-4df0-95a0-c4c5a20e1440"
        ],
        "Accept-Language": [
          "en-US"
        ],
        "User-Agent": [
          "FxVersion/4.6.28207.03",
          "OSName/Windows",
          "OSVersion/Microsoft.Windows.10.0.18363.",
          "Microsoft.Azure.Management.Security.SecurityCenterClient/1.1.1.0"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-original-request-ids": [
          "",
          "",
          ""
        ],
        "x-ms-ratelimit-remaining-subscription-resource-requests": [
          "749"
        ],
        "x-ms-request-id": [
          "28397cdf-4c9b-412d-90de-6bf8e2edc633"
        ],
        "x-ms-correlation-request-id": [
          "28397cdf-4c9b-412d-90de-6bf8e2edc633"
        ],
        "x-ms-routing-request-id": [
          "WESTEUROPE:20200416T094522Z:28397cdf-4c9b-412d-90de-6bf8e2edc633"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Thu, 16 Apr 2020 09:45:22 GMT"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Content-Length": [
          "213282"
        ]
      },
      "ResponseBody": "{\r\n  \"value\": [\r\n    {\r\n      \"id\": \"/subscriptions/075423e9-7d33-4166-8bdf-3920b04e3735/resourceGroups/michalresourcegroup/providers/Microsoft.Security/IoTSecuritySolutions/michaliothub\",\r\n      \"name\": \"michaliothub\",\r\n      \"type\": \"Microsoft.Security/IoTSecuritySolutions\",\r\n      \"location\": \"West US\",\r\n      \"properties\": {\r\n        \"displayName\": \"MichalIoTHub\",\r\n        \"status\": \"Enabled\",\r\n        \"export\": [\r\n          \"RawEvents\"\r\n        ],\r\n        \"disabledDataSources\": [],\r\n        \"workspace\": \"/subscriptions/075423e9-7d33-4166-8bdf-3920b04e3735/resourcegroups/michalresourcegroup/providers/microsoft.operationalinsights/workspaces/075423e9-7d33-4166-8bdf-3920b04e3735-iothubworkspace8\",\r\n        \"additionalWorkspaces\": null,\r\n        \"iotHubs\": [],\r\n        \"userDefinedResources\": {\r\n          \"query\": null,\r\n          \"querySubscriptions\": null\r\n        },\r\n        \"recommendationsConfiguration\": [\r\n          {\r\n            \"recommendationType\": \"IoT_ACRAuthentication\",\r\n            \"name\": \"Service prinicpal not used with ACR repository\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_AgentSendsUnutilizedMessages\",\r\n            \"name\": \"Agent sending underutilized messages\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_Baseline\",\r\n            \"name\": \"Operating system (OS) baseline validation failure\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_EdgeHubMemOptimize\",\r\n            \"name\": \"IoT Edge Hub memory can be optimized\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_EdgeLoggingOptions\",\r\n            \"name\": \"No logging configured for IoT Edge module\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_InconsistentModuleSettings\",\r\n            \"name\": \"SecurityGroup has inconsistent module settings\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_InstallAgent\",\r\n            \"name\": \"Install the Azure IoT Security agent\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_IPFilter_DenyAll\",\r\n            \"name\": \"Default IP filter policy should be deny\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_IPFilter_PermissiveRule\",\r\n            \"name\": \"IP filter rule includes a large IP range\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_OpenPorts\",\r\n            \"name\": \"Device has open ports\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveFirewallPolicy\",\r\n            \"name\": \"Permissive firewall policy in one of the chains\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveInputFirewallRules\",\r\n            \"name\": \"Permissive firewall rule in the input chain\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveOutputFirewallRules\",\r\n            \"name\": \"Permissive firewall rule in the output chain\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PrivilegedDockerOptions\",\r\n            \"name\": \"High level permissions configured in IoT Edge model twin for IoT Edge module\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_RecommendedIpRulesByBaseLine\",\r\n            \"name\": \"Recommended Rules for ip filter\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_SharedCredentials\",\r\n            \"name\": \"Same authentication credentials used by multiple devices\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_VulnerableTLSCipherSuite\",\r\n            \"name\": \"TLS cipher suite upgrade needed\",\r\n            \"status\": \"Enabled\"\r\n          }\r\n        ],\r\n        \"autoDiscoveredResources\": [],\r\n        \"unmaskedIpLoggingStatus\": \"Disabled\"\r\n      },\r\n      \"tags\": {}\r\n    },\r\n    {\r\n      \"id\": \"/subscriptions/075423e9-7d33-4166-8bdf-3920b04e3735/resourceGroups/michalresourcegroup/providers/Microsoft.Security/IoTSecuritySolutions/michaliothubtest\",\r\n      \"name\": \"michaliothubtest\",\r\n      \"type\": \"Microsoft.Security/IoTSecuritySolutions\",\r\n      \"location\": \"West US\",\r\n      \"properties\": {\r\n        \"displayName\": \"MichalIoTHubTest\",\r\n        \"status\": \"Enabled\",\r\n        \"export\": [\r\n          \"RawEvents\"\r\n        ],\r\n        \"disabledDataSources\": [],\r\n        \"workspace\": null,\r\n        \"additionalWorkspaces\": null,\r\n        \"iotHubs\": [],\r\n        \"userDefinedResources\": {\r\n          \"query\": \"where type != \\\"microsoft.devices/iothubs\\\" | where (subscriptionId == \\\"075423e9-7d33-4166-8bdf-3920b04e3735\\\" and resourceGroup in~ (\\\"MichalResourceGroup\\\")) | project id, name, type\",\r\n          \"querySubscriptions\": [\r\n            \"075423e9-7d33-4166-8bdf-3920b04e3735\"\r\n          ]\r\n        },\r\n        \"recommendationsConfiguration\": [\r\n          {\r\n            \"recommendationType\": \"IoT_ACRAuthentication\",\r\n            \"name\": \"Service prinicpal not used with ACR repository\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_AgentSendsUnutilizedMessages\",\r\n            \"name\": \"Agent sending underutilized messages\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_Baseline\",\r\n            \"name\": \"Operating system (OS) baseline validation failure\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_EdgeHubMemOptimize\",\r\n            \"name\": \"IoT Edge Hub memory can be optimized\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_EdgeLoggingOptions\",\r\n            \"name\": \"No logging configured for IoT Edge module\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_InconsistentModuleSettings\",\r\n            \"name\": \"SecurityGroup has inconsistent module settings\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_InstallAgent\",\r\n            \"name\": \"Install the Azure IoT Security agent\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_IPFilter_DenyAll\",\r\n            \"name\": \"Default IP filter policy should be deny\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_IPFilter_PermissiveRule\",\r\n            \"name\": \"IP filter rule includes a large IP range\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_OpenPorts\",\r\n            \"name\": \"Device has open ports\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveFirewallPolicy\",\r\n            \"name\": \"Permissive firewall policy in one of the chains\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveInputFirewallRules\",\r\n            \"name\": \"Permissive firewall rule in the input chain\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveOutputFirewallRules\",\r\n            \"name\": \"Permissive firewall rule in the output chain\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PrivilegedDockerOptions\",\r\n            \"name\": \"High level permissions configured in IoT Edge model twin for IoT Edge module\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_RecommendedIpRulesByBaseLine\",\r\n            \"name\": \"Recommended Rules for ip filter\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_SharedCredentials\",\r\n            \"name\": \"Same authentication credentials used by multiple devices\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_VulnerableTLSCipherSuite\",\r\n            \"name\": \"TLS cipher suite upgrade needed\",\r\n            \"status\": \"Enabled\"\r\n          }\r\n        ],\r\n        \"autoDiscoveredResources\": [],\r\n        \"unmaskedIpLoggingStatus\": \"Disabled\"\r\n      },\r\n      \"tags\": {}\r\n    },\r\n    {\r\n      \"id\": \"/subscriptions/075423e9-7d33-4166-8bdf-3920b04e3735/resourceGroups/michalresourcegroup/providers/Microsoft.Security/IoTSecuritySolutions/michaliothub3\",\r\n      \"name\": \"michaliothub3\",\r\n      \"type\": \"Microsoft.Security/IoTSecuritySolutions\",\r\n      \"location\": \"West US\",\r\n      \"properties\": {\r\n        \"displayName\": \"MichalIoTHub3\",\r\n        \"status\": \"Enabled\",\r\n        \"export\": [\r\n          \"RawEvents\"\r\n        ],\r\n        \"disabledDataSources\": [],\r\n        \"workspace\": \"/subscriptions/075423e9-7d33-4166-8bdf-3920b04e3735/resourcegroups/michalresourcegroup/providers/microsoft.operationalinsights/workspaces/075423e9-7d33-4166-8bdf-3920b04e3735-iothubworkspace6\",\r\n        \"additionalWorkspaces\": null,\r\n        \"iotHubs\": [],\r\n        \"userDefinedResources\": {\r\n          \"query\": null,\r\n          \"querySubscriptions\": null\r\n        },\r\n        \"recommendationsConfiguration\": [\r\n          {\r\n            \"recommendationType\": \"IoT_ACRAuthentication\",\r\n            \"name\": \"Service prinicpal not used with ACR repository\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_AgentSendsUnutilizedMessages\",\r\n            \"name\": \"Agent sending underutilized messages\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_Baseline\",\r\n            \"name\": \"Operating system (OS) baseline validation failure\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_EdgeHubMemOptimize\",\r\n            \"name\": \"IoT Edge Hub memory can be optimized\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_EdgeLoggingOptions\",\r\n            \"name\": \"No logging configured for IoT Edge module\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_InconsistentModuleSettings\",\r\n            \"name\": \"SecurityGroup has inconsistent module settings\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_InstallAgent\",\r\n            \"name\": \"Install the Azure IoT Security agent\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_IPFilter_DenyAll\",\r\n            \"name\": \"Default IP filter policy should be deny\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_IPFilter_PermissiveRule\",\r\n            \"name\": \"IP filter rule includes a large IP range\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_OpenPorts\",\r\n            \"name\": \"Device has open ports\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveFirewallPolicy\",\r\n            \"name\": \"Permissive firewall policy in one of the chains\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveInputFirewallRules\",\r\n            \"name\": \"Permissive firewall rule in the input chain\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveOutputFirewallRules\",\r\n            \"name\": \"Permissive firewall rule in the output chain\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PrivilegedDockerOptions\",\r\n            \"name\": \"High level permissions configured in IoT Edge model twin for IoT Edge module\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_RecommendedIpRulesByBaseLine\",\r\n            \"name\": \"Recommended Rules for ip filter\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_SharedCredentials\",\r\n            \"name\": \"Same authentication credentials used by multiple devices\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_VulnerableTLSCipherSuite\",\r\n            \"name\": \"TLS cipher suite upgrade needed\",\r\n            \"status\": \"Enabled\"\r\n          }\r\n        ],\r\n        \"autoDiscoveredResources\": [],\r\n        \"unmaskedIpLoggingStatus\": \"Disabled\"\r\n      },\r\n      \"tags\": {}\r\n    },\r\n    {\r\n      \"id\": \"/subscriptions/075423e9-7d33-4166-8bdf-3920b04e3735/resourceGroups/michalresourcegroup/providers/Microsoft.Security/IoTSecuritySolutions/michaliothub2\",\r\n      \"name\": \"michaliothub2\",\r\n      \"type\": \"Microsoft.Security/IoTSecuritySolutions\",\r\n      \"location\": \"West US\",\r\n      \"properties\": {\r\n        \"displayName\": \"MichalIoTHub2\",\r\n        \"status\": \"Enabled\",\r\n        \"export\": [\r\n          \"RawEvents\"\r\n        ],\r\n        \"disabledDataSources\": [],\r\n        \"workspace\": \"/subscriptions/075423e9-7d33-4166-8bdf-3920b04e3735/resourcegroups/michalresourcegroup/providers/microsoft.operationalinsights/workspaces/075423e9-7d33-4166-8bdf-3920b04e3735-iothubworkspace5\",\r\n        \"additionalWorkspaces\": null,\r\n        \"iotHubs\": [],\r\n        \"userDefinedResources\": {\r\n          \"query\": null,\r\n          \"querySubscriptions\": null\r\n        },\r\n        \"recommendationsConfiguration\": [\r\n          {\r\n            \"recommendationType\": \"IoT_ACRAuthentication\",\r\n            \"name\": \"Service prinicpal not used with ACR repository\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_AgentSendsUnutilizedMessages\",\r\n            \"name\": \"Agent sending underutilized messages\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_Baseline\",\r\n            \"name\": \"Operating system (OS) baseline validation failure\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_EdgeHubMemOptimize\",\r\n            \"name\": \"IoT Edge Hub memory can be optimized\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_EdgeLoggingOptions\",\r\n            \"name\": \"No logging configured for IoT Edge module\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_InconsistentModuleSettings\",\r\n            \"name\": \"SecurityGroup has inconsistent module settings\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_InstallAgent\",\r\n            \"name\": \"Install the Azure IoT Security agent\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_IPFilter_DenyAll\",\r\n            \"name\": \"Default IP filter policy should be deny\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_IPFilter_PermissiveRule\",\r\n            \"name\": \"IP filter rule includes a large IP range\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_OpenPorts\",\r\n            \"name\": \"Device has open ports\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveFirewallPolicy\",\r\n            \"name\": \"Permissive firewall policy in one of the chains\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveInputFirewallRules\",\r\n            \"name\": \"Permissive firewall rule in the input chain\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveOutputFirewallRules\",\r\n            \"name\": \"Permissive firewall rule in the output chain\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PrivilegedDockerOptions\",\r\n            \"name\": \"High level permissions configured in IoT Edge model twin for IoT Edge module\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_RecommendedIpRulesByBaseLine\",\r\n            \"name\": \"Recommended Rules for ip filter\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_SharedCredentials\",\r\n            \"name\": \"Same authentication credentials used by multiple devices\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_VulnerableTLSCipherSuite\",\r\n            \"name\": \"TLS cipher suite upgrade needed\",\r\n            \"status\": \"Enabled\"\r\n          }\r\n        ],\r\n        \"autoDiscoveredResources\": [],\r\n        \"unmaskedIpLoggingStatus\": \"Disabled\"\r\n      },\r\n      \"tags\": {}\r\n    },\r\n    {\r\n      \"id\": \"/subscriptions/075423e9-7d33-4166-8bdf-3920b04e3735/resourceGroups/michalresourcegroup/providers/Microsoft.Security/IoTSecuritySolutions/michaliothub1\",\r\n      \"name\": \"michaliothub1\",\r\n      \"type\": \"Microsoft.Security/IoTSecuritySolutions\",\r\n      \"location\": \"West US\",\r\n      \"properties\": {\r\n        \"displayName\": \"MichalIoTHub1\",\r\n        \"status\": \"Enabled\",\r\n        \"export\": [\r\n          \"RawEvents\"\r\n        ],\r\n        \"disabledDataSources\": [],\r\n        \"workspace\": \"/subscriptions/075423e9-7d33-4166-8bdf-3920b04e3735/resourcegroups/michalresourcegroup/providers/microsoft.operationalinsights/workspaces/075423e9-7d33-4166-8bdf-3920b04e3735-iothubworkspace6\",\r\n        \"additionalWorkspaces\": null,\r\n        \"iotHubs\": [],\r\n        \"userDefinedResources\": {\r\n          \"query\": null,\r\n          \"querySubscriptions\": null\r\n        },\r\n        \"recommendationsConfiguration\": [\r\n          {\r\n            \"recommendationType\": \"IoT_ACRAuthentication\",\r\n            \"name\": \"Service prinicpal not used with ACR repository\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_AgentSendsUnutilizedMessages\",\r\n            \"name\": \"Agent sending underutilized messages\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_Baseline\",\r\n            \"name\": \"Operating system (OS) baseline validation failure\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_EdgeHubMemOptimize\",\r\n            \"name\": \"IoT Edge Hub memory can be optimized\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_EdgeLoggingOptions\",\r\n            \"name\": \"No logging configured for IoT Edge module\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_InconsistentModuleSettings\",\r\n            \"name\": \"SecurityGroup has inconsistent module settings\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_InstallAgent\",\r\n            \"name\": \"Install the Azure IoT Security agent\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_IPFilter_DenyAll\",\r\n            \"name\": \"Default IP filter policy should be deny\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_IPFilter_PermissiveRule\",\r\n            \"name\": \"IP filter rule includes a large IP range\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_OpenPorts\",\r\n            \"name\": \"Device has open ports\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveFirewallPolicy\",\r\n            \"name\": \"Permissive firewall policy in one of the chains\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveInputFirewallRules\",\r\n            \"name\": \"Permissive firewall rule in the input chain\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveOutputFirewallRules\",\r\n            \"name\": \"Permissive firewall rule in the output chain\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PrivilegedDockerOptions\",\r\n            \"name\": \"High level permissions configured in IoT Edge model twin for IoT Edge module\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_RecommendedIpRulesByBaseLine\",\r\n            \"name\": \"Recommended Rules for ip filter\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_SharedCredentials\",\r\n            \"name\": \"Same authentication credentials used by multiple devices\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_VulnerableTLSCipherSuite\",\r\n            \"name\": \"TLS cipher suite upgrade needed\",\r\n            \"status\": \"Enabled\"\r\n          }\r\n        ],\r\n        \"autoDiscoveredResources\": [],\r\n        \"unmaskedIpLoggingStatus\": \"Disabled\"\r\n      },\r\n      \"tags\": {}\r\n    },\r\n    {\r\n      \"id\": \"/subscriptions/075423e9-7d33-4166-8bdf-3920b04e3735/resourceGroups/michalresourcegroup/providers/Microsoft.Security/IoTSecuritySolutions/michaliothubfortest\",\r\n      \"name\": \"michaliothubfortest\",\r\n      \"type\": \"Microsoft.Security/IoTSecuritySolutions\",\r\n      \"location\": \"West US\",\r\n      \"properties\": {\r\n        \"displayName\": \"MichalIoTHubForTest\",\r\n        \"status\": \"Enabled\",\r\n        \"export\": [\r\n          \"RawEvents\"\r\n        ],\r\n        \"disabledDataSources\": [],\r\n        \"workspace\": \"/subscriptions/075423e9-7d33-4166-8bdf-3920b04e3735/resourcegroups/michalresourcegroup/providers/microsoft.operationalinsights/workspaces/075423e9-7d33-4166-8bdf-3920b04e3735-iothubworkspace8\",\r\n        \"additionalWorkspaces\": null,\r\n        \"iotHubs\": [],\r\n        \"userDefinedResources\": {\r\n          \"query\": \"where type != \\\"microsoft.devices/iothubs\\\" | where (subscriptionId == \\\"075423e9-7d33-4166-8bdf-3920b04e3735\\\" and resourceGroup in~ (\\\"MichalResourceGroup\\\")) | project id, name, type\",\r\n          \"querySubscriptions\": [\r\n            \"075423e9-7d33-4166-8bdf-3920b04e3735\"\r\n          ]\r\n        },\r\n        \"recommendationsConfiguration\": [\r\n          {\r\n            \"recommendationType\": \"IoT_ACRAuthentication\",\r\n            \"name\": \"Service prinicpal not used with ACR repository\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_AgentSendsUnutilizedMessages\",\r\n            \"name\": \"Agent sending underutilized messages\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_Baseline\",\r\n            \"name\": \"Operating system (OS) baseline validation failure\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_EdgeHubMemOptimize\",\r\n            \"name\": \"IoT Edge Hub memory can be optimized\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_EdgeLoggingOptions\",\r\n            \"name\": \"No logging configured for IoT Edge module\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_InconsistentModuleSettings\",\r\n            \"name\": \"SecurityGroup has inconsistent module settings\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_InstallAgent\",\r\n            \"name\": \"Install the Azure IoT Security agent\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_IPFilter_DenyAll\",\r\n            \"name\": \"Default IP filter policy should be deny\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_IPFilter_PermissiveRule\",\r\n            \"name\": \"IP filter rule includes a large IP range\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_OpenPorts\",\r\n            \"name\": \"Device has open ports\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveFirewallPolicy\",\r\n            \"name\": \"Permissive firewall policy in one of the chains\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveInputFirewallRules\",\r\n            \"name\": \"Permissive firewall rule in the input chain\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveOutputFirewallRules\",\r\n            \"name\": \"Permissive firewall rule in the output chain\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PrivilegedDockerOptions\",\r\n            \"name\": \"High level permissions configured in IoT Edge model twin for IoT Edge module\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_RecommendedIpRulesByBaseLine\",\r\n            \"name\": \"Recommended Rules for ip filter\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_SharedCredentials\",\r\n            \"name\": \"Same authentication credentials used by multiple devices\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_VulnerableTLSCipherSuite\",\r\n            \"name\": \"TLS cipher suite upgrade needed\",\r\n            \"status\": \"Enabled\"\r\n          }\r\n        ],\r\n        \"autoDiscoveredResources\": [],\r\n        \"unmaskedIpLoggingStatus\": \"Disabled\"\r\n      },\r\n      \"tags\": {}\r\n    },\r\n    {\r\n      \"id\": \"/subscriptions/075423e9-7d33-4166-8bdf-3920b04e3735/resourceGroups/michalresourcegroup/providers/Microsoft.Security/IoTSecuritySolutions/michaliothubtest3\",\r\n      \"name\": \"michaliothubtest3\",\r\n      \"type\": \"Microsoft.Security/IoTSecuritySolutions\",\r\n      \"location\": \"West US\",\r\n      \"properties\": {\r\n        \"displayName\": \"MichalIoTHubTest3\",\r\n        \"status\": \"Enabled\",\r\n        \"export\": [\r\n          \"RawEvents\"\r\n        ],\r\n        \"disabledDataSources\": [],\r\n        \"workspace\": \"/subscriptions/075423e9-7d33-4166-8bdf-3920b04e3735/resourcegroups/michalresourcegroup/providers/microsoft.operationalinsights/workspaces/075423e9-7d33-4166-8bdf-3920b04e3735-iothubworkspace9\",\r\n        \"additionalWorkspaces\": null,\r\n        \"iotHubs\": [],\r\n        \"userDefinedResources\": {\r\n          \"query\": \"where type != \\\"microsoft.devices/iothubs\\\" | where (subscriptionId == \\\"075423e9-7d33-4166-8bdf-3920b04e3735\\\" and resourceGroup in~ (\\\"MichalResourceGroup\\\")) | project id, name, type\",\r\n          \"querySubscriptions\": [\r\n            \"075423e9-7d33-4166-8bdf-3920b04e3735\"\r\n          ]\r\n        },\r\n        \"recommendationsConfiguration\": [\r\n          {\r\n            \"recommendationType\": \"IoT_ACRAuthentication\",\r\n            \"name\": \"Service prinicpal not used with ACR repository\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_AgentSendsUnutilizedMessages\",\r\n            \"name\": \"Agent sending underutilized messages\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_Baseline\",\r\n            \"name\": \"Operating system (OS) baseline validation failure\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_EdgeHubMemOptimize\",\r\n            \"name\": \"IoT Edge Hub memory can be optimized\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_EdgeLoggingOptions\",\r\n            \"name\": \"No logging configured for IoT Edge module\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_InconsistentModuleSettings\",\r\n            \"name\": \"SecurityGroup has inconsistent module settings\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_InstallAgent\",\r\n            \"name\": \"Install the Azure IoT Security agent\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_IPFilter_DenyAll\",\r\n            \"name\": \"Default IP filter policy should be deny\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_IPFilter_PermissiveRule\",\r\n            \"name\": \"IP filter rule includes a large IP range\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_OpenPorts\",\r\n            \"name\": \"Device has open ports\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveFirewallPolicy\",\r\n            \"name\": \"Permissive firewall policy in one of the chains\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveInputFirewallRules\",\r\n            \"name\": \"Permissive firewall rule in the input chain\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveOutputFirewallRules\",\r\n            \"name\": \"Permissive firewall rule in the output chain\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PrivilegedDockerOptions\",\r\n            \"name\": \"High level permissions configured in IoT Edge model twin for IoT Edge module\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_RecommendedIpRulesByBaseLine\",\r\n            \"name\": \"Recommended Rules for ip filter\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_SharedCredentials\",\r\n            \"name\": \"Same authentication credentials used by multiple devices\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_VulnerableTLSCipherSuite\",\r\n            \"name\": \"TLS cipher suite upgrade needed\",\r\n            \"status\": \"Enabled\"\r\n          }\r\n        ],\r\n        \"autoDiscoveredResources\": [],\r\n        \"unmaskedIpLoggingStatus\": \"Disabled\"\r\n      },\r\n      \"tags\": {}\r\n    },\r\n    {\r\n      \"id\": \"/subscriptions/075423e9-7d33-4166-8bdf-3920b04e3735/resourceGroups/michalresourcegroup/providers/Microsoft.Security/IoTSecuritySolutions/michaliothubtest4\",\r\n      \"name\": \"michaliothubtest4\",\r\n      \"type\": \"Microsoft.Security/IoTSecuritySolutions\",\r\n      \"location\": \"West US\",\r\n      \"properties\": {\r\n        \"displayName\": \"MichalIoTHubTest4\",\r\n        \"status\": \"Enabled\",\r\n        \"export\": [\r\n          \"RawEvents\"\r\n        ],\r\n        \"disabledDataSources\": [],\r\n        \"workspace\": \"/subscriptions/075423e9-7d33-4166-8bdf-3920b04e3735/resourcegroups/galm-iot-hub/providers/microsoft.operationalinsights/workspaces/075423e9-7d33-4166-8bdf-3920b04e3735-iothubworkspace10\",\r\n        \"additionalWorkspaces\": null,\r\n        \"iotHubs\": [],\r\n        \"userDefinedResources\": {\r\n          \"query\": \"where type != \\\"microsoft.devices/iothubs\\\" | where (subscriptionId == \\\"075423e9-7d33-4166-8bdf-3920b04e3735\\\" and resourceGroup in~ (\\\"michalresourcegroup\\\")) | project id, name, type\",\r\n          \"querySubscriptions\": [\r\n            \"075423e9-7d33-4166-8bdf-3920b04e3735\"\r\n          ]\r\n        },\r\n        \"recommendationsConfiguration\": [\r\n          {\r\n            \"recommendationType\": \"IoT_ACRAuthentication\",\r\n            \"name\": \"Service prinicpal not used with ACR repository\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_AgentSendsUnutilizedMessages\",\r\n            \"name\": \"Agent sending underutilized messages\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_Baseline\",\r\n            \"name\": \"Operating system (OS) baseline validation failure\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_EdgeHubMemOptimize\",\r\n            \"name\": \"IoT Edge Hub memory can be optimized\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_EdgeLoggingOptions\",\r\n            \"name\": \"No logging configured for IoT Edge module\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_InconsistentModuleSettings\",\r\n            \"name\": \"SecurityGroup has inconsistent module settings\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_InstallAgent\",\r\n            \"name\": \"Install the Azure IoT Security agent\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_IPFilter_DenyAll\",\r\n            \"name\": \"Default IP filter policy should be deny\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_IPFilter_PermissiveRule\",\r\n            \"name\": \"IP filter rule includes a large IP range\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_OpenPorts\",\r\n            \"name\": \"Device has open ports\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveFirewallPolicy\",\r\n            \"name\": \"Permissive firewall policy in one of the chains\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveInputFirewallRules\",\r\n            \"name\": \"Permissive firewall rule in the input chain\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveOutputFirewallRules\",\r\n            \"name\": \"Permissive firewall rule in the output chain\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PrivilegedDockerOptions\",\r\n            \"name\": \"High level permissions configured in IoT Edge model twin for IoT Edge module\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_RecommendedIpRulesByBaseLine\",\r\n            \"name\": \"Recommended Rules for ip filter\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_SharedCredentials\",\r\n            \"name\": \"Same authentication credentials used by multiple devices\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_VulnerableTLSCipherSuite\",\r\n            \"name\": \"TLS cipher suite upgrade needed\",\r\n            \"status\": \"Enabled\"\r\n          }\r\n        ],\r\n        \"autoDiscoveredResources\": [],\r\n        \"unmaskedIpLoggingStatus\": \"Disabled\"\r\n      },\r\n      \"tags\": {}\r\n    },\r\n    {\r\n      \"id\": \"/subscriptions/075423e9-7d33-4166-8bdf-3920b04e3735/resourceGroups/michalresourcegroup/providers/Microsoft.Security/IoTSecuritySolutions/michalhubonb2\",\r\n      \"name\": \"michalhubonb2\",\r\n      \"type\": \"Microsoft.Security/IoTSecuritySolutions\",\r\n      \"location\": \"West US\",\r\n      \"properties\": {\r\n        \"displayName\": \"MichalHubOnB2\",\r\n        \"status\": \"Enabled\",\r\n        \"export\": [],\r\n        \"disabledDataSources\": [\r\n          \"TwinData\"\r\n        ],\r\n        \"workspace\": null,\r\n        \"additionalWorkspaces\": null,\r\n        \"iotHubs\": [],\r\n        \"userDefinedResources\": {\r\n          \"query\": null,\r\n          \"querySubscriptions\": null\r\n        },\r\n        \"recommendationsConfiguration\": [\r\n          {\r\n            \"recommendationType\": \"IoT_ACRAuthentication\",\r\n            \"name\": \"Service prinicpal not used with ACR repository\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_AgentSendsUnutilizedMessages\",\r\n            \"name\": \"Agent sending underutilized messages\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_Baseline\",\r\n            \"name\": \"Operating system (OS) baseline validation failure\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_EdgeHubMemOptimize\",\r\n            \"name\": \"IoT Edge Hub memory can be optimized\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_EdgeLoggingOptions\",\r\n            \"name\": \"No logging configured for IoT Edge module\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_InconsistentModuleSettings\",\r\n            \"name\": \"SecurityGroup has inconsistent module settings\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_InstallAgent\",\r\n            \"name\": \"Install the Azure IoT Security agent\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_IPFilter_DenyAll\",\r\n            \"name\": \"Default IP filter policy should be deny\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_IPFilter_PermissiveRule\",\r\n            \"name\": \"IP filter rule includes a large IP range\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_OpenPorts\",\r\n            \"name\": \"Device has open ports\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveFirewallPolicy\",\r\n            \"name\": \"Permissive firewall policy in one of the chains\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveInputFirewallRules\",\r\n            \"name\": \"Permissive firewall rule in the input chain\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveOutputFirewallRules\",\r\n            \"name\": \"Permissive firewall rule in the output chain\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PrivilegedDockerOptions\",\r\n            \"name\": \"High level permissions configured in IoT Edge model twin for IoT Edge module\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_RecommendedIpRulesByBaseLine\",\r\n            \"name\": \"Recommended Rules for ip filter\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_SharedCredentials\",\r\n            \"name\": \"Same authentication credentials used by multiple devices\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_VulnerableTLSCipherSuite\",\r\n            \"name\": \"TLS cipher suite upgrade needed\",\r\n            \"status\": \"Enabled\"\r\n          }\r\n        ],\r\n        \"autoDiscoveredResources\": [],\r\n        \"unmaskedIpLoggingStatus\": \"Disabled\"\r\n      },\r\n      \"tags\": {}\r\n    },\r\n    {\r\n      \"id\": \"/subscriptions/075423e9-7d33-4166-8bdf-3920b04e3735/resourceGroups/michalresourcegroup/providers/Microsoft.Security/IoTSecuritySolutions/michalhubonb3\",\r\n      \"name\": \"michalhubonb3\",\r\n      \"type\": \"Microsoft.Security/IoTSecuritySolutions\",\r\n      \"location\": \"West US\",\r\n      \"properties\": {\r\n        \"displayName\": \"MichalHubOnB3\",\r\n        \"status\": \"Enabled\",\r\n        \"export\": [\r\n          \"RawEvents\"\r\n        ],\r\n        \"disabledDataSources\": [],\r\n        \"workspace\": \"/subscriptions/075423e9-7d33-4166-8bdf-3920b04e3735/resourcegroups/galm-iot-hub/providers/microsoft.operationalinsights/workspaces/075423e9-7d33-4166-8bdf-3920b04e3735-iothubworkspace10\",\r\n        \"additionalWorkspaces\": null,\r\n        \"iotHubs\": [],\r\n        \"userDefinedResources\": {\r\n          \"query\": \"where type != \\\"microsoft.devices/iothubs\\\" | where (subscriptionId == \\\"075423e9-7d33-4166-8bdf-3920b04e3735\\\" and resourceGroup in~ (\\\"michalresourcegroup\\\")) | project id, name, type\",\r\n          \"querySubscriptions\": [\r\n            \"075423e9-7d33-4166-8bdf-3920b04e3735\"\r\n          ]\r\n        },\r\n        \"recommendationsConfiguration\": [\r\n          {\r\n            \"recommendationType\": \"IoT_ACRAuthentication\",\r\n            \"name\": \"Service prinicpal not used with ACR repository\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_AgentSendsUnutilizedMessages\",\r\n            \"name\": \"Agent sending underutilized messages\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_Baseline\",\r\n            \"name\": \"Operating system (OS) baseline validation failure\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_EdgeHubMemOptimize\",\r\n            \"name\": \"IoT Edge Hub memory can be optimized\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_EdgeLoggingOptions\",\r\n            \"name\": \"No logging configured for IoT Edge module\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_InconsistentModuleSettings\",\r\n            \"name\": \"SecurityGroup has inconsistent module settings\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_InstallAgent\",\r\n            \"name\": \"Install the Azure IoT Security agent\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_IPFilter_DenyAll\",\r\n            \"name\": \"Default IP filter policy should be deny\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_IPFilter_PermissiveRule\",\r\n            \"name\": \"IP filter rule includes a large IP range\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_OpenPorts\",\r\n            \"name\": \"Device has open ports\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveFirewallPolicy\",\r\n            \"name\": \"Permissive firewall policy in one of the chains\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveInputFirewallRules\",\r\n            \"name\": \"Permissive firewall rule in the input chain\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveOutputFirewallRules\",\r\n            \"name\": \"Permissive firewall rule in the output chain\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PrivilegedDockerOptions\",\r\n            \"name\": \"High level permissions configured in IoT Edge model twin for IoT Edge module\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_RecommendedIpRulesByBaseLine\",\r\n            \"name\": \"Recommended Rules for ip filter\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_SharedCredentials\",\r\n            \"name\": \"Same authentication credentials used by multiple devices\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_VulnerableTLSCipherSuite\",\r\n            \"name\": \"TLS cipher suite upgrade needed\",\r\n            \"status\": \"Enabled\"\r\n          }\r\n        ],\r\n        \"autoDiscoveredResources\": [],\r\n        \"unmaskedIpLoggingStatus\": \"Disabled\"\r\n      },\r\n      \"tags\": {}\r\n    },\r\n    {\r\n      \"id\": \"/subscriptions/075423e9-7d33-4166-8bdf-3920b04e3735/resourceGroups/michalresourcegroup/providers/Microsoft.Security/IoTSecuritySolutions/michalhubonb1\",\r\n      \"name\": \"michalhubonb1\",\r\n      \"type\": \"Microsoft.Security/IoTSecuritySolutions\",\r\n      \"location\": \"West US\",\r\n      \"properties\": {\r\n        \"displayName\": \"MichalHubOnB1\",\r\n        \"status\": \"Enabled\",\r\n        \"export\": [\r\n          \"RawEvents\"\r\n        ],\r\n        \"disabledDataSources\": [],\r\n        \"workspace\": \"/subscriptions/075423e9-7d33-4166-8bdf-3920b04e3735/resourcegroups/galm-iot-hub/providers/microsoft.operationalinsights/workspaces/075423e9-7d33-4166-8bdf-3920b04e3735-iothubworkspace10\",\r\n        \"additionalWorkspaces\": null,\r\n        \"iotHubs\": [],\r\n        \"userDefinedResources\": {\r\n          \"query\": \"where type != \\\"microsoft.devices/iothubs\\\" | where (subscriptionId == \\\"075423e9-7d33-4166-8bdf-3920b04e3735\\\" and resourceGroup in~ (\\\"michalresourcegroup\\\")) | project id, name, type\",\r\n          \"querySubscriptions\": [\r\n            \"075423e9-7d33-4166-8bdf-3920b04e3735\"\r\n          ]\r\n        },\r\n        \"recommendationsConfiguration\": [\r\n          {\r\n            \"recommendationType\": \"IoT_ACRAuthentication\",\r\n            \"name\": \"Service prinicpal not used with ACR repository\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_AgentSendsUnutilizedMessages\",\r\n            \"name\": \"Agent sending underutilized messages\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_Baseline\",\r\n            \"name\": \"Operating system (OS) baseline validation failure\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_EdgeHubMemOptimize\",\r\n            \"name\": \"IoT Edge Hub memory can be optimized\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_EdgeLoggingOptions\",\r\n            \"name\": \"No logging configured for IoT Edge module\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_InconsistentModuleSettings\",\r\n            \"name\": \"SecurityGroup has inconsistent module settings\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_InstallAgent\",\r\n            \"name\": \"Install the Azure IoT Security agent\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_IPFilter_DenyAll\",\r\n            \"name\": \"Default IP filter policy should be deny\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_IPFilter_PermissiveRule\",\r\n            \"name\": \"IP filter rule includes a large IP range\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_OpenPorts\",\r\n            \"name\": \"Device has open ports\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveFirewallPolicy\",\r\n            \"name\": \"Permissive firewall policy in one of the chains\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveInputFirewallRules\",\r\n            \"name\": \"Permissive firewall rule in the input chain\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveOutputFirewallRules\",\r\n            \"name\": \"Permissive firewall rule in the output chain\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PrivilegedDockerOptions\",\r\n            \"name\": \"High level permissions configured in IoT Edge model twin for IoT Edge module\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_RecommendedIpRulesByBaseLine\",\r\n            \"name\": \"Recommended Rules for ip filter\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_SharedCredentials\",\r\n            \"name\": \"Same authentication credentials used by multiple devices\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_VulnerableTLSCipherSuite\",\r\n            \"name\": \"TLS cipher suite upgrade needed\",\r\n            \"status\": \"Enabled\"\r\n          }\r\n        ],\r\n        \"autoDiscoveredResources\": [],\r\n        \"unmaskedIpLoggingStatus\": \"Disabled\"\r\n      },\r\n      \"tags\": {}\r\n    },\r\n    {\r\n      \"id\": \"/subscriptions/075423e9-7d33-4166-8bdf-3920b04e3735/resourceGroups/michalresourcegroup/providers/Microsoft.Security/IoTSecuritySolutions/michalhubonb4\",\r\n      \"name\": \"michalhubonb4\",\r\n      \"type\": \"Microsoft.Security/IoTSecuritySolutions\",\r\n      \"location\": \"West US\",\r\n      \"properties\": {\r\n        \"displayName\": \"MichalHubOnB4\",\r\n        \"status\": \"Enabled\",\r\n        \"export\": [\r\n          \"RawEvents\"\r\n        ],\r\n        \"disabledDataSources\": [],\r\n        \"workspace\": \"/subscriptions/075423e9-7d33-4166-8bdf-3920b04e3735/resourcegroups/galm-iot-hub/providers/microsoft.operationalinsights/workspaces/075423e9-7d33-4166-8bdf-3920b04e3735-iothubworkspace10\",\r\n        \"additionalWorkspaces\": null,\r\n        \"iotHubs\": [],\r\n        \"userDefinedResources\": {\r\n          \"query\": \"where type != \\\"microsoft.devices/iothubs\\\" | where (subscriptionId == \\\"075423e9-7d33-4166-8bdf-3920b04e3735\\\" and resourceGroup in~ (\\\"michalresourcegroup\\\")) | project id, name, type\",\r\n          \"querySubscriptions\": [\r\n            \"075423e9-7d33-4166-8bdf-3920b04e3735\"\r\n          ]\r\n        },\r\n        \"recommendationsConfiguration\": [\r\n          {\r\n            \"recommendationType\": \"IoT_ACRAuthentication\",\r\n            \"name\": \"Service prinicpal not used with ACR repository\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_AgentSendsUnutilizedMessages\",\r\n            \"name\": \"Agent sending underutilized messages\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_Baseline\",\r\n            \"name\": \"Operating system (OS) baseline validation failure\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_EdgeHubMemOptimize\",\r\n            \"name\": \"IoT Edge Hub memory can be optimized\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_EdgeLoggingOptions\",\r\n            \"name\": \"No logging configured for IoT Edge module\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_InconsistentModuleSettings\",\r\n            \"name\": \"SecurityGroup has inconsistent module settings\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_InstallAgent\",\r\n            \"name\": \"Install the Azure IoT Security agent\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_IPFilter_DenyAll\",\r\n            \"name\": \"Default IP filter policy should be deny\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_IPFilter_PermissiveRule\",\r\n            \"name\": \"IP filter rule includes a large IP range\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_OpenPorts\",\r\n            \"name\": \"Device has open ports\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveFirewallPolicy\",\r\n            \"name\": \"Permissive firewall policy in one of the chains\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveInputFirewallRules\",\r\n            \"name\": \"Permissive firewall rule in the input chain\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveOutputFirewallRules\",\r\n            \"name\": \"Permissive firewall rule in the output chain\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PrivilegedDockerOptions\",\r\n            \"name\": \"High level permissions configured in IoT Edge model twin for IoT Edge module\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_RecommendedIpRulesByBaseLine\",\r\n            \"name\": \"Recommended Rules for ip filter\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_SharedCredentials\",\r\n            \"name\": \"Same authentication credentials used by multiple devices\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_VulnerableTLSCipherSuite\",\r\n            \"name\": \"TLS cipher suite upgrade needed\",\r\n            \"status\": \"Enabled\"\r\n          }\r\n        ],\r\n        \"autoDiscoveredResources\": [],\r\n        \"unmaskedIpLoggingStatus\": \"Disabled\"\r\n      },\r\n      \"tags\": {}\r\n    },\r\n    {\r\n      \"id\": \"/subscriptions/075423e9-7d33-4166-8bdf-3920b04e3735/resourceGroups/michalresourcegroup/providers/Microsoft.Security/IoTSecuritySolutions/michalhubonb5\",\r\n      \"name\": \"michalhubonb5\",\r\n      \"type\": \"Microsoft.Security/IoTSecuritySolutions\",\r\n      \"location\": \"West US\",\r\n      \"properties\": {\r\n        \"displayName\": \"MichalHubOnB5\",\r\n        \"status\": \"Enabled\",\r\n        \"export\": [\r\n          \"RawEvents\"\r\n        ],\r\n        \"disabledDataSources\": [],\r\n        \"workspace\": \"/subscriptions/075423e9-7d33-4166-8bdf-3920b04e3735/resourcegroups/galm-iot-hub/providers/microsoft.operationalinsights/workspaces/075423e9-7d33-4166-8bdf-3920b04e3735-iothubworkspace10\",\r\n        \"additionalWorkspaces\": null,\r\n        \"iotHubs\": [],\r\n        \"userDefinedResources\": {\r\n          \"query\": \"where type != \\\"microsoft.devices/iothubs\\\" | where (subscriptionId == \\\"075423e9-7d33-4166-8bdf-3920b04e3735\\\" and resourceGroup in~ (\\\"michalresourcegroup\\\")) | project id, name, type\",\r\n          \"querySubscriptions\": [\r\n            \"075423e9-7d33-4166-8bdf-3920b04e3735\"\r\n          ]\r\n        },\r\n        \"recommendationsConfiguration\": [\r\n          {\r\n            \"recommendationType\": \"IoT_ACRAuthentication\",\r\n            \"name\": \"Service prinicpal not used with ACR repository\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_AgentSendsUnutilizedMessages\",\r\n            \"name\": \"Agent sending underutilized messages\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_Baseline\",\r\n            \"name\": \"Operating system (OS) baseline validation failure\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_EdgeHubMemOptimize\",\r\n            \"name\": \"IoT Edge Hub memory can be optimized\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_EdgeLoggingOptions\",\r\n            \"name\": \"No logging configured for IoT Edge module\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_InconsistentModuleSettings\",\r\n            \"name\": \"SecurityGroup has inconsistent module settings\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_InstallAgent\",\r\n            \"name\": \"Install the Azure IoT Security agent\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_IPFilter_DenyAll\",\r\n            \"name\": \"Default IP filter policy should be deny\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_IPFilter_PermissiveRule\",\r\n            \"name\": \"IP filter rule includes a large IP range\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_OpenPorts\",\r\n            \"name\": \"Device has open ports\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveFirewallPolicy\",\r\n            \"name\": \"Permissive firewall policy in one of the chains\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveInputFirewallRules\",\r\n            \"name\": \"Permissive firewall rule in the input chain\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveOutputFirewallRules\",\r\n            \"name\": \"Permissive firewall rule in the output chain\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PrivilegedDockerOptions\",\r\n            \"name\": \"High level permissions configured in IoT Edge model twin for IoT Edge module\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_RecommendedIpRulesByBaseLine\",\r\n            \"name\": \"Recommended Rules for ip filter\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_SharedCredentials\",\r\n            \"name\": \"Same authentication credentials used by multiple devices\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_VulnerableTLSCipherSuite\",\r\n            \"name\": \"TLS cipher suite upgrade needed\",\r\n            \"status\": \"Enabled\"\r\n          }\r\n        ],\r\n        \"autoDiscoveredResources\": [],\r\n        \"unmaskedIpLoggingStatus\": \"Disabled\"\r\n      },\r\n      \"tags\": {}\r\n    },\r\n    {\r\n      \"id\": \"/subscriptions/075423e9-7d33-4166-8bdf-3920b04e3735/resourceGroups/michalresourcegroup/providers/Microsoft.Security/IoTSecuritySolutions/michalhubonb6\",\r\n      \"name\": \"michalhubonb6\",\r\n      \"type\": \"Microsoft.Security/IoTSecuritySolutions\",\r\n      \"location\": \"West US\",\r\n      \"properties\": {\r\n        \"displayName\": \"MichalHubOnB6\",\r\n        \"status\": \"Enabled\",\r\n        \"export\": [\r\n          \"RawEvents\"\r\n        ],\r\n        \"disabledDataSources\": [],\r\n        \"workspace\": \"/subscriptions/075423e9-7d33-4166-8bdf-3920b04e3735/resourcegroups/galm-iot-hub/providers/microsoft.operationalinsights/workspaces/075423e9-7d33-4166-8bdf-3920b04e3735-iothubworkspace10\",\r\n        \"additionalWorkspaces\": null,\r\n        \"iotHubs\": [],\r\n        \"userDefinedResources\": {\r\n          \"query\": \"where type != \\\"microsoft.devices/iothubs\\\" | where (subscriptionId == \\\"075423e9-7d33-4166-8bdf-3920b04e3735\\\" and resourceGroup in~ (\\\"michalresourcegroup\\\")) | project id, name, type\",\r\n          \"querySubscriptions\": [\r\n            \"075423e9-7d33-4166-8bdf-3920b04e3735\"\r\n          ]\r\n        },\r\n        \"recommendationsConfiguration\": [\r\n          {\r\n            \"recommendationType\": \"IoT_ACRAuthentication\",\r\n            \"name\": \"Service prinicpal not used with ACR repository\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_AgentSendsUnutilizedMessages\",\r\n            \"name\": \"Agent sending underutilized messages\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_Baseline\",\r\n            \"name\": \"Operating system (OS) baseline validation failure\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_EdgeHubMemOptimize\",\r\n            \"name\": \"IoT Edge Hub memory can be optimized\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_EdgeLoggingOptions\",\r\n            \"name\": \"No logging configured for IoT Edge module\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_InconsistentModuleSettings\",\r\n            \"name\": \"SecurityGroup has inconsistent module settings\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_InstallAgent\",\r\n            \"name\": \"Install the Azure IoT Security agent\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_IPFilter_DenyAll\",\r\n            \"name\": \"Default IP filter policy should be deny\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_IPFilter_PermissiveRule\",\r\n            \"name\": \"IP filter rule includes a large IP range\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_OpenPorts\",\r\n            \"name\": \"Device has open ports\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveFirewallPolicy\",\r\n            \"name\": \"Permissive firewall policy in one of the chains\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveInputFirewallRules\",\r\n            \"name\": \"Permissive firewall rule in the input chain\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveOutputFirewallRules\",\r\n            \"name\": \"Permissive firewall rule in the output chain\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PrivilegedDockerOptions\",\r\n            \"name\": \"High level permissions configured in IoT Edge model twin for IoT Edge module\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_RecommendedIpRulesByBaseLine\",\r\n            \"name\": \"Recommended Rules for ip filter\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_SharedCredentials\",\r\n            \"name\": \"Same authentication credentials used by multiple devices\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_VulnerableTLSCipherSuite\",\r\n            \"name\": \"TLS cipher suite upgrade needed\",\r\n            \"status\": \"Enabled\"\r\n          }\r\n        ],\r\n        \"autoDiscoveredResources\": [],\r\n        \"unmaskedIpLoggingStatus\": \"Disabled\"\r\n      },\r\n      \"tags\": {}\r\n    },\r\n    {\r\n      \"id\": \"/subscriptions/075423e9-7d33-4166-8bdf-3920b04e3735/resourceGroups/michalresourcegroup/providers/Microsoft.Security/IoTSecuritySolutions/michalhubonb7\",\r\n      \"name\": \"michalhubonb7\",\r\n      \"type\": \"Microsoft.Security/IoTSecuritySolutions\",\r\n      \"location\": \"West US\",\r\n      \"properties\": {\r\n        \"displayName\": \"MichalHubOnB7\",\r\n        \"status\": \"Enabled\",\r\n        \"export\": [],\r\n        \"disabledDataSources\": [\r\n          \"TwinData\"\r\n        ],\r\n        \"workspace\": null,\r\n        \"additionalWorkspaces\": null,\r\n        \"iotHubs\": [],\r\n        \"userDefinedResources\": {\r\n          \"query\": null,\r\n          \"querySubscriptions\": null\r\n        },\r\n        \"recommendationsConfiguration\": [\r\n          {\r\n            \"recommendationType\": \"IoT_ACRAuthentication\",\r\n            \"name\": \"Service prinicpal not used with ACR repository\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_AgentSendsUnutilizedMessages\",\r\n            \"name\": \"Agent sending underutilized messages\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_Baseline\",\r\n            \"name\": \"Operating system (OS) baseline validation failure\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_EdgeHubMemOptimize\",\r\n            \"name\": \"IoT Edge Hub memory can be optimized\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_EdgeLoggingOptions\",\r\n            \"name\": \"No logging configured for IoT Edge module\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_InconsistentModuleSettings\",\r\n            \"name\": \"SecurityGroup has inconsistent module settings\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_InstallAgent\",\r\n            \"name\": \"Install the Azure IoT Security agent\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_IPFilter_DenyAll\",\r\n            \"name\": \"Default IP filter policy should be deny\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_IPFilter_PermissiveRule\",\r\n            \"name\": \"IP filter rule includes a large IP range\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_OpenPorts\",\r\n            \"name\": \"Device has open ports\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveFirewallPolicy\",\r\n            \"name\": \"Permissive firewall policy in one of the chains\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveInputFirewallRules\",\r\n            \"name\": \"Permissive firewall rule in the input chain\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveOutputFirewallRules\",\r\n            \"name\": \"Permissive firewall rule in the output chain\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PrivilegedDockerOptions\",\r\n            \"name\": \"High level permissions configured in IoT Edge model twin for IoT Edge module\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_RecommendedIpRulesByBaseLine\",\r\n            \"name\": \"Recommended Rules for ip filter\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_SharedCredentials\",\r\n            \"name\": \"Same authentication credentials used by multiple devices\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_VulnerableTLSCipherSuite\",\r\n            \"name\": \"TLS cipher suite upgrade needed\",\r\n            \"status\": \"Enabled\"\r\n          }\r\n        ],\r\n        \"autoDiscoveredResources\": [],\r\n        \"unmaskedIpLoggingStatus\": \"Disabled\"\r\n      },\r\n      \"tags\": {}\r\n    },\r\n    {\r\n      \"id\": \"/subscriptions/075423e9-7d33-4166-8bdf-3920b04e3735/resourceGroups/michalresourcegroup/providers/Microsoft.Security/IoTSecuritySolutions/michalhubonb8\",\r\n      \"name\": \"michalhubonb8\",\r\n      \"type\": \"Microsoft.Security/IoTSecuritySolutions\",\r\n      \"location\": \"West US\",\r\n      \"properties\": {\r\n        \"displayName\": \"MichalHubOnB8\",\r\n        \"status\": \"Enabled\",\r\n        \"export\": [\r\n          \"RawEvents\"\r\n        ],\r\n        \"disabledDataSources\": [],\r\n        \"workspace\": null,\r\n        \"additionalWorkspaces\": null,\r\n        \"iotHubs\": [],\r\n        \"userDefinedResources\": {\r\n          \"query\": \"where type != \\\"microsoft.devices/iothubs\\\" | where (subscriptionId == \\\"075423e9-7d33-4166-8bdf-3920b04e3735\\\" and resourceGroup in~ (\\\"michalresourcegroup\\\")) | project id, name, type\",\r\n          \"querySubscriptions\": [\r\n            \"075423e9-7d33-4166-8bdf-3920b04e3735\"\r\n          ]\r\n        },\r\n        \"recommendationsConfiguration\": [\r\n          {\r\n            \"recommendationType\": \"IoT_ACRAuthentication\",\r\n            \"name\": \"Service prinicpal not used with ACR repository\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_AgentSendsUnutilizedMessages\",\r\n            \"name\": \"Agent sending underutilized messages\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_Baseline\",\r\n            \"name\": \"Operating system (OS) baseline validation failure\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_EdgeHubMemOptimize\",\r\n            \"name\": \"IoT Edge Hub memory can be optimized\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_EdgeLoggingOptions\",\r\n            \"name\": \"No logging configured for IoT Edge module\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_InconsistentModuleSettings\",\r\n            \"name\": \"SecurityGroup has inconsistent module settings\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_InstallAgent\",\r\n            \"name\": \"Install the Azure IoT Security agent\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_IPFilter_DenyAll\",\r\n            \"name\": \"Default IP filter policy should be deny\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_IPFilter_PermissiveRule\",\r\n            \"name\": \"IP filter rule includes a large IP range\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_OpenPorts\",\r\n            \"name\": \"Device has open ports\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveFirewallPolicy\",\r\n            \"name\": \"Permissive firewall policy in one of the chains\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveInputFirewallRules\",\r\n            \"name\": \"Permissive firewall rule in the input chain\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveOutputFirewallRules\",\r\n            \"name\": \"Permissive firewall rule in the output chain\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PrivilegedDockerOptions\",\r\n            \"name\": \"High level permissions configured in IoT Edge model twin for IoT Edge module\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_RecommendedIpRulesByBaseLine\",\r\n            \"name\": \"Recommended Rules for ip filter\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_SharedCredentials\",\r\n            \"name\": \"Same authentication credentials used by multiple devices\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_VulnerableTLSCipherSuite\",\r\n            \"name\": \"TLS cipher suite upgrade needed\",\r\n            \"status\": \"Enabled\"\r\n          }\r\n        ],\r\n        \"autoDiscoveredResources\": [],\r\n        \"unmaskedIpLoggingStatus\": \"Disabled\"\r\n      },\r\n      \"tags\": {}\r\n    },\r\n    {\r\n      \"id\": \"/subscriptions/075423e9-7d33-4166-8bdf-3920b04e3735/resourceGroups/michalresourcegroup/providers/Microsoft.Security/IoTSecuritySolutions/michalhubonb9\",\r\n      \"name\": \"michalhubonb9\",\r\n      \"type\": \"Microsoft.Security/IoTSecuritySolutions\",\r\n      \"location\": \"West US\",\r\n      \"properties\": {\r\n        \"displayName\": \"MichalHubOnB9\",\r\n        \"status\": \"Enabled\",\r\n        \"export\": [\r\n          \"RawEvents\"\r\n        ],\r\n        \"disabledDataSources\": [],\r\n        \"workspace\": null,\r\n        \"additionalWorkspaces\": null,\r\n        \"iotHubs\": [],\r\n        \"userDefinedResources\": {\r\n          \"query\": \"where type != \\\"microsoft.devices/iothubs\\\" | where (subscriptionId == \\\"075423e9-7d33-4166-8bdf-3920b04e3735\\\" and resourceGroup in~ (\\\"michalresourcegroup\\\")) | project id, name, type\",\r\n          \"querySubscriptions\": [\r\n            \"075423e9-7d33-4166-8bdf-3920b04e3735\"\r\n          ]\r\n        },\r\n        \"recommendationsConfiguration\": [\r\n          {\r\n            \"recommendationType\": \"IoT_ACRAuthentication\",\r\n            \"name\": \"Service prinicpal not used with ACR repository\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_AgentSendsUnutilizedMessages\",\r\n            \"name\": \"Agent sending underutilized messages\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_Baseline\",\r\n            \"name\": \"Operating system (OS) baseline validation failure\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_EdgeHubMemOptimize\",\r\n            \"name\": \"IoT Edge Hub memory can be optimized\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_EdgeLoggingOptions\",\r\n            \"name\": \"No logging configured for IoT Edge module\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_InconsistentModuleSettings\",\r\n            \"name\": \"SecurityGroup has inconsistent module settings\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_InstallAgent\",\r\n            \"name\": \"Install the Azure IoT Security agent\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_IPFilter_DenyAll\",\r\n            \"name\": \"Default IP filter policy should be deny\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_IPFilter_PermissiveRule\",\r\n            \"name\": \"IP filter rule includes a large IP range\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_OpenPorts\",\r\n            \"name\": \"Device has open ports\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveFirewallPolicy\",\r\n            \"name\": \"Permissive firewall policy in one of the chains\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveInputFirewallRules\",\r\n            \"name\": \"Permissive firewall rule in the input chain\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveOutputFirewallRules\",\r\n            \"name\": \"Permissive firewall rule in the output chain\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PrivilegedDockerOptions\",\r\n            \"name\": \"High level permissions configured in IoT Edge model twin for IoT Edge module\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_RecommendedIpRulesByBaseLine\",\r\n            \"name\": \"Recommended Rules for ip filter\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_SharedCredentials\",\r\n            \"name\": \"Same authentication credentials used by multiple devices\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_VulnerableTLSCipherSuite\",\r\n            \"name\": \"TLS cipher suite upgrade needed\",\r\n            \"status\": \"Enabled\"\r\n          }\r\n        ],\r\n        \"autoDiscoveredResources\": [],\r\n        \"unmaskedIpLoggingStatus\": \"Disabled\"\r\n      },\r\n      \"tags\": {}\r\n    },\r\n    {\r\n      \"id\": \"/subscriptions/075423e9-7d33-4166-8bdf-3920b04e3735/resourceGroups/michalresourcegroup/providers/Microsoft.Security/IoTSecuritySolutions/michalhubonb10\",\r\n      \"name\": \"michalhubonb10\",\r\n      \"type\": \"Microsoft.Security/IoTSecuritySolutions\",\r\n      \"location\": \"West US\",\r\n      \"properties\": {\r\n        \"displayName\": \"MichalHubOnB10\",\r\n        \"status\": \"Enabled\",\r\n        \"export\": [\r\n          \"RawEvents\"\r\n        ],\r\n        \"disabledDataSources\": [],\r\n        \"workspace\": null,\r\n        \"additionalWorkspaces\": null,\r\n        \"iotHubs\": [],\r\n        \"userDefinedResources\": {\r\n          \"query\": \"where type != \\\"microsoft.devices/iothubs\\\" | where (subscriptionId == \\\"075423e9-7d33-4166-8bdf-3920b04e3735\\\" and resourceGroup in~ (\\\"michalresourcegroup\\\")) | project id, name, type\",\r\n          \"querySubscriptions\": [\r\n            \"075423e9-7d33-4166-8bdf-3920b04e3735\"\r\n          ]\r\n        },\r\n        \"recommendationsConfiguration\": [\r\n          {\r\n            \"recommendationType\": \"IoT_ACRAuthentication\",\r\n            \"name\": \"Service prinicpal not used with ACR repository\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_AgentSendsUnutilizedMessages\",\r\n            \"name\": \"Agent sending underutilized messages\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_Baseline\",\r\n            \"name\": \"Operating system (OS) baseline validation failure\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_EdgeHubMemOptimize\",\r\n            \"name\": \"IoT Edge Hub memory can be optimized\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_EdgeLoggingOptions\",\r\n            \"name\": \"No logging configured for IoT Edge module\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_InconsistentModuleSettings\",\r\n            \"name\": \"SecurityGroup has inconsistent module settings\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_InstallAgent\",\r\n            \"name\": \"Install the Azure IoT Security agent\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_IPFilter_DenyAll\",\r\n            \"name\": \"Default IP filter policy should be deny\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_IPFilter_PermissiveRule\",\r\n            \"name\": \"IP filter rule includes a large IP range\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_OpenPorts\",\r\n            \"name\": \"Device has open ports\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveFirewallPolicy\",\r\n            \"name\": \"Permissive firewall policy in one of the chains\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveInputFirewallRules\",\r\n            \"name\": \"Permissive firewall rule in the input chain\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveOutputFirewallRules\",\r\n            \"name\": \"Permissive firewall rule in the output chain\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PrivilegedDockerOptions\",\r\n            \"name\": \"High level permissions configured in IoT Edge model twin for IoT Edge module\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_RecommendedIpRulesByBaseLine\",\r\n            \"name\": \"Recommended Rules for ip filter\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_SharedCredentials\",\r\n            \"name\": \"Same authentication credentials used by multiple devices\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_VulnerableTLSCipherSuite\",\r\n            \"name\": \"TLS cipher suite upgrade needed\",\r\n            \"status\": \"Enabled\"\r\n          }\r\n        ],\r\n        \"autoDiscoveredResources\": [],\r\n        \"unmaskedIpLoggingStatus\": \"Disabled\"\r\n      },\r\n      \"tags\": {}\r\n    },\r\n    {\r\n      \"id\": \"/subscriptions/075423e9-7d33-4166-8bdf-3920b04e3735/resourceGroups/michalresourcegroup/providers/Microsoft.Security/IoTSecuritySolutions/michalhubonb11\",\r\n      \"name\": \"michalhubonb11\",\r\n      \"type\": \"Microsoft.Security/IoTSecuritySolutions\",\r\n      \"location\": \"West US\",\r\n      \"properties\": {\r\n        \"displayName\": \"MichalHubOnB11\",\r\n        \"status\": \"Enabled\",\r\n        \"export\": [\r\n          \"RawEvents\"\r\n        ],\r\n        \"disabledDataSources\": [],\r\n        \"workspace\": null,\r\n        \"additionalWorkspaces\": null,\r\n        \"iotHubs\": [],\r\n        \"userDefinedResources\": {\r\n          \"query\": \"where type != \\\"microsoft.devices/iothubs\\\" | where (subscriptionId == \\\"075423e9-7d33-4166-8bdf-3920b04e3735\\\" and resourceGroup in~ (\\\"michalresourcegroup\\\")) | project id, name, type\",\r\n          \"querySubscriptions\": [\r\n            \"075423e9-7d33-4166-8bdf-3920b04e3735\"\r\n          ]\r\n        },\r\n        \"recommendationsConfiguration\": [\r\n          {\r\n            \"recommendationType\": \"IoT_ACRAuthentication\",\r\n            \"name\": \"Service prinicpal not used with ACR repository\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_AgentSendsUnutilizedMessages\",\r\n            \"name\": \"Agent sending underutilized messages\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_Baseline\",\r\n            \"name\": \"Operating system (OS) baseline validation failure\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_EdgeHubMemOptimize\",\r\n            \"name\": \"IoT Edge Hub memory can be optimized\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_EdgeLoggingOptions\",\r\n            \"name\": \"No logging configured for IoT Edge module\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_InconsistentModuleSettings\",\r\n            \"name\": \"SecurityGroup has inconsistent module settings\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_InstallAgent\",\r\n            \"name\": \"Install the Azure IoT Security agent\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_IPFilter_DenyAll\",\r\n            \"name\": \"Default IP filter policy should be deny\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_IPFilter_PermissiveRule\",\r\n            \"name\": \"IP filter rule includes a large IP range\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_OpenPorts\",\r\n            \"name\": \"Device has open ports\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveFirewallPolicy\",\r\n            \"name\": \"Permissive firewall policy in one of the chains\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveInputFirewallRules\",\r\n            \"name\": \"Permissive firewall rule in the input chain\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveOutputFirewallRules\",\r\n            \"name\": \"Permissive firewall rule in the output chain\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PrivilegedDockerOptions\",\r\n            \"name\": \"High level permissions configured in IoT Edge model twin for IoT Edge module\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_RecommendedIpRulesByBaseLine\",\r\n            \"name\": \"Recommended Rules for ip filter\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_SharedCredentials\",\r\n            \"name\": \"Same authentication credentials used by multiple devices\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_VulnerableTLSCipherSuite\",\r\n            \"name\": \"TLS cipher suite upgrade needed\",\r\n            \"status\": \"Enabled\"\r\n          }\r\n        ],\r\n        \"autoDiscoveredResources\": [],\r\n        \"unmaskedIpLoggingStatus\": \"Disabled\"\r\n      },\r\n      \"tags\": {}\r\n    },\r\n    {\r\n      \"id\": \"/subscriptions/075423e9-7d33-4166-8bdf-3920b04e3735/resourceGroups/michalresourcegroup/providers/Microsoft.Security/IoTSecuritySolutions/michalhubonb12\",\r\n      \"name\": \"michalhubonb12\",\r\n      \"type\": \"Microsoft.Security/IoTSecuritySolutions\",\r\n      \"location\": \"West US\",\r\n      \"properties\": {\r\n        \"displayName\": \"MichalHubOnB12\",\r\n        \"status\": \"Enabled\",\r\n        \"export\": [\r\n          \"RawEvents\"\r\n        ],\r\n        \"disabledDataSources\": [],\r\n        \"workspace\": null,\r\n        \"additionalWorkspaces\": null,\r\n        \"iotHubs\": [],\r\n        \"userDefinedResources\": {\r\n          \"query\": \"where type != \\\"microsoft.devices/iothubs\\\" | where (subscriptionId == \\\"075423e9-7d33-4166-8bdf-3920b04e3735\\\" and resourceGroup in~ (\\\"michalresourcegroup\\\")) | project id, name, type\",\r\n          \"querySubscriptions\": [\r\n            \"075423e9-7d33-4166-8bdf-3920b04e3735\"\r\n          ]\r\n        },\r\n        \"recommendationsConfiguration\": [\r\n          {\r\n            \"recommendationType\": \"IoT_ACRAuthentication\",\r\n            \"name\": \"Service prinicpal not used with ACR repository\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_AgentSendsUnutilizedMessages\",\r\n            \"name\": \"Agent sending underutilized messages\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_Baseline\",\r\n            \"name\": \"Operating system (OS) baseline validation failure\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_EdgeHubMemOptimize\",\r\n            \"name\": \"IoT Edge Hub memory can be optimized\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_EdgeLoggingOptions\",\r\n            \"name\": \"No logging configured for IoT Edge module\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_InconsistentModuleSettings\",\r\n            \"name\": \"SecurityGroup has inconsistent module settings\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_InstallAgent\",\r\n            \"name\": \"Install the Azure IoT Security agent\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_IPFilter_DenyAll\",\r\n            \"name\": \"Default IP filter policy should be deny\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_IPFilter_PermissiveRule\",\r\n            \"name\": \"IP filter rule includes a large IP range\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_OpenPorts\",\r\n            \"name\": \"Device has open ports\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveFirewallPolicy\",\r\n            \"name\": \"Permissive firewall policy in one of the chains\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveInputFirewallRules\",\r\n            \"name\": \"Permissive firewall rule in the input chain\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveOutputFirewallRules\",\r\n            \"name\": \"Permissive firewall rule in the output chain\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PrivilegedDockerOptions\",\r\n            \"name\": \"High level permissions configured in IoT Edge model twin for IoT Edge module\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_RecommendedIpRulesByBaseLine\",\r\n            \"name\": \"Recommended Rules for ip filter\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_SharedCredentials\",\r\n            \"name\": \"Same authentication credentials used by multiple devices\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_VulnerableTLSCipherSuite\",\r\n            \"name\": \"TLS cipher suite upgrade needed\",\r\n            \"status\": \"Enabled\"\r\n          }\r\n        ],\r\n        \"autoDiscoveredResources\": [],\r\n        \"unmaskedIpLoggingStatus\": \"Disabled\"\r\n      },\r\n      \"tags\": {}\r\n    },\r\n    {\r\n      \"id\": \"/subscriptions/075423e9-7d33-4166-8bdf-3920b04e3735/resourceGroups/michalresourcegroup/providers/Microsoft.Security/IoTSecuritySolutions/michalhubonb13\",\r\n      \"name\": \"michalhubonb13\",\r\n      \"type\": \"Microsoft.Security/IoTSecuritySolutions\",\r\n      \"location\": \"West US\",\r\n      \"properties\": {\r\n        \"displayName\": \"MichalHubOnB13\",\r\n        \"status\": \"Enabled\",\r\n        \"export\": [\r\n          \"RawEvents\"\r\n        ],\r\n        \"disabledDataSources\": [],\r\n        \"workspace\": null,\r\n        \"additionalWorkspaces\": null,\r\n        \"iotHubs\": [],\r\n        \"userDefinedResources\": {\r\n          \"query\": \"where type != \\\"microsoft.devices/iothubs\\\" | where (subscriptionId == \\\"075423e9-7d33-4166-8bdf-3920b04e3735\\\" and resourceGroup in~ (\\\"michalresourcegroup\\\")) | project id, name, type\",\r\n          \"querySubscriptions\": [\r\n            \"075423e9-7d33-4166-8bdf-3920b04e3735\"\r\n          ]\r\n        },\r\n        \"recommendationsConfiguration\": [\r\n          {\r\n            \"recommendationType\": \"IoT_ACRAuthentication\",\r\n            \"name\": \"Service prinicpal not used with ACR repository\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_AgentSendsUnutilizedMessages\",\r\n            \"name\": \"Agent sending underutilized messages\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_Baseline\",\r\n            \"name\": \"Operating system (OS) baseline validation failure\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_EdgeHubMemOptimize\",\r\n            \"name\": \"IoT Edge Hub memory can be optimized\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_EdgeLoggingOptions\",\r\n            \"name\": \"No logging configured for IoT Edge module\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_InconsistentModuleSettings\",\r\n            \"name\": \"SecurityGroup has inconsistent module settings\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_InstallAgent\",\r\n            \"name\": \"Install the Azure IoT Security agent\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_IPFilter_DenyAll\",\r\n            \"name\": \"Default IP filter policy should be deny\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_IPFilter_PermissiveRule\",\r\n            \"name\": \"IP filter rule includes a large IP range\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_OpenPorts\",\r\n            \"name\": \"Device has open ports\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveFirewallPolicy\",\r\n            \"name\": \"Permissive firewall policy in one of the chains\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveInputFirewallRules\",\r\n            \"name\": \"Permissive firewall rule in the input chain\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveOutputFirewallRules\",\r\n            \"name\": \"Permissive firewall rule in the output chain\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PrivilegedDockerOptions\",\r\n            \"name\": \"High level permissions configured in IoT Edge model twin for IoT Edge module\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_RecommendedIpRulesByBaseLine\",\r\n            \"name\": \"Recommended Rules for ip filter\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_SharedCredentials\",\r\n            \"name\": \"Same authentication credentials used by multiple devices\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_VulnerableTLSCipherSuite\",\r\n            \"name\": \"TLS cipher suite upgrade needed\",\r\n            \"status\": \"Enabled\"\r\n          }\r\n        ],\r\n        \"autoDiscoveredResources\": [],\r\n        \"unmaskedIpLoggingStatus\": \"Disabled\"\r\n      },\r\n      \"tags\": {}\r\n    },\r\n    {\r\n      \"id\": \"/subscriptions/075423e9-7d33-4166-8bdf-3920b04e3735/resourceGroups/michalresourcegroup/providers/Microsoft.Security/IoTSecuritySolutions/michalhubonb14\",\r\n      \"name\": \"michalhubonb14\",\r\n      \"type\": \"Microsoft.Security/IoTSecuritySolutions\",\r\n      \"location\": \"West US\",\r\n      \"properties\": {\r\n        \"displayName\": \"MichalHubOnB14\",\r\n        \"status\": \"Enabled\",\r\n        \"export\": [\r\n          \"RawEvents\"\r\n        ],\r\n        \"disabledDataSources\": [],\r\n        \"workspace\": null,\r\n        \"additionalWorkspaces\": null,\r\n        \"iotHubs\": [],\r\n        \"userDefinedResources\": {\r\n          \"query\": \"where type != \\\"microsoft.devices/iothubs\\\" | where (subscriptionId == \\\"075423e9-7d33-4166-8bdf-3920b04e3735\\\" and resourceGroup in~ (\\\"michalresourcegroup\\\")) | project id, name, type\",\r\n          \"querySubscriptions\": [\r\n            \"075423e9-7d33-4166-8bdf-3920b04e3735\"\r\n          ]\r\n        },\r\n        \"recommendationsConfiguration\": [\r\n          {\r\n            \"recommendationType\": \"IoT_ACRAuthentication\",\r\n            \"name\": \"Service prinicpal not used with ACR repository\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_AgentSendsUnutilizedMessages\",\r\n            \"name\": \"Agent sending underutilized messages\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_Baseline\",\r\n            \"name\": \"Operating system (OS) baseline validation failure\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_EdgeHubMemOptimize\",\r\n            \"name\": \"IoT Edge Hub memory can be optimized\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_EdgeLoggingOptions\",\r\n            \"name\": \"No logging configured for IoT Edge module\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_InconsistentModuleSettings\",\r\n            \"name\": \"SecurityGroup has inconsistent module settings\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_InstallAgent\",\r\n            \"name\": \"Install the Azure IoT Security agent\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_IPFilter_DenyAll\",\r\n            \"name\": \"Default IP filter policy should be deny\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_IPFilter_PermissiveRule\",\r\n            \"name\": \"IP filter rule includes a large IP range\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_OpenPorts\",\r\n            \"name\": \"Device has open ports\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveFirewallPolicy\",\r\n            \"name\": \"Permissive firewall policy in one of the chains\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveInputFirewallRules\",\r\n            \"name\": \"Permissive firewall rule in the input chain\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveOutputFirewallRules\",\r\n            \"name\": \"Permissive firewall rule in the output chain\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PrivilegedDockerOptions\",\r\n            \"name\": \"High level permissions configured in IoT Edge model twin for IoT Edge module\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_RecommendedIpRulesByBaseLine\",\r\n            \"name\": \"Recommended Rules for ip filter\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_SharedCredentials\",\r\n            \"name\": \"Same authentication credentials used by multiple devices\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_VulnerableTLSCipherSuite\",\r\n            \"name\": \"TLS cipher suite upgrade needed\",\r\n            \"status\": \"Enabled\"\r\n          }\r\n        ],\r\n        \"autoDiscoveredResources\": [],\r\n        \"unmaskedIpLoggingStatus\": \"Disabled\"\r\n      },\r\n      \"tags\": {}\r\n    },\r\n    {\r\n      \"id\": \"/subscriptions/075423e9-7d33-4166-8bdf-3920b04e3735/resourceGroups/michalresourcegroup/providers/Microsoft.Security/IoTSecuritySolutions/michalhubonb15\",\r\n      \"name\": \"michalhubonb15\",\r\n      \"type\": \"Microsoft.Security/IoTSecuritySolutions\",\r\n      \"location\": \"West US\",\r\n      \"properties\": {\r\n        \"displayName\": \"MichalHubOnB15\",\r\n        \"status\": \"Enabled\",\r\n        \"export\": [\r\n          \"RawEvents\"\r\n        ],\r\n        \"disabledDataSources\": [],\r\n        \"workspace\": null,\r\n        \"additionalWorkspaces\": null,\r\n        \"iotHubs\": [],\r\n        \"userDefinedResources\": {\r\n          \"query\": \"where type != \\\"microsoft.devices/iothubs\\\" | where (subscriptionId == \\\"075423e9-7d33-4166-8bdf-3920b04e3735\\\" and resourceGroup in~ (\\\"michalresourcegroup\\\")) | project id, name, type\",\r\n          \"querySubscriptions\": [\r\n            \"075423e9-7d33-4166-8bdf-3920b04e3735\"\r\n          ]\r\n        },\r\n        \"recommendationsConfiguration\": [\r\n          {\r\n            \"recommendationType\": \"IoT_ACRAuthentication\",\r\n            \"name\": \"Service prinicpal not used with ACR repository\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_AgentSendsUnutilizedMessages\",\r\n            \"name\": \"Agent sending underutilized messages\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_Baseline\",\r\n            \"name\": \"Operating system (OS) baseline validation failure\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_EdgeHubMemOptimize\",\r\n            \"name\": \"IoT Edge Hub memory can be optimized\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_EdgeLoggingOptions\",\r\n            \"name\": \"No logging configured for IoT Edge module\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_InconsistentModuleSettings\",\r\n            \"name\": \"SecurityGroup has inconsistent module settings\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_InstallAgent\",\r\n            \"name\": \"Install the Azure IoT Security agent\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_IPFilter_DenyAll\",\r\n            \"name\": \"Default IP filter policy should be deny\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_IPFilter_PermissiveRule\",\r\n            \"name\": \"IP filter rule includes a large IP range\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_OpenPorts\",\r\n            \"name\": \"Device has open ports\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveFirewallPolicy\",\r\n            \"name\": \"Permissive firewall policy in one of the chains\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveInputFirewallRules\",\r\n            \"name\": \"Permissive firewall rule in the input chain\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveOutputFirewallRules\",\r\n            \"name\": \"Permissive firewall rule in the output chain\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PrivilegedDockerOptions\",\r\n            \"name\": \"High level permissions configured in IoT Edge model twin for IoT Edge module\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_RecommendedIpRulesByBaseLine\",\r\n            \"name\": \"Recommended Rules for ip filter\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_SharedCredentials\",\r\n            \"name\": \"Same authentication credentials used by multiple devices\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_VulnerableTLSCipherSuite\",\r\n            \"name\": \"TLS cipher suite upgrade needed\",\r\n            \"status\": \"Enabled\"\r\n          }\r\n        ],\r\n        \"autoDiscoveredResources\": [],\r\n        \"unmaskedIpLoggingStatus\": \"Disabled\"\r\n      },\r\n      \"tags\": {}\r\n    },\r\n    {\r\n      \"id\": \"/subscriptions/075423e9-7d33-4166-8bdf-3920b04e3735/resourceGroups/michalresourcegroup/providers/Microsoft.Security/IoTSecuritySolutions/michalhubonb16\",\r\n      \"name\": \"michalhubonb16\",\r\n      \"type\": \"Microsoft.Security/IoTSecuritySolutions\",\r\n      \"location\": \"West US\",\r\n      \"properties\": {\r\n        \"displayName\": \"MichalHubOnB16\",\r\n        \"status\": \"Enabled\",\r\n        \"export\": [\r\n          \"RawEvents\"\r\n        ],\r\n        \"disabledDataSources\": [],\r\n        \"workspace\": null,\r\n        \"additionalWorkspaces\": null,\r\n        \"iotHubs\": [],\r\n        \"userDefinedResources\": {\r\n          \"query\": \"where type != \\\"microsoft.devices/iothubs\\\" | where (subscriptionId == \\\"075423e9-7d33-4166-8bdf-3920b04e3735\\\" and resourceGroup in~ (\\\"michalresourcegroup\\\")) | project id, name, type\",\r\n          \"querySubscriptions\": [\r\n            \"075423e9-7d33-4166-8bdf-3920b04e3735\"\r\n          ]\r\n        },\r\n        \"recommendationsConfiguration\": [\r\n          {\r\n            \"recommendationType\": \"IoT_ACRAuthentication\",\r\n            \"name\": \"Service prinicpal not used with ACR repository\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_AgentSendsUnutilizedMessages\",\r\n            \"name\": \"Agent sending underutilized messages\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_Baseline\",\r\n            \"name\": \"Operating system (OS) baseline validation failure\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_EdgeHubMemOptimize\",\r\n            \"name\": \"IoT Edge Hub memory can be optimized\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_EdgeLoggingOptions\",\r\n            \"name\": \"No logging configured for IoT Edge module\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_InconsistentModuleSettings\",\r\n            \"name\": \"SecurityGroup has inconsistent module settings\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_InstallAgent\",\r\n            \"name\": \"Install the Azure IoT Security agent\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_IPFilter_DenyAll\",\r\n            \"name\": \"Default IP filter policy should be deny\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_IPFilter_PermissiveRule\",\r\n            \"name\": \"IP filter rule includes a large IP range\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_OpenPorts\",\r\n            \"name\": \"Device has open ports\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveFirewallPolicy\",\r\n            \"name\": \"Permissive firewall policy in one of the chains\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveInputFirewallRules\",\r\n            \"name\": \"Permissive firewall rule in the input chain\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveOutputFirewallRules\",\r\n            \"name\": \"Permissive firewall rule in the output chain\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PrivilegedDockerOptions\",\r\n            \"name\": \"High level permissions configured in IoT Edge model twin for IoT Edge module\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_RecommendedIpRulesByBaseLine\",\r\n            \"name\": \"Recommended Rules for ip filter\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_SharedCredentials\",\r\n            \"name\": \"Same authentication credentials used by multiple devices\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_VulnerableTLSCipherSuite\",\r\n            \"name\": \"TLS cipher suite upgrade needed\",\r\n            \"status\": \"Enabled\"\r\n          }\r\n        ],\r\n        \"autoDiscoveredResources\": [],\r\n        \"unmaskedIpLoggingStatus\": \"Disabled\"\r\n      },\r\n      \"tags\": {}\r\n    },\r\n    {\r\n      \"id\": \"/subscriptions/075423e9-7d33-4166-8bdf-3920b04e3735/resourceGroups/michalresourcegroup/providers/Microsoft.Security/IoTSecuritySolutions/michalhubonb17\",\r\n      \"name\": \"michalhubonb17\",\r\n      \"type\": \"Microsoft.Security/IoTSecuritySolutions\",\r\n      \"location\": \"West US\",\r\n      \"properties\": {\r\n        \"displayName\": \"MichalHubOnB17\",\r\n        \"status\": \"Enabled\",\r\n        \"export\": [\r\n          \"RawEvents\"\r\n        ],\r\n        \"disabledDataSources\": [],\r\n        \"workspace\": null,\r\n        \"additionalWorkspaces\": null,\r\n        \"iotHubs\": [],\r\n        \"userDefinedResources\": {\r\n          \"query\": \"where type != \\\"microsoft.devices/iothubs\\\" | where (subscriptionId == \\\"075423e9-7d33-4166-8bdf-3920b04e3735\\\" and resourceGroup in~ (\\\"michalresourcegroup\\\")) | project id, name, type\",\r\n          \"querySubscriptions\": [\r\n            \"075423e9-7d33-4166-8bdf-3920b04e3735\"\r\n          ]\r\n        },\r\n        \"recommendationsConfiguration\": [\r\n          {\r\n            \"recommendationType\": \"IoT_ACRAuthentication\",\r\n            \"name\": \"Service prinicpal not used with ACR repository\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_AgentSendsUnutilizedMessages\",\r\n            \"name\": \"Agent sending underutilized messages\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_Baseline\",\r\n            \"name\": \"Operating system (OS) baseline validation failure\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_EdgeHubMemOptimize\",\r\n            \"name\": \"IoT Edge Hub memory can be optimized\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_EdgeLoggingOptions\",\r\n            \"name\": \"No logging configured for IoT Edge module\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_InconsistentModuleSettings\",\r\n            \"name\": \"SecurityGroup has inconsistent module settings\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_InstallAgent\",\r\n            \"name\": \"Install the Azure IoT Security agent\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_IPFilter_DenyAll\",\r\n            \"name\": \"Default IP filter policy should be deny\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_IPFilter_PermissiveRule\",\r\n            \"name\": \"IP filter rule includes a large IP range\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_OpenPorts\",\r\n            \"name\": \"Device has open ports\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveFirewallPolicy\",\r\n            \"name\": \"Permissive firewall policy in one of the chains\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveInputFirewallRules\",\r\n            \"name\": \"Permissive firewall rule in the input chain\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveOutputFirewallRules\",\r\n            \"name\": \"Permissive firewall rule in the output chain\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PrivilegedDockerOptions\",\r\n            \"name\": \"High level permissions configured in IoT Edge model twin for IoT Edge module\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_RecommendedIpRulesByBaseLine\",\r\n            \"name\": \"Recommended Rules for ip filter\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_SharedCredentials\",\r\n            \"name\": \"Same authentication credentials used by multiple devices\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_VulnerableTLSCipherSuite\",\r\n            \"name\": \"TLS cipher suite upgrade needed\",\r\n            \"status\": \"Enabled\"\r\n          }\r\n        ],\r\n        \"autoDiscoveredResources\": [],\r\n        \"unmaskedIpLoggingStatus\": \"Disabled\"\r\n      },\r\n      \"tags\": {}\r\n    },\r\n    {\r\n      \"id\": \"/subscriptions/075423e9-7d33-4166-8bdf-3920b04e3735/resourceGroups/michalresourcegroup/providers/Microsoft.Security/IoTSecuritySolutions/michalhubonb18\",\r\n      \"name\": \"michalhubonb18\",\r\n      \"type\": \"Microsoft.Security/IoTSecuritySolutions\",\r\n      \"location\": \"West US\",\r\n      \"properties\": {\r\n        \"displayName\": \"MichalHubOnB18\",\r\n        \"status\": \"Enabled\",\r\n        \"export\": [\r\n          \"RawEvents\"\r\n        ],\r\n        \"disabledDataSources\": [],\r\n        \"workspace\": \"/subscriptions/075423e9-7d33-4166-8bdf-3920b04e3735/resourcegroups/galm-iot-hub/providers/microsoft.operationalinsights/workspaces/075423e9-7d33-4166-8bdf-3920b04e3735-iothubworkspace10\",\r\n        \"additionalWorkspaces\": null,\r\n        \"iotHubs\": [],\r\n        \"userDefinedResources\": {\r\n          \"query\": \"where type != \\\"microsoft.devices/iothubs\\\" | where (subscriptionId == \\\"075423e9-7d33-4166-8bdf-3920b04e3735\\\" and resourceGroup in~ (\\\"MichalResourceGroup\\\")) | project id, name, type\",\r\n          \"querySubscriptions\": [\r\n            \"075423e9-7d33-4166-8bdf-3920b04e3735\"\r\n          ]\r\n        },\r\n        \"recommendationsConfiguration\": [\r\n          {\r\n            \"recommendationType\": \"IoT_ACRAuthentication\",\r\n            \"name\": \"Service prinicpal not used with ACR repository\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_AgentSendsUnutilizedMessages\",\r\n            \"name\": \"Agent sending underutilized messages\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_Baseline\",\r\n            \"name\": \"Operating system (OS) baseline validation failure\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_EdgeHubMemOptimize\",\r\n            \"name\": \"IoT Edge Hub memory can be optimized\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_EdgeLoggingOptions\",\r\n            \"name\": \"No logging configured for IoT Edge module\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_InconsistentModuleSettings\",\r\n            \"name\": \"SecurityGroup has inconsistent module settings\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_InstallAgent\",\r\n            \"name\": \"Install the Azure IoT Security agent\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_IPFilter_DenyAll\",\r\n            \"name\": \"Default IP filter policy should be deny\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_IPFilter_PermissiveRule\",\r\n            \"name\": \"IP filter rule includes a large IP range\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_OpenPorts\",\r\n            \"name\": \"Device has open ports\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveFirewallPolicy\",\r\n            \"name\": \"Permissive firewall policy in one of the chains\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveInputFirewallRules\",\r\n            \"name\": \"Permissive firewall rule in the input chain\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveOutputFirewallRules\",\r\n            \"name\": \"Permissive firewall rule in the output chain\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PrivilegedDockerOptions\",\r\n            \"name\": \"High level permissions configured in IoT Edge model twin for IoT Edge module\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_RecommendedIpRulesByBaseLine\",\r\n            \"name\": \"Recommended Rules for ip filter\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_SharedCredentials\",\r\n            \"name\": \"Same authentication credentials used by multiple devices\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_VulnerableTLSCipherSuite\",\r\n            \"name\": \"TLS cipher suite upgrade needed\",\r\n            \"status\": \"Enabled\"\r\n          }\r\n        ],\r\n        \"autoDiscoveredResources\": [],\r\n        \"unmaskedIpLoggingStatus\": \"Disabled\"\r\n      },\r\n      \"tags\": {}\r\n    },\r\n    {\r\n      \"id\": \"/subscriptions/075423e9-7d33-4166-8bdf-3920b04e3735/resourceGroups/michalresourcegroup/providers/Microsoft.Security/IoTSecuritySolutions/michalhubtest6\",\r\n      \"name\": \"michalhubtest6\",\r\n      \"type\": \"Microsoft.Security/IoTSecuritySolutions\",\r\n      \"location\": \"West US\",\r\n      \"properties\": {\r\n        \"displayName\": \"MichalHubTest6\",\r\n        \"status\": \"Enabled\",\r\n        \"export\": [\r\n          \"RawEvents\"\r\n        ],\r\n        \"disabledDataSources\": [],\r\n        \"workspace\": \"/subscriptions/075423e9-7d33-4166-8bdf-3920b04e3735/resourcegroups/michalresourcegroup/providers/microsoft.operationalinsights/workspaces/iothubworkspace-westus-1570457741214\",\r\n        \"additionalWorkspaces\": null,\r\n        \"iotHubs\": [],\r\n        \"userDefinedResources\": {\r\n          \"query\": null,\r\n          \"querySubscriptions\": null\r\n        },\r\n        \"recommendationsConfiguration\": [\r\n          {\r\n            \"recommendationType\": \"IoT_ACRAuthentication\",\r\n            \"name\": \"Service prinicpal not used with ACR repository\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_AgentSendsUnutilizedMessages\",\r\n            \"name\": \"Agent sending underutilized messages\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_Baseline\",\r\n            \"name\": \"Operating system (OS) baseline validation failure\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_EdgeHubMemOptimize\",\r\n            \"name\": \"IoT Edge Hub memory can be optimized\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_EdgeLoggingOptions\",\r\n            \"name\": \"No logging configured for IoT Edge module\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_InconsistentModuleSettings\",\r\n            \"name\": \"SecurityGroup has inconsistent module settings\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_InstallAgent\",\r\n            \"name\": \"Install the Azure IoT Security agent\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_IPFilter_DenyAll\",\r\n            \"name\": \"Default IP filter policy should be deny\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_IPFilter_PermissiveRule\",\r\n            \"name\": \"IP filter rule includes a large IP range\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_OpenPorts\",\r\n            \"name\": \"Device has open ports\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveFirewallPolicy\",\r\n            \"name\": \"Permissive firewall policy in one of the chains\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveInputFirewallRules\",\r\n            \"name\": \"Permissive firewall rule in the input chain\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveOutputFirewallRules\",\r\n            \"name\": \"Permissive firewall rule in the output chain\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PrivilegedDockerOptions\",\r\n            \"name\": \"High level permissions configured in IoT Edge model twin for IoT Edge module\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_RecommendedIpRulesByBaseLine\",\r\n            \"name\": \"Recommended Rules for ip filter\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_SharedCredentials\",\r\n            \"name\": \"Same authentication credentials used by multiple devices\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_VulnerableTLSCipherSuite\",\r\n            \"name\": \"TLS cipher suite upgrade needed\",\r\n            \"status\": \"Enabled\"\r\n          }\r\n        ],\r\n        \"autoDiscoveredResources\": [],\r\n        \"unmaskedIpLoggingStatus\": \"Disabled\"\r\n      },\r\n      \"tags\": {}\r\n    },\r\n    {\r\n      \"id\": \"/subscriptions/075423e9-7d33-4166-8bdf-3920b04e3735/resourceGroups/michalresourcegroup/providers/Microsoft.Security/IoTSecuritySolutions/michalhubtest5\",\r\n      \"name\": \"michalhubtest5\",\r\n      \"type\": \"Microsoft.Security/IoTSecuritySolutions\",\r\n      \"location\": \"West US\",\r\n      \"properties\": {\r\n        \"displayName\": \"MichalHubTest5\",\r\n        \"status\": \"Enabled\",\r\n        \"export\": [\r\n          \"RawEvents\"\r\n        ],\r\n        \"disabledDataSources\": [],\r\n        \"workspace\": \"/subscriptions/075423e9-7d33-4166-8bdf-3920b04e3735/resourcegroups/michalresourcegroup/providers/microsoft.operationalinsights/workspaces/iothubworkspace-westus-1570457741214\",\r\n        \"additionalWorkspaces\": null,\r\n        \"iotHubs\": [],\r\n        \"userDefinedResources\": {\r\n          \"query\": null,\r\n          \"querySubscriptions\": null\r\n        },\r\n        \"recommendationsConfiguration\": [\r\n          {\r\n            \"recommendationType\": \"IoT_ACRAuthentication\",\r\n            \"name\": \"Service prinicpal not used with ACR repository\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_AgentSendsUnutilizedMessages\",\r\n            \"name\": \"Agent sending underutilized messages\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_Baseline\",\r\n            \"name\": \"Operating system (OS) baseline validation failure\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_EdgeHubMemOptimize\",\r\n            \"name\": \"IoT Edge Hub memory can be optimized\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_EdgeLoggingOptions\",\r\n            \"name\": \"No logging configured for IoT Edge module\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_InconsistentModuleSettings\",\r\n            \"name\": \"SecurityGroup has inconsistent module settings\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_InstallAgent\",\r\n            \"name\": \"Install the Azure IoT Security agent\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_IPFilter_DenyAll\",\r\n            \"name\": \"Default IP filter policy should be deny\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_IPFilter_PermissiveRule\",\r\n            \"name\": \"IP filter rule includes a large IP range\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_OpenPorts\",\r\n            \"name\": \"Device has open ports\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveFirewallPolicy\",\r\n            \"name\": \"Permissive firewall policy in one of the chains\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveInputFirewallRules\",\r\n            \"name\": \"Permissive firewall rule in the input chain\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveOutputFirewallRules\",\r\n            \"name\": \"Permissive firewall rule in the output chain\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PrivilegedDockerOptions\",\r\n            \"name\": \"High level permissions configured in IoT Edge model twin for IoT Edge module\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_RecommendedIpRulesByBaseLine\",\r\n            \"name\": \"Recommended Rules for ip filter\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_SharedCredentials\",\r\n            \"name\": \"Same authentication credentials used by multiple devices\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_VulnerableTLSCipherSuite\",\r\n            \"name\": \"TLS cipher suite upgrade needed\",\r\n            \"status\": \"Enabled\"\r\n          }\r\n        ],\r\n        \"autoDiscoveredResources\": [],\r\n        \"unmaskedIpLoggingStatus\": \"Disabled\"\r\n      },\r\n      \"tags\": {}\r\n    },\r\n    {\r\n      \"id\": \"/subscriptions/075423e9-7d33-4166-8bdf-3920b04e3735/resourceGroups/michalresourcegroup/providers/Microsoft.Security/IoTSecuritySolutions/michalhubtest9\",\r\n      \"name\": \"michalhubtest9\",\r\n      \"type\": \"Microsoft.Security/IoTSecuritySolutions\",\r\n      \"location\": \"North Central US\",\r\n      \"properties\": {\r\n        \"displayName\": \"MichalHubTest9\",\r\n        \"status\": \"Enabled\",\r\n        \"export\": [\r\n          \"RawEvents\"\r\n        ],\r\n        \"disabledDataSources\": [],\r\n        \"workspace\": \"/subscriptions/075423e9-7d33-4166-8bdf-3920b04e3735/resourcegroups/michalresourcegroup/providers/microsoft.operationalinsights/workspaces/iothubworkspace-northcentralus-1570482968529\",\r\n        \"additionalWorkspaces\": null,\r\n        \"iotHubs\": [],\r\n        \"userDefinedResources\": {\r\n          \"query\": \"where type != \\\"microsoft.devices/iothubs\\\" | where (subscriptionId == \\\"075423e9-7d33-4166-8bdf-3920b04e3735\\\" and resourceGroup in~ (\\\"michalresourcegroup\\\")) | project id, name, type\",\r\n          \"querySubscriptions\": [\r\n            \"075423e9-7d33-4166-8bdf-3920b04e3735\"\r\n          ]\r\n        },\r\n        \"recommendationsConfiguration\": [\r\n          {\r\n            \"recommendationType\": \"IoT_ACRAuthentication\",\r\n            \"name\": \"Service prinicpal not used with ACR repository\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_AgentSendsUnutilizedMessages\",\r\n            \"name\": \"Agent sending underutilized messages\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_Baseline\",\r\n            \"name\": \"Operating system (OS) baseline validation failure\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_EdgeHubMemOptimize\",\r\n            \"name\": \"IoT Edge Hub memory can be optimized\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_EdgeLoggingOptions\",\r\n            \"name\": \"No logging configured for IoT Edge module\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_InconsistentModuleSettings\",\r\n            \"name\": \"SecurityGroup has inconsistent module settings\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_InstallAgent\",\r\n            \"name\": \"Install the Azure IoT Security agent\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_IPFilter_DenyAll\",\r\n            \"name\": \"Default IP filter policy should be deny\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_IPFilter_PermissiveRule\",\r\n            \"name\": \"IP filter rule includes a large IP range\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_OpenPorts\",\r\n            \"name\": \"Device has open ports\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveFirewallPolicy\",\r\n            \"name\": \"Permissive firewall policy in one of the chains\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveInputFirewallRules\",\r\n            \"name\": \"Permissive firewall rule in the input chain\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveOutputFirewallRules\",\r\n            \"name\": \"Permissive firewall rule in the output chain\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PrivilegedDockerOptions\",\r\n            \"name\": \"High level permissions configured in IoT Edge model twin for IoT Edge module\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_RecommendedIpRulesByBaseLine\",\r\n            \"name\": \"Recommended Rules for ip filter\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_SharedCredentials\",\r\n            \"name\": \"Same authentication credentials used by multiple devices\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_VulnerableTLSCipherSuite\",\r\n            \"name\": \"TLS cipher suite upgrade needed\",\r\n            \"status\": \"Enabled\"\r\n          }\r\n        ],\r\n        \"autoDiscoveredResources\": [],\r\n        \"unmaskedIpLoggingStatus\": \"Disabled\"\r\n      },\r\n      \"tags\": {}\r\n    },\r\n    {\r\n      \"id\": \"/subscriptions/075423e9-7d33-4166-8bdf-3920b04e3735/resourceGroups/michalresourcegroup/providers/Microsoft.Security/IoTSecuritySolutions/michalhubtest8\",\r\n      \"name\": \"michalhubtest8\",\r\n      \"type\": \"Microsoft.Security/IoTSecuritySolutions\",\r\n      \"location\": \"North Central US\",\r\n      \"properties\": {\r\n        \"displayName\": \"MichalHubTest8\",\r\n        \"status\": \"Enabled\",\r\n        \"export\": [\r\n          \"RawEvents\"\r\n        ],\r\n        \"disabledDataSources\": [],\r\n        \"workspace\": \"/subscriptions/075423e9-7d33-4166-8bdf-3920b04e3735/resourcegroups/michalresourcegroup/providers/microsoft.operationalinsights/workspaces/iothubworkspace-northcentralus-1570482968531\",\r\n        \"additionalWorkspaces\": null,\r\n        \"iotHubs\": [],\r\n        \"userDefinedResources\": {\r\n          \"query\": \"where type != \\\"microsoft.devices/iothubs\\\" | where (subscriptionId == \\\"075423e9-7d33-4166-8bdf-3920b04e3735\\\" and resourceGroup in~ (\\\"michalresourcegroup\\\")) | project id, name, type\",\r\n          \"querySubscriptions\": [\r\n            \"075423e9-7d33-4166-8bdf-3920b04e3735\"\r\n          ]\r\n        },\r\n        \"recommendationsConfiguration\": [\r\n          {\r\n            \"recommendationType\": \"IoT_ACRAuthentication\",\r\n            \"name\": \"Service prinicpal not used with ACR repository\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_AgentSendsUnutilizedMessages\",\r\n            \"name\": \"Agent sending underutilized messages\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_Baseline\",\r\n            \"name\": \"Operating system (OS) baseline validation failure\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_EdgeHubMemOptimize\",\r\n            \"name\": \"IoT Edge Hub memory can be optimized\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_EdgeLoggingOptions\",\r\n            \"name\": \"No logging configured for IoT Edge module\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_InconsistentModuleSettings\",\r\n            \"name\": \"SecurityGroup has inconsistent module settings\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_InstallAgent\",\r\n            \"name\": \"Install the Azure IoT Security agent\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_IPFilter_DenyAll\",\r\n            \"name\": \"Default IP filter policy should be deny\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_IPFilter_PermissiveRule\",\r\n            \"name\": \"IP filter rule includes a large IP range\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_OpenPorts\",\r\n            \"name\": \"Device has open ports\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveFirewallPolicy\",\r\n            \"name\": \"Permissive firewall policy in one of the chains\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveInputFirewallRules\",\r\n            \"name\": \"Permissive firewall rule in the input chain\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveOutputFirewallRules\",\r\n            \"name\": \"Permissive firewall rule in the output chain\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PrivilegedDockerOptions\",\r\n            \"name\": \"High level permissions configured in IoT Edge model twin for IoT Edge module\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_RecommendedIpRulesByBaseLine\",\r\n            \"name\": \"Recommended Rules for ip filter\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_SharedCredentials\",\r\n            \"name\": \"Same authentication credentials used by multiple devices\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_VulnerableTLSCipherSuite\",\r\n            \"name\": \"TLS cipher suite upgrade needed\",\r\n            \"status\": \"Enabled\"\r\n          }\r\n        ],\r\n        \"autoDiscoveredResources\": [],\r\n        \"unmaskedIpLoggingStatus\": \"Disabled\"\r\n      },\r\n      \"tags\": {}\r\n    },\r\n    {\r\n      \"id\": \"/subscriptions/075423e9-7d33-4166-8bdf-3920b04e3735/resourceGroups/michalresourcegroup/providers/Microsoft.Security/IoTSecuritySolutions/michalhubtest10\",\r\n      \"name\": \"michalhubtest10\",\r\n      \"type\": \"Microsoft.Security/IoTSecuritySolutions\",\r\n      \"location\": \"canadacentral\",\r\n      \"properties\": {\r\n        \"displayName\": \"MichalHubTest10\",\r\n        \"status\": \"Enabled\",\r\n        \"export\": [\r\n          \"RawEvents\"\r\n        ],\r\n        \"disabledDataSources\": [],\r\n        \"workspace\": \"/subscriptions/075423e9-7d33-4166-8bdf-3920b04e3735/resourcegroups/michalresourcegroup/providers/microsoft.operationalinsights/workspaces/iothubworkspace-canadacentral-1570482968532\",\r\n        \"additionalWorkspaces\": null,\r\n        \"iotHubs\": [],\r\n        \"userDefinedResources\": {\r\n          \"query\": \"where type != \\\"microsoft.devices/iothubs\\\" | where (subscriptionId == \\\"075423e9-7d33-4166-8bdf-3920b04e3735\\\" and resourceGroup in~ (\\\"michalresourcegroup\\\")) | project id, name, type\",\r\n          \"querySubscriptions\": [\r\n            \"075423e9-7d33-4166-8bdf-3920b04e3735\"\r\n          ]\r\n        },\r\n        \"recommendationsConfiguration\": [\r\n          {\r\n            \"recommendationType\": \"IoT_ACRAuthentication\",\r\n            \"name\": \"Service prinicpal not used with ACR repository\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_AgentSendsUnutilizedMessages\",\r\n            \"name\": \"Agent sending underutilized messages\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_Baseline\",\r\n            \"name\": \"Operating system (OS) baseline validation failure\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_EdgeHubMemOptimize\",\r\n            \"name\": \"IoT Edge Hub memory can be optimized\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_EdgeLoggingOptions\",\r\n            \"name\": \"No logging configured for IoT Edge module\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_InconsistentModuleSettings\",\r\n            \"name\": \"SecurityGroup has inconsistent module settings\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_InstallAgent\",\r\n            \"name\": \"Install the Azure IoT Security agent\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_IPFilter_DenyAll\",\r\n            \"name\": \"Default IP filter policy should be deny\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_IPFilter_PermissiveRule\",\r\n            \"name\": \"IP filter rule includes a large IP range\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_OpenPorts\",\r\n            \"name\": \"Device has open ports\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveFirewallPolicy\",\r\n            \"name\": \"Permissive firewall policy in one of the chains\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveInputFirewallRules\",\r\n            \"name\": \"Permissive firewall rule in the input chain\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveOutputFirewallRules\",\r\n            \"name\": \"Permissive firewall rule in the output chain\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PrivilegedDockerOptions\",\r\n            \"name\": \"High level permissions configured in IoT Edge model twin for IoT Edge module\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_RecommendedIpRulesByBaseLine\",\r\n            \"name\": \"Recommended Rules for ip filter\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_SharedCredentials\",\r\n            \"name\": \"Same authentication credentials used by multiple devices\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_VulnerableTLSCipherSuite\",\r\n            \"name\": \"TLS cipher suite upgrade needed\",\r\n            \"status\": \"Enabled\"\r\n          }\r\n        ],\r\n        \"autoDiscoveredResources\": [],\r\n        \"unmaskedIpLoggingStatus\": \"Disabled\"\r\n      },\r\n      \"tags\": {}\r\n    },\r\n    {\r\n      \"id\": \"/subscriptions/075423e9-7d33-4166-8bdf-3920b04e3735/resourceGroups/michalresourcegroup/providers/Microsoft.Security/IoTSecuritySolutions/michalhubtest11\",\r\n      \"name\": \"michalhubtest11\",\r\n      \"type\": \"Microsoft.Security/IoTSecuritySolutions\",\r\n      \"location\": \"Southeast Asia\",\r\n      \"properties\": {\r\n        \"displayName\": \"MichalHubTest11\",\r\n        \"status\": \"Enabled\",\r\n        \"export\": [\r\n          \"RawEvents\"\r\n        ],\r\n        \"disabledDataSources\": [],\r\n        \"workspace\": \"/subscriptions/075423e9-7d33-4166-8bdf-3920b04e3735/resourcegroups/galm-iot-hub/providers/microsoft.operationalinsights/workspaces/iothubworkspace-westeurope-1570457741215\",\r\n        \"additionalWorkspaces\": null,\r\n        \"iotHubs\": [],\r\n        \"userDefinedResources\": {\r\n          \"query\": \"where type != \\\"microsoft.devices/iothubs\\\" | where (subscriptionId == \\\"075423e9-7d33-4166-8bdf-3920b04e3735\\\" and resourceGroup in~ (\\\"michalresourcegroup\\\")) | project id, name, type\",\r\n          \"querySubscriptions\": [\r\n            \"075423e9-7d33-4166-8bdf-3920b04e3735\"\r\n          ]\r\n        },\r\n        \"recommendationsConfiguration\": [\r\n          {\r\n            \"recommendationType\": \"IoT_ACRAuthentication\",\r\n            \"name\": \"Service prinicpal not used with ACR repository\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_AgentSendsUnutilizedMessages\",\r\n            \"name\": \"Agent sending underutilized messages\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_Baseline\",\r\n            \"name\": \"Operating system (OS) baseline validation failure\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_EdgeHubMemOptimize\",\r\n            \"name\": \"IoT Edge Hub memory can be optimized\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_EdgeLoggingOptions\",\r\n            \"name\": \"No logging configured for IoT Edge module\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_InconsistentModuleSettings\",\r\n            \"name\": \"SecurityGroup has inconsistent module settings\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_InstallAgent\",\r\n            \"name\": \"Install the Azure IoT Security agent\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_IPFilter_DenyAll\",\r\n            \"name\": \"Default IP filter policy should be deny\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_IPFilter_PermissiveRule\",\r\n            \"name\": \"IP filter rule includes a large IP range\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_OpenPorts\",\r\n            \"name\": \"Device has open ports\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveFirewallPolicy\",\r\n            \"name\": \"Permissive firewall policy in one of the chains\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveInputFirewallRules\",\r\n            \"name\": \"Permissive firewall rule in the input chain\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveOutputFirewallRules\",\r\n            \"name\": \"Permissive firewall rule in the output chain\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PrivilegedDockerOptions\",\r\n            \"name\": \"High level permissions configured in IoT Edge model twin for IoT Edge module\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_RecommendedIpRulesByBaseLine\",\r\n            \"name\": \"Recommended Rules for ip filter\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_SharedCredentials\",\r\n            \"name\": \"Same authentication credentials used by multiple devices\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_VulnerableTLSCipherSuite\",\r\n            \"name\": \"TLS cipher suite upgrade needed\",\r\n            \"status\": \"Enabled\"\r\n          }\r\n        ],\r\n        \"autoDiscoveredResources\": [],\r\n        \"unmaskedIpLoggingStatus\": \"Disabled\"\r\n      },\r\n      \"tags\": {}\r\n    },\r\n    {\r\n      \"id\": \"/subscriptions/075423e9-7d33-4166-8bdf-3920b04e3735/resourceGroups/michalresourcegroup/providers/Microsoft.Security/IoTSecuritySolutions/michalhubtest12\",\r\n      \"name\": \"michalhubtest12\",\r\n      \"type\": \"Microsoft.Security/IoTSecuritySolutions\",\r\n      \"location\": \"Southeast Asia\",\r\n      \"properties\": {\r\n        \"displayName\": \"MichalHubTest12\",\r\n        \"status\": \"Enabled\",\r\n        \"export\": [\r\n          \"RawEvents\"\r\n        ],\r\n        \"disabledDataSources\": [],\r\n        \"workspace\": \"/subscriptions/075423e9-7d33-4166-8bdf-3920b04e3735/resourcegroups/galm-iot-hub/providers/microsoft.operationalinsights/workspaces/iothubworkspace-westeurope-1570457741215\",\r\n        \"additionalWorkspaces\": null,\r\n        \"iotHubs\": [],\r\n        \"userDefinedResources\": {\r\n          \"query\": \"where type != \\\"microsoft.devices/iothubs\\\" | where (subscriptionId == \\\"075423e9-7d33-4166-8bdf-3920b04e3735\\\" and resourceGroup in~ (\\\"michalresourcegroup\\\")) | project id, name, type\",\r\n          \"querySubscriptions\": [\r\n            \"075423e9-7d33-4166-8bdf-3920b04e3735\"\r\n          ]\r\n        },\r\n        \"recommendationsConfiguration\": [\r\n          {\r\n            \"recommendationType\": \"IoT_ACRAuthentication\",\r\n            \"name\": \"Service prinicpal not used with ACR repository\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_AgentSendsUnutilizedMessages\",\r\n            \"name\": \"Agent sending underutilized messages\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_Baseline\",\r\n            \"name\": \"Operating system (OS) baseline validation failure\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_EdgeHubMemOptimize\",\r\n            \"name\": \"IoT Edge Hub memory can be optimized\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_EdgeLoggingOptions\",\r\n            \"name\": \"No logging configured for IoT Edge module\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_InconsistentModuleSettings\",\r\n            \"name\": \"SecurityGroup has inconsistent module settings\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_InstallAgent\",\r\n            \"name\": \"Install the Azure IoT Security agent\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_IPFilter_DenyAll\",\r\n            \"name\": \"Default IP filter policy should be deny\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_IPFilter_PermissiveRule\",\r\n            \"name\": \"IP filter rule includes a large IP range\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_OpenPorts\",\r\n            \"name\": \"Device has open ports\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveFirewallPolicy\",\r\n            \"name\": \"Permissive firewall policy in one of the chains\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveInputFirewallRules\",\r\n            \"name\": \"Permissive firewall rule in the input chain\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveOutputFirewallRules\",\r\n            \"name\": \"Permissive firewall rule in the output chain\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PrivilegedDockerOptions\",\r\n            \"name\": \"High level permissions configured in IoT Edge model twin for IoT Edge module\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_RecommendedIpRulesByBaseLine\",\r\n            \"name\": \"Recommended Rules for ip filter\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_SharedCredentials\",\r\n            \"name\": \"Same authentication credentials used by multiple devices\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_VulnerableTLSCipherSuite\",\r\n            \"name\": \"TLS cipher suite upgrade needed\",\r\n            \"status\": \"Enabled\"\r\n          }\r\n        ],\r\n        \"autoDiscoveredResources\": [],\r\n        \"unmaskedIpLoggingStatus\": \"Disabled\"\r\n      },\r\n      \"tags\": {}\r\n    },\r\n    {\r\n      \"id\": \"/subscriptions/075423e9-7d33-4166-8bdf-3920b04e3735/resourceGroups/michalresourcegroup/providers/Microsoft.Security/IoTSecuritySolutions/michalhubtest16\",\r\n      \"name\": \"michalhubtest16\",\r\n      \"type\": \"Microsoft.Security/IoTSecuritySolutions\",\r\n      \"location\": \"koreasouth\",\r\n      \"properties\": {\r\n        \"displayName\": \"MichalHubTest16\",\r\n        \"status\": \"Enabled\",\r\n        \"export\": [\r\n          \"RawEvents\"\r\n        ],\r\n        \"disabledDataSources\": [],\r\n        \"workspace\": \"/subscriptions/075423e9-7d33-4166-8bdf-3920b04e3735/resourcegroups/galm-iot-hub/providers/microsoft.operationalinsights/workspaces/iothubworkspace-westeurope-1570457741215\",\r\n        \"additionalWorkspaces\": null,\r\n        \"iotHubs\": [],\r\n        \"userDefinedResources\": {\r\n          \"query\": \"where type != \\\"microsoft.devices/iothubs\\\" | where (subscriptionId == \\\"075423e9-7d33-4166-8bdf-3920b04e3735\\\" and resourceGroup in~ (\\\"michalresourcegroup\\\")) | project id, name, type\",\r\n          \"querySubscriptions\": [\r\n            \"075423e9-7d33-4166-8bdf-3920b04e3735\"\r\n          ]\r\n        },\r\n        \"recommendationsConfiguration\": [\r\n          {\r\n            \"recommendationType\": \"IoT_ACRAuthentication\",\r\n            \"name\": \"Service prinicpal not used with ACR repository\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_AgentSendsUnutilizedMessages\",\r\n            \"name\": \"Agent sending underutilized messages\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_Baseline\",\r\n            \"name\": \"Operating system (OS) baseline validation failure\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_EdgeHubMemOptimize\",\r\n            \"name\": \"IoT Edge Hub memory can be optimized\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_EdgeLoggingOptions\",\r\n            \"name\": \"No logging configured for IoT Edge module\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_InconsistentModuleSettings\",\r\n            \"name\": \"SecurityGroup has inconsistent module settings\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_InstallAgent\",\r\n            \"name\": \"Install the Azure IoT Security agent\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_IPFilter_DenyAll\",\r\n            \"name\": \"Default IP filter policy should be deny\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_IPFilter_PermissiveRule\",\r\n            \"name\": \"IP filter rule includes a large IP range\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_OpenPorts\",\r\n            \"name\": \"Device has open ports\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveFirewallPolicy\",\r\n            \"name\": \"Permissive firewall policy in one of the chains\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveInputFirewallRules\",\r\n            \"name\": \"Permissive firewall rule in the input chain\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveOutputFirewallRules\",\r\n            \"name\": \"Permissive firewall rule in the output chain\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PrivilegedDockerOptions\",\r\n            \"name\": \"High level permissions configured in IoT Edge model twin for IoT Edge module\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_RecommendedIpRulesByBaseLine\",\r\n            \"name\": \"Recommended Rules for ip filter\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_SharedCredentials\",\r\n            \"name\": \"Same authentication credentials used by multiple devices\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_VulnerableTLSCipherSuite\",\r\n            \"name\": \"TLS cipher suite upgrade needed\",\r\n            \"status\": \"Enabled\"\r\n          }\r\n        ],\r\n        \"autoDiscoveredResources\": [],\r\n        \"unmaskedIpLoggingStatus\": \"Disabled\"\r\n      },\r\n      \"tags\": {}\r\n    },\r\n    {\r\n      \"id\": \"/subscriptions/075423e9-7d33-4166-8bdf-3920b04e3735/resourceGroups/michalresourcegroup/providers/Microsoft.Security/IoTSecuritySolutions/michalhubtest15\",\r\n      \"name\": \"michalhubtest15\",\r\n      \"type\": \"Microsoft.Security/IoTSecuritySolutions\",\r\n      \"location\": \"koreasouth\",\r\n      \"properties\": {\r\n        \"displayName\": \"MichalHubTest15\",\r\n        \"status\": \"Enabled\",\r\n        \"export\": [\r\n          \"RawEvents\"\r\n        ],\r\n        \"disabledDataSources\": [],\r\n        \"workspace\": \"/subscriptions/075423e9-7d33-4166-8bdf-3920b04e3735/resourcegroups/galm-iot-hub/providers/microsoft.operationalinsights/workspaces/iothubworkspace-westeurope-1570457741215\",\r\n        \"additionalWorkspaces\": null,\r\n        \"iotHubs\": [],\r\n        \"userDefinedResources\": {\r\n          \"query\": \"where type != \\\"microsoft.devices/iothubs\\\" | where (subscriptionId == \\\"075423e9-7d33-4166-8bdf-3920b04e3735\\\" and resourceGroup in~ (\\\"michalresourcegroup\\\")) | project id, name, type\",\r\n          \"querySubscriptions\": [\r\n            \"075423e9-7d33-4166-8bdf-3920b04e3735\"\r\n          ]\r\n        },\r\n        \"recommendationsConfiguration\": [\r\n          {\r\n            \"recommendationType\": \"IoT_ACRAuthentication\",\r\n            \"name\": \"Service prinicpal not used with ACR repository\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_AgentSendsUnutilizedMessages\",\r\n            \"name\": \"Agent sending underutilized messages\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_Baseline\",\r\n            \"name\": \"Operating system (OS) baseline validation failure\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_EdgeHubMemOptimize\",\r\n            \"name\": \"IoT Edge Hub memory can be optimized\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_EdgeLoggingOptions\",\r\n            \"name\": \"No logging configured for IoT Edge module\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_InconsistentModuleSettings\",\r\n            \"name\": \"SecurityGroup has inconsistent module settings\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_InstallAgent\",\r\n            \"name\": \"Install the Azure IoT Security agent\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_IPFilter_DenyAll\",\r\n            \"name\": \"Default IP filter policy should be deny\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_IPFilter_PermissiveRule\",\r\n            \"name\": \"IP filter rule includes a large IP range\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_OpenPorts\",\r\n            \"name\": \"Device has open ports\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveFirewallPolicy\",\r\n            \"name\": \"Permissive firewall policy in one of the chains\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveInputFirewallRules\",\r\n            \"name\": \"Permissive firewall rule in the input chain\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveOutputFirewallRules\",\r\n            \"name\": \"Permissive firewall rule in the output chain\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PrivilegedDockerOptions\",\r\n            \"name\": \"High level permissions configured in IoT Edge model twin for IoT Edge module\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_RecommendedIpRulesByBaseLine\",\r\n            \"name\": \"Recommended Rules for ip filter\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_SharedCredentials\",\r\n            \"name\": \"Same authentication credentials used by multiple devices\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_VulnerableTLSCipherSuite\",\r\n            \"name\": \"TLS cipher suite upgrade needed\",\r\n            \"status\": \"Enabled\"\r\n          }\r\n        ],\r\n        \"autoDiscoveredResources\": [],\r\n        \"unmaskedIpLoggingStatus\": \"Disabled\"\r\n      },\r\n      \"tags\": {}\r\n    },\r\n    {\r\n      \"id\": \"/subscriptions/075423e9-7d33-4166-8bdf-3920b04e3735/resourceGroups/michalresourcegroup/providers/Microsoft.Security/IoTSecuritySolutions/michalhubtest18\",\r\n      \"name\": \"michalhubtest18\",\r\n      \"type\": \"Microsoft.Security/IoTSecuritySolutions\",\r\n      \"location\": \"koreasouth\",\r\n      \"properties\": {\r\n        \"displayName\": \"MichalHubTest18\",\r\n        \"status\": \"Enabled\",\r\n        \"export\": [\r\n          \"RawEvents\"\r\n        ],\r\n        \"disabledDataSources\": [],\r\n        \"workspace\": \"/subscriptions/075423e9-7d33-4166-8bdf-3920b04e3735/resourcegroups/galm-iot-hub/providers/microsoft.operationalinsights/workspaces/iothubworkspace-westeurope-1570457741215\",\r\n        \"additionalWorkspaces\": null,\r\n        \"iotHubs\": [],\r\n        \"userDefinedResources\": {\r\n          \"query\": \"where type != \\\"microsoft.devices/iothubs\\\" | where (subscriptionId == \\\"075423e9-7d33-4166-8bdf-3920b04e3735\\\" and resourceGroup in~ (\\\"michalresourcegroup\\\")) | project id, name, type\",\r\n          \"querySubscriptions\": [\r\n            \"075423e9-7d33-4166-8bdf-3920b04e3735\"\r\n          ]\r\n        },\r\n        \"recommendationsConfiguration\": [\r\n          {\r\n            \"recommendationType\": \"IoT_ACRAuthentication\",\r\n            \"name\": \"Service prinicpal not used with ACR repository\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_AgentSendsUnutilizedMessages\",\r\n            \"name\": \"Agent sending underutilized messages\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_Baseline\",\r\n            \"name\": \"Operating system (OS) baseline validation failure\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_EdgeHubMemOptimize\",\r\n            \"name\": \"IoT Edge Hub memory can be optimized\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_EdgeLoggingOptions\",\r\n            \"name\": \"No logging configured for IoT Edge module\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_InconsistentModuleSettings\",\r\n            \"name\": \"SecurityGroup has inconsistent module settings\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_InstallAgent\",\r\n            \"name\": \"Install the Azure IoT Security agent\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_IPFilter_DenyAll\",\r\n            \"name\": \"Default IP filter policy should be deny\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_IPFilter_PermissiveRule\",\r\n            \"name\": \"IP filter rule includes a large IP range\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_OpenPorts\",\r\n            \"name\": \"Device has open ports\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveFirewallPolicy\",\r\n            \"name\": \"Permissive firewall policy in one of the chains\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveInputFirewallRules\",\r\n            \"name\": \"Permissive firewall rule in the input chain\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveOutputFirewallRules\",\r\n            \"name\": \"Permissive firewall rule in the output chain\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PrivilegedDockerOptions\",\r\n            \"name\": \"High level permissions configured in IoT Edge model twin for IoT Edge module\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_RecommendedIpRulesByBaseLine\",\r\n            \"name\": \"Recommended Rules for ip filter\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_SharedCredentials\",\r\n            \"name\": \"Same authentication credentials used by multiple devices\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_VulnerableTLSCipherSuite\",\r\n            \"name\": \"TLS cipher suite upgrade needed\",\r\n            \"status\": \"Enabled\"\r\n          }\r\n        ],\r\n        \"autoDiscoveredResources\": [],\r\n        \"unmaskedIpLoggingStatus\": \"Disabled\"\r\n      },\r\n      \"tags\": {}\r\n    },\r\n    {\r\n      \"id\": \"/subscriptions/075423e9-7d33-4166-8bdf-3920b04e3735/resourceGroups/michalresourcegroup/providers/Microsoft.Security/IoTSecuritySolutions/michalhubtest20\",\r\n      \"name\": \"michalhubtest20\",\r\n      \"type\": \"Microsoft.Security/IoTSecuritySolutions\",\r\n      \"location\": \"West US\",\r\n      \"properties\": {\r\n        \"displayName\": \"MichalHubTest20\",\r\n        \"status\": \"Enabled\",\r\n        \"export\": [\r\n          \"RawEvents\"\r\n        ],\r\n        \"disabledDataSources\": [],\r\n        \"workspace\": \"/subscriptions/075423e9-7d33-4166-8bdf-3920b04e3735/resourcegroups/michalresourcegroup/providers/microsoft.operationalinsights/workspaces/iothubworkspace-westus-1570457741214\",\r\n        \"additionalWorkspaces\": null,\r\n        \"iotHubs\": [],\r\n        \"userDefinedResources\": {\r\n          \"query\": \"where type != \\\"microsoft.devices/iothubs\\\" | where (subscriptionId == \\\"075423e9-7d33-4166-8bdf-3920b04e3735\\\" and resourceGroup in~ (\\\"michalresourcegroup\\\")) | project id, name, type\",\r\n          \"querySubscriptions\": [\r\n            \"075423e9-7d33-4166-8bdf-3920b04e3735\"\r\n          ]\r\n        },\r\n        \"recommendationsConfiguration\": [\r\n          {\r\n            \"recommendationType\": \"IoT_ACRAuthentication\",\r\n            \"name\": \"Service prinicpal not used with ACR repository\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_AgentSendsUnutilizedMessages\",\r\n            \"name\": \"Agent sending underutilized messages\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_Baseline\",\r\n            \"name\": \"Operating system (OS) baseline validation failure\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_EdgeHubMemOptimize\",\r\n            \"name\": \"IoT Edge Hub memory can be optimized\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_EdgeLoggingOptions\",\r\n            \"name\": \"No logging configured for IoT Edge module\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_InconsistentModuleSettings\",\r\n            \"name\": \"SecurityGroup has inconsistent module settings\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_InstallAgent\",\r\n            \"name\": \"Install the Azure IoT Security agent\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_IPFilter_DenyAll\",\r\n            \"name\": \"Default IP filter policy should be deny\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_IPFilter_PermissiveRule\",\r\n            \"name\": \"IP filter rule includes a large IP range\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_OpenPorts\",\r\n            \"name\": \"Device has open ports\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveFirewallPolicy\",\r\n            \"name\": \"Permissive firewall policy in one of the chains\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveInputFirewallRules\",\r\n            \"name\": \"Permissive firewall rule in the input chain\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveOutputFirewallRules\",\r\n            \"name\": \"Permissive firewall rule in the output chain\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PrivilegedDockerOptions\",\r\n            \"name\": \"High level permissions configured in IoT Edge model twin for IoT Edge module\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_RecommendedIpRulesByBaseLine\",\r\n            \"name\": \"Recommended Rules for ip filter\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_SharedCredentials\",\r\n            \"name\": \"Same authentication credentials used by multiple devices\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_VulnerableTLSCipherSuite\",\r\n            \"name\": \"TLS cipher suite upgrade needed\",\r\n            \"status\": \"Enabled\"\r\n          }\r\n        ],\r\n        \"autoDiscoveredResources\": [],\r\n        \"unmaskedIpLoggingStatus\": \"Disabled\"\r\n      },\r\n      \"tags\": {}\r\n    },\r\n    {\r\n      \"id\": \"/subscriptions/075423e9-7d33-4166-8bdf-3920b04e3735/resourceGroups/michalresourcegroup/providers/Microsoft.Security/IoTSecuritySolutions/michalhubtest25\",\r\n      \"name\": \"michalhubtest25\",\r\n      \"type\": \"Microsoft.Security/IoTSecuritySolutions\",\r\n      \"location\": \"Japan West\",\r\n      \"properties\": {\r\n        \"displayName\": \"MichalHubTest25\",\r\n        \"status\": \"Enabled\",\r\n        \"export\": [\r\n          \"RawEvents\"\r\n        ],\r\n        \"disabledDataSources\": [],\r\n        \"workspace\": \"/subscriptions/075423e9-7d33-4166-8bdf-3920b04e3735/resourcegroups/galm-iot-hub/providers/microsoft.operationalinsights/workspaces/iothubworkspace-westeurope-1570457741215\",\r\n        \"additionalWorkspaces\": null,\r\n        \"iotHubs\": [],\r\n        \"userDefinedResources\": {\r\n          \"query\": \"where type != \\\"microsoft.devices/iothubs\\\" | where (subscriptionId == \\\"075423e9-7d33-4166-8bdf-3920b04e3735\\\" and resourceGroup in~ (\\\"michalresourcegroup\\\")) | project id, name, type\",\r\n          \"querySubscriptions\": [\r\n            \"075423e9-7d33-4166-8bdf-3920b04e3735\"\r\n          ]\r\n        },\r\n        \"recommendationsConfiguration\": [\r\n          {\r\n            \"recommendationType\": \"IoT_ACRAuthentication\",\r\n            \"name\": \"Service prinicpal not used with ACR repository\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_AgentSendsUnutilizedMessages\",\r\n            \"name\": \"Agent sending underutilized messages\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_Baseline\",\r\n            \"name\": \"Operating system (OS) baseline validation failure\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_EdgeHubMemOptimize\",\r\n            \"name\": \"IoT Edge Hub memory can be optimized\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_EdgeLoggingOptions\",\r\n            \"name\": \"No logging configured for IoT Edge module\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_InconsistentModuleSettings\",\r\n            \"name\": \"SecurityGroup has inconsistent module settings\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_InstallAgent\",\r\n            \"name\": \"Install the Azure IoT Security agent\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_IPFilter_DenyAll\",\r\n            \"name\": \"Default IP filter policy should be deny\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_IPFilter_PermissiveRule\",\r\n            \"name\": \"IP filter rule includes a large IP range\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_OpenPorts\",\r\n            \"name\": \"Device has open ports\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveFirewallPolicy\",\r\n            \"name\": \"Permissive firewall policy in one of the chains\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveInputFirewallRules\",\r\n            \"name\": \"Permissive firewall rule in the input chain\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveOutputFirewallRules\",\r\n            \"name\": \"Permissive firewall rule in the output chain\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PrivilegedDockerOptions\",\r\n            \"name\": \"High level permissions configured in IoT Edge model twin for IoT Edge module\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_RecommendedIpRulesByBaseLine\",\r\n            \"name\": \"Recommended Rules for ip filter\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_SharedCredentials\",\r\n            \"name\": \"Same authentication credentials used by multiple devices\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_VulnerableTLSCipherSuite\",\r\n            \"name\": \"TLS cipher suite upgrade needed\",\r\n            \"status\": \"Enabled\"\r\n          }\r\n        ],\r\n        \"autoDiscoveredResources\": [],\r\n        \"unmaskedIpLoggingStatus\": \"Disabled\"\r\n      },\r\n      \"tags\": {}\r\n    },\r\n    {\r\n      \"id\": \"/subscriptions/075423e9-7d33-4166-8bdf-3920b04e3735/resourceGroups/michalresourcegroup/providers/Microsoft.Security/IoTSecuritySolutions/michalhubtest23\",\r\n      \"name\": \"michalhubtest23\",\r\n      \"type\": \"Microsoft.Security/IoTSecuritySolutions\",\r\n      \"location\": \"Australia East\",\r\n      \"properties\": {\r\n        \"displayName\": \"MichalHubTest23\",\r\n        \"status\": \"Enabled\",\r\n        \"export\": [\r\n          \"RawEvents\"\r\n        ],\r\n        \"disabledDataSources\": [],\r\n        \"workspace\": null,\r\n        \"additionalWorkspaces\": null,\r\n        \"iotHubs\": [],\r\n        \"userDefinedResources\": {\r\n          \"query\": \"where type != \\\"microsoft.devices/iothubs\\\" | where (subscriptionId == \\\"075423e9-7d33-4166-8bdf-3920b04e3735\\\" and resourceGroup in~ (\\\"michalresourcegroup\\\")) | project id, name, type\",\r\n          \"querySubscriptions\": [\r\n            \"075423e9-7d33-4166-8bdf-3920b04e3735\"\r\n          ]\r\n        },\r\n        \"recommendationsConfiguration\": [\r\n          {\r\n            \"recommendationType\": \"IoT_ACRAuthentication\",\r\n            \"name\": \"Service prinicpal not used with ACR repository\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_AgentSendsUnutilizedMessages\",\r\n            \"name\": \"Agent sending underutilized messages\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_Baseline\",\r\n            \"name\": \"Operating system (OS) baseline validation failure\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_EdgeHubMemOptimize\",\r\n            \"name\": \"IoT Edge Hub memory can be optimized\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_EdgeLoggingOptions\",\r\n            \"name\": \"No logging configured for IoT Edge module\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_InconsistentModuleSettings\",\r\n            \"name\": \"SecurityGroup has inconsistent module settings\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_InstallAgent\",\r\n            \"name\": \"Install the Azure IoT Security agent\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_IPFilter_DenyAll\",\r\n            \"name\": \"Default IP filter policy should be deny\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_IPFilter_PermissiveRule\",\r\n            \"name\": \"IP filter rule includes a large IP range\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_OpenPorts\",\r\n            \"name\": \"Device has open ports\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveFirewallPolicy\",\r\n            \"name\": \"Permissive firewall policy in one of the chains\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveInputFirewallRules\",\r\n            \"name\": \"Permissive firewall rule in the input chain\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveOutputFirewallRules\",\r\n            \"name\": \"Permissive firewall rule in the output chain\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PrivilegedDockerOptions\",\r\n            \"name\": \"High level permissions configured in IoT Edge model twin for IoT Edge module\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_RecommendedIpRulesByBaseLine\",\r\n            \"name\": \"Recommended Rules for ip filter\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_SharedCredentials\",\r\n            \"name\": \"Same authentication credentials used by multiple devices\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_VulnerableTLSCipherSuite\",\r\n            \"name\": \"TLS cipher suite upgrade needed\",\r\n            \"status\": \"Enabled\"\r\n          }\r\n        ],\r\n        \"autoDiscoveredResources\": [],\r\n        \"unmaskedIpLoggingStatus\": \"Disabled\"\r\n      },\r\n      \"tags\": {}\r\n    },\r\n    {\r\n      \"id\": \"/subscriptions/075423e9-7d33-4166-8bdf-3920b04e3735/resourceGroups/michalresourcegroup/providers/Microsoft.Security/IoTSecuritySolutions/michalhubtest30\",\r\n      \"name\": \"michalhubtest30\",\r\n      \"type\": \"Microsoft.Security/IoTSecuritySolutions\",\r\n      \"location\": \"West US\",\r\n      \"properties\": {\r\n        \"displayName\": \"MichalHubTest30\",\r\n        \"status\": \"Enabled\",\r\n        \"export\": [\r\n          \"RawEvents\"\r\n        ],\r\n        \"disabledDataSources\": [],\r\n        \"workspace\": \"/subscriptions/075423e9-7d33-4166-8bdf-3920b04e3735/resourcegroups/michalresourcegroup/providers/microsoft.operationalinsights/workspaces/iothubworkspace-westus-1570457741214\",\r\n        \"additionalWorkspaces\": null,\r\n        \"iotHubs\": [],\r\n        \"userDefinedResources\": {\r\n          \"query\": \"where type != \\\"microsoft.devices/iothubs\\\" | where (subscriptionId == \\\"075423e9-7d33-4166-8bdf-3920b04e3735\\\" and resourceGroup in~ (\\\"michalresourcegroup\\\")) | project id, name, type\",\r\n          \"querySubscriptions\": [\r\n            \"075423e9-7d33-4166-8bdf-3920b04e3735\"\r\n          ]\r\n        },\r\n        \"recommendationsConfiguration\": [\r\n          {\r\n            \"recommendationType\": \"IoT_ACRAuthentication\",\r\n            \"name\": \"Service prinicpal not used with ACR repository\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_AgentSendsUnutilizedMessages\",\r\n            \"name\": \"Agent sending underutilized messages\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_Baseline\",\r\n            \"name\": \"Operating system (OS) baseline validation failure\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_EdgeHubMemOptimize\",\r\n            \"name\": \"IoT Edge Hub memory can be optimized\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_EdgeLoggingOptions\",\r\n            \"name\": \"No logging configured for IoT Edge module\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_InconsistentModuleSettings\",\r\n            \"name\": \"SecurityGroup has inconsistent module settings\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_InstallAgent\",\r\n            \"name\": \"Install the Azure IoT Security agent\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_IPFilter_DenyAll\",\r\n            \"name\": \"Default IP filter policy should be deny\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_IPFilter_PermissiveRule\",\r\n            \"name\": \"IP filter rule includes a large IP range\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_OpenPorts\",\r\n            \"name\": \"Device has open ports\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveFirewallPolicy\",\r\n            \"name\": \"Permissive firewall policy in one of the chains\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveInputFirewallRules\",\r\n            \"name\": \"Permissive firewall rule in the input chain\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveOutputFirewallRules\",\r\n            \"name\": \"Permissive firewall rule in the output chain\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PrivilegedDockerOptions\",\r\n            \"name\": \"High level permissions configured in IoT Edge model twin for IoT Edge module\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_RecommendedIpRulesByBaseLine\",\r\n            \"name\": \"Recommended Rules for ip filter\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_SharedCredentials\",\r\n            \"name\": \"Same authentication credentials used by multiple devices\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_VulnerableTLSCipherSuite\",\r\n            \"name\": \"TLS cipher suite upgrade needed\",\r\n            \"status\": \"Enabled\"\r\n          }\r\n        ],\r\n        \"autoDiscoveredResources\": [],\r\n        \"unmaskedIpLoggingStatus\": \"Disabled\"\r\n      },\r\n      \"tags\": {}\r\n    },\r\n    {\r\n      \"id\": \"/subscriptions/075423e9-7d33-4166-8bdf-3920b04e3735/resourceGroups/michalresourcegroup/providers/Microsoft.Security/IoTSecuritySolutions/michalnewhub1\",\r\n      \"name\": \"michalnewhub1\",\r\n      \"type\": \"Microsoft.Security/IoTSecuritySolutions\",\r\n      \"location\": \"West US\",\r\n      \"properties\": {\r\n        \"displayName\": \"MichalNewHub1\",\r\n        \"status\": \"Enabled\",\r\n        \"export\": [\r\n          \"RawEvents\"\r\n        ],\r\n        \"disabledDataSources\": [],\r\n        \"workspace\": \"/subscriptions/075423e9-7d33-4166-8bdf-3920b04e3735/resourcegroups/michalresourcegroup/providers/microsoft.operationalinsights/workspaces/iothubworkspace-westus-1570457741214\",\r\n        \"additionalWorkspaces\": null,\r\n        \"iotHubs\": [],\r\n        \"userDefinedResources\": {\r\n          \"query\": \"where type != \\\"microsoft.devices/iothubs\\\" | where (subscriptionId == \\\"075423e9-7d33-4166-8bdf-3920b04e3735\\\" and resourceGroup in~ (\\\"michalresourcegroup\\\")) | project id, name, type\",\r\n          \"querySubscriptions\": [\r\n            \"075423e9-7d33-4166-8bdf-3920b04e3735\"\r\n          ]\r\n        },\r\n        \"recommendationsConfiguration\": [\r\n          {\r\n            \"recommendationType\": \"IoT_ACRAuthentication\",\r\n            \"name\": \"Service prinicpal not used with ACR repository\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_AgentSendsUnutilizedMessages\",\r\n            \"name\": \"Agent sending underutilized messages\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_Baseline\",\r\n            \"name\": \"Operating system (OS) baseline validation failure\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_EdgeHubMemOptimize\",\r\n            \"name\": \"IoT Edge Hub memory can be optimized\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_EdgeLoggingOptions\",\r\n            \"name\": \"No logging configured for IoT Edge module\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_InconsistentModuleSettings\",\r\n            \"name\": \"SecurityGroup has inconsistent module settings\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_InstallAgent\",\r\n            \"name\": \"Install the Azure IoT Security agent\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_IPFilter_DenyAll\",\r\n            \"name\": \"Default IP filter policy should be deny\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_IPFilter_PermissiveRule\",\r\n            \"name\": \"IP filter rule includes a large IP range\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_OpenPorts\",\r\n            \"name\": \"Device has open ports\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveFirewallPolicy\",\r\n            \"name\": \"Permissive firewall policy in one of the chains\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveInputFirewallRules\",\r\n            \"name\": \"Permissive firewall rule in the input chain\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveOutputFirewallRules\",\r\n            \"name\": \"Permissive firewall rule in the output chain\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PrivilegedDockerOptions\",\r\n            \"name\": \"High level permissions configured in IoT Edge model twin for IoT Edge module\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_RecommendedIpRulesByBaseLine\",\r\n            \"name\": \"Recommended Rules for ip filter\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_SharedCredentials\",\r\n            \"name\": \"Same authentication credentials used by multiple devices\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_VulnerableTLSCipherSuite\",\r\n            \"name\": \"TLS cipher suite upgrade needed\",\r\n            \"status\": \"Enabled\"\r\n          }\r\n        ],\r\n        \"autoDiscoveredResources\": [],\r\n        \"unmaskedIpLoggingStatus\": \"Enabled\"\r\n      },\r\n      \"tags\": {}\r\n    },\r\n    {\r\n      \"id\": \"/subscriptions/075423e9-7d33-4166-8bdf-3920b04e3735/resourceGroups/michalresourcegroup/providers/Microsoft.Security/IoTSecuritySolutions/michalnewhub2\",\r\n      \"name\": \"michalnewhub2\",\r\n      \"type\": \"Microsoft.Security/IoTSecuritySolutions\",\r\n      \"location\": \"West US\",\r\n      \"properties\": {\r\n        \"displayName\": \"MichalNewHub2\",\r\n        \"status\": \"Enabled\",\r\n        \"export\": [\r\n          \"RawEvents\"\r\n        ],\r\n        \"disabledDataSources\": [],\r\n        \"workspace\": \"/subscriptions/075423e9-7d33-4166-8bdf-3920b04e3735/resourcegroups/michalresourcegroup/providers/microsoft.operationalinsights/workspaces/iothubworkspace-westus\",\r\n        \"additionalWorkspaces\": null,\r\n        \"iotHubs\": [],\r\n        \"userDefinedResources\": {\r\n          \"query\": \"where type != \\\"microsoft.devices/iothubs\\\" | where (subscriptionId == \\\"075423e9-7d33-4166-8bdf-3920b04e3735\\\" and resourceGroup in~ (\\\"michalresourcegroup\\\")) | project id, name, type\",\r\n          \"querySubscriptions\": [\r\n            \"075423e9-7d33-4166-8bdf-3920b04e3735\"\r\n          ]\r\n        },\r\n        \"recommendationsConfiguration\": [\r\n          {\r\n            \"recommendationType\": \"IoT_ACRAuthentication\",\r\n            \"name\": \"Service prinicpal not used with ACR repository\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_AgentSendsUnutilizedMessages\",\r\n            \"name\": \"Agent sending underutilized messages\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_Baseline\",\r\n            \"name\": \"Operating system (OS) baseline validation failure\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_EdgeHubMemOptimize\",\r\n            \"name\": \"IoT Edge Hub memory can be optimized\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_EdgeLoggingOptions\",\r\n            \"name\": \"No logging configured for IoT Edge module\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_InconsistentModuleSettings\",\r\n            \"name\": \"SecurityGroup has inconsistent module settings\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_InstallAgent\",\r\n            \"name\": \"Install the Azure IoT Security agent\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_IPFilter_DenyAll\",\r\n            \"name\": \"Default IP filter policy should be deny\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_IPFilter_PermissiveRule\",\r\n            \"name\": \"IP filter rule includes a large IP range\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_OpenPorts\",\r\n            \"name\": \"Device has open ports\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveFirewallPolicy\",\r\n            \"name\": \"Permissive firewall policy in one of the chains\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveInputFirewallRules\",\r\n            \"name\": \"Permissive firewall rule in the input chain\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveOutputFirewallRules\",\r\n            \"name\": \"Permissive firewall rule in the output chain\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PrivilegedDockerOptions\",\r\n            \"name\": \"High level permissions configured in IoT Edge model twin for IoT Edge module\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_RecommendedIpRulesByBaseLine\",\r\n            \"name\": \"Recommended Rules for ip filter\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_SharedCredentials\",\r\n            \"name\": \"Same authentication credentials used by multiple devices\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_VulnerableTLSCipherSuite\",\r\n            \"name\": \"TLS cipher suite upgrade needed\",\r\n            \"status\": \"Enabled\"\r\n          }\r\n        ],\r\n        \"autoDiscoveredResources\": [],\r\n        \"unmaskedIpLoggingStatus\": \"Enabled\"\r\n      },\r\n      \"tags\": {}\r\n    },\r\n    {\r\n      \"id\": \"/subscriptions/075423e9-7d33-4166-8bdf-3920b04e3735/resourceGroups/michalresourcegroup/providers/Microsoft.Security/IoTSecuritySolutions/michalnewhub3\",\r\n      \"name\": \"michalnewhub3\",\r\n      \"type\": \"Microsoft.Security/IoTSecuritySolutions\",\r\n      \"location\": \"West US\",\r\n      \"properties\": {\r\n        \"displayName\": \"MichalNewHub3\",\r\n        \"status\": \"Enabled\",\r\n        \"export\": [\r\n          \"RawEvents\"\r\n        ],\r\n        \"disabledDataSources\": [],\r\n        \"workspace\": \"/subscriptions/075423e9-7d33-4166-8bdf-3920b04e3735/resourcegroups/michalresourcegroup/providers/microsoft.operationalinsights/workspaces/iothubworkspace-westus\",\r\n        \"additionalWorkspaces\": null,\r\n        \"iotHubs\": [],\r\n        \"userDefinedResources\": {\r\n          \"query\": \"where type != \\\"microsoft.devices/iothubs\\\" | where (subscriptionId == \\\"075423e9-7d33-4166-8bdf-3920b04e3735\\\" and resourceGroup in~ (\\\"michalresourcegroup\\\")) | project id, name, type\",\r\n          \"querySubscriptions\": [\r\n            \"075423e9-7d33-4166-8bdf-3920b04e3735\"\r\n          ]\r\n        },\r\n        \"recommendationsConfiguration\": [\r\n          {\r\n            \"recommendationType\": \"IoT_ACRAuthentication\",\r\n            \"name\": \"Service prinicpal not used with ACR repository\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_AgentSendsUnutilizedMessages\",\r\n            \"name\": \"Agent sending underutilized messages\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_Baseline\",\r\n            \"name\": \"Operating system (OS) baseline validation failure\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_EdgeHubMemOptimize\",\r\n            \"name\": \"IoT Edge Hub memory can be optimized\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_EdgeLoggingOptions\",\r\n            \"name\": \"No logging configured for IoT Edge module\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_InconsistentModuleSettings\",\r\n            \"name\": \"SecurityGroup has inconsistent module settings\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_InstallAgent\",\r\n            \"name\": \"Install the Azure IoT Security agent\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_IPFilter_DenyAll\",\r\n            \"name\": \"Default IP filter policy should be deny\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_IPFilter_PermissiveRule\",\r\n            \"name\": \"IP filter rule includes a large IP range\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_OpenPorts\",\r\n            \"name\": \"Device has open ports\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveFirewallPolicy\",\r\n            \"name\": \"Permissive firewall policy in one of the chains\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveInputFirewallRules\",\r\n            \"name\": \"Permissive firewall rule in the input chain\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveOutputFirewallRules\",\r\n            \"name\": \"Permissive firewall rule in the output chain\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PrivilegedDockerOptions\",\r\n            \"name\": \"High level permissions configured in IoT Edge model twin for IoT Edge module\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_RecommendedIpRulesByBaseLine\",\r\n            \"name\": \"Recommended Rules for ip filter\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_SharedCredentials\",\r\n            \"name\": \"Same authentication credentials used by multiple devices\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_VulnerableTLSCipherSuite\",\r\n            \"name\": \"TLS cipher suite upgrade needed\",\r\n            \"status\": \"Enabled\"\r\n          }\r\n        ],\r\n        \"autoDiscoveredResources\": [],\r\n        \"unmaskedIpLoggingStatus\": \"Enabled\"\r\n      },\r\n      \"tags\": {}\r\n    },\r\n    {\r\n      \"id\": \"/subscriptions/075423e9-7d33-4166-8bdf-3920b04e3735/resourceGroups/michalresourcegroup/providers/Microsoft.Security/IoTSecuritySolutions/michalnewtest9\",\r\n      \"name\": \"michalnewtest9\",\r\n      \"type\": \"Microsoft.Security/IoTSecuritySolutions\",\r\n      \"location\": \"West US\",\r\n      \"properties\": {\r\n        \"displayName\": \"MichalNewTest9\",\r\n        \"status\": \"Enabled\",\r\n        \"export\": [\r\n          \"RawEvents\"\r\n        ],\r\n        \"disabledDataSources\": [],\r\n        \"workspace\": \"/subscriptions/075423e9-7d33-4166-8bdf-3920b04e3735/resourcegroups/michalresourcegroup/providers/microsoft.operationalinsights/workspaces/iothubworkspace-westus\",\r\n        \"additionalWorkspaces\": null,\r\n        \"iotHubs\": [],\r\n        \"userDefinedResources\": {\r\n          \"query\": \"where type != \\\"microsoft.devices/iothubs\\\" | where (subscriptionId == \\\"075423e9-7d33-4166-8bdf-3920b04e3735\\\" and resourceGroup in~ (\\\"michalresourcegroup\\\")) | project id, name, type\",\r\n          \"querySubscriptions\": [\r\n            \"075423e9-7d33-4166-8bdf-3920b04e3735\"\r\n          ]\r\n        },\r\n        \"recommendationsConfiguration\": [\r\n          {\r\n            \"recommendationType\": \"IoT_ACRAuthentication\",\r\n            \"name\": \"Service prinicpal not used with ACR repository\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_AgentSendsUnutilizedMessages\",\r\n            \"name\": \"Agent sending underutilized messages\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_Baseline\",\r\n            \"name\": \"Operating system (OS) baseline validation failure\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_EdgeHubMemOptimize\",\r\n            \"name\": \"IoT Edge Hub memory can be optimized\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_EdgeLoggingOptions\",\r\n            \"name\": \"No logging configured for IoT Edge module\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_InconsistentModuleSettings\",\r\n            \"name\": \"SecurityGroup has inconsistent module settings\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_InstallAgent\",\r\n            \"name\": \"Install the Azure IoT Security agent\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_IPFilter_DenyAll\",\r\n            \"name\": \"Default IP filter policy should be deny\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_IPFilter_PermissiveRule\",\r\n            \"name\": \"IP filter rule includes a large IP range\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_OpenPorts\",\r\n            \"name\": \"Device has open ports\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveFirewallPolicy\",\r\n            \"name\": \"Permissive firewall policy in one of the chains\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveInputFirewallRules\",\r\n            \"name\": \"Permissive firewall rule in the input chain\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveOutputFirewallRules\",\r\n            \"name\": \"Permissive firewall rule in the output chain\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PrivilegedDockerOptions\",\r\n            \"name\": \"High level permissions configured in IoT Edge model twin for IoT Edge module\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_RecommendedIpRulesByBaseLine\",\r\n            \"name\": \"Recommended Rules for ip filter\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_SharedCredentials\",\r\n            \"name\": \"Same authentication credentials used by multiple devices\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_VulnerableTLSCipherSuite\",\r\n            \"name\": \"TLS cipher suite upgrade needed\",\r\n            \"status\": \"Enabled\"\r\n          }\r\n        ],\r\n        \"autoDiscoveredResources\": [],\r\n        \"unmaskedIpLoggingStatus\": \"Enabled\"\r\n      },\r\n      \"tags\": {}\r\n    },\r\n    {\r\n      \"id\": \"/subscriptions/075423e9-7d33-4166-8bdf-3920b04e3735/resourceGroups/michalresourcegroup/providers/Microsoft.Security/IoTSecuritySolutions/michalnewtest8\",\r\n      \"name\": \"michalnewtest8\",\r\n      \"type\": \"Microsoft.Security/IoTSecuritySolutions\",\r\n      \"location\": \"West US\",\r\n      \"properties\": {\r\n        \"displayName\": \"MichalNewTest8\",\r\n        \"status\": \"Enabled\",\r\n        \"export\": [\r\n          \"RawEvents\"\r\n        ],\r\n        \"disabledDataSources\": [],\r\n        \"workspace\": \"/subscriptions/075423e9-7d33-4166-8bdf-3920b04e3735/resourcegroups/michalresourcegroup/providers/microsoft.operationalinsights/workspaces/iothubworkspace-westus\",\r\n        \"additionalWorkspaces\": null,\r\n        \"iotHubs\": [],\r\n        \"userDefinedResources\": {\r\n          \"query\": \"where type != \\\"microsoft.devices/iothubs\\\" | where (subscriptionId == \\\"075423e9-7d33-4166-8bdf-3920b04e3735\\\" and resourceGroup in~ (\\\"michalresourcegroup\\\")) | project id, name, type\",\r\n          \"querySubscriptions\": [\r\n            \"075423e9-7d33-4166-8bdf-3920b04e3735\"\r\n          ]\r\n        },\r\n        \"recommendationsConfiguration\": [\r\n          {\r\n            \"recommendationType\": \"IoT_ACRAuthentication\",\r\n            \"name\": \"Service prinicpal not used with ACR repository\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_AgentSendsUnutilizedMessages\",\r\n            \"name\": \"Agent sending underutilized messages\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_Baseline\",\r\n            \"name\": \"Operating system (OS) baseline validation failure\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_EdgeHubMemOptimize\",\r\n            \"name\": \"IoT Edge Hub memory can be optimized\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_EdgeLoggingOptions\",\r\n            \"name\": \"No logging configured for IoT Edge module\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_InconsistentModuleSettings\",\r\n            \"name\": \"SecurityGroup has inconsistent module settings\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_InstallAgent\",\r\n            \"name\": \"Install the Azure IoT Security agent\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_IPFilter_DenyAll\",\r\n            \"name\": \"Default IP filter policy should be deny\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_IPFilter_PermissiveRule\",\r\n            \"name\": \"IP filter rule includes a large IP range\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_OpenPorts\",\r\n            \"name\": \"Device has open ports\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveFirewallPolicy\",\r\n            \"name\": \"Permissive firewall policy in one of the chains\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveInputFirewallRules\",\r\n            \"name\": \"Permissive firewall rule in the input chain\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveOutputFirewallRules\",\r\n            \"name\": \"Permissive firewall rule in the output chain\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PrivilegedDockerOptions\",\r\n            \"name\": \"High level permissions configured in IoT Edge model twin for IoT Edge module\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_RecommendedIpRulesByBaseLine\",\r\n            \"name\": \"Recommended Rules for ip filter\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_SharedCredentials\",\r\n            \"name\": \"Same authentication credentials used by multiple devices\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_VulnerableTLSCipherSuite\",\r\n            \"name\": \"TLS cipher suite upgrade needed\",\r\n            \"status\": \"Enabled\"\r\n          }\r\n        ],\r\n        \"autoDiscoveredResources\": [],\r\n        \"unmaskedIpLoggingStatus\": \"Enabled\"\r\n      },\r\n      \"tags\": {}\r\n    },\r\n    {\r\n      \"id\": \"/subscriptions/075423e9-7d33-4166-8bdf-3920b04e3735/resourceGroups/michalresourcegroup/providers/Microsoft.Security/IoTSecuritySolutions/michalnewtest10\",\r\n      \"name\": \"michalnewtest10\",\r\n      \"type\": \"Microsoft.Security/IoTSecuritySolutions\",\r\n      \"location\": \"West US\",\r\n      \"properties\": {\r\n        \"displayName\": \"MichalNewTest10\",\r\n        \"status\": \"Enabled\",\r\n        \"export\": [\r\n          \"RawEvents\"\r\n        ],\r\n        \"disabledDataSources\": [],\r\n        \"workspace\": \"/subscriptions/075423e9-7d33-4166-8bdf-3920b04e3735/resourcegroups/michalresourcegroup/providers/microsoft.operationalinsights/workspaces/iothubworkspace-westus\",\r\n        \"additionalWorkspaces\": null,\r\n        \"iotHubs\": [],\r\n        \"userDefinedResources\": {\r\n          \"query\": \"where type != \\\"microsoft.devices/iothubs\\\" | where (subscriptionId == \\\"075423e9-7d33-4166-8bdf-3920b04e3735\\\" and resourceGroup in~ (\\\"michalresourcegroup\\\")) | project id, name, type\",\r\n          \"querySubscriptions\": [\r\n            \"075423e9-7d33-4166-8bdf-3920b04e3735\"\r\n          ]\r\n        },\r\n        \"recommendationsConfiguration\": [\r\n          {\r\n            \"recommendationType\": \"IoT_ACRAuthentication\",\r\n            \"name\": \"Service prinicpal not used with ACR repository\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_AgentSendsUnutilizedMessages\",\r\n            \"name\": \"Agent sending underutilized messages\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_Baseline\",\r\n            \"name\": \"Operating system (OS) baseline validation failure\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_EdgeHubMemOptimize\",\r\n            \"name\": \"IoT Edge Hub memory can be optimized\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_EdgeLoggingOptions\",\r\n            \"name\": \"No logging configured for IoT Edge module\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_InconsistentModuleSettings\",\r\n            \"name\": \"SecurityGroup has inconsistent module settings\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_InstallAgent\",\r\n            \"name\": \"Install the Azure IoT Security agent\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_IPFilter_DenyAll\",\r\n            \"name\": \"Default IP filter policy should be deny\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_IPFilter_PermissiveRule\",\r\n            \"name\": \"IP filter rule includes a large IP range\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_OpenPorts\",\r\n            \"name\": \"Device has open ports\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveFirewallPolicy\",\r\n            \"name\": \"Permissive firewall policy in one of the chains\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveInputFirewallRules\",\r\n            \"name\": \"Permissive firewall rule in the input chain\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveOutputFirewallRules\",\r\n            \"name\": \"Permissive firewall rule in the output chain\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PrivilegedDockerOptions\",\r\n            \"name\": \"High level permissions configured in IoT Edge model twin for IoT Edge module\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_RecommendedIpRulesByBaseLine\",\r\n            \"name\": \"Recommended Rules for ip filter\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_SharedCredentials\",\r\n            \"name\": \"Same authentication credentials used by multiple devices\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_VulnerableTLSCipherSuite\",\r\n            \"name\": \"TLS cipher suite upgrade needed\",\r\n            \"status\": \"Enabled\"\r\n          }\r\n        ],\r\n        \"autoDiscoveredResources\": [],\r\n        \"unmaskedIpLoggingStatus\": \"Enabled\"\r\n      },\r\n      \"tags\": {}\r\n    },\r\n    {\r\n      \"id\": \"/subscriptions/075423e9-7d33-4166-8bdf-3920b04e3735/resourceGroups/michalresourcegroup/providers/Microsoft.Security/IoTSecuritySolutions/michalnewtest11\",\r\n      \"name\": \"michalnewtest11\",\r\n      \"type\": \"Microsoft.Security/IoTSecuritySolutions\",\r\n      \"location\": \"West US\",\r\n      \"properties\": {\r\n        \"displayName\": \"MichalNewTest11\",\r\n        \"status\": \"Enabled\",\r\n        \"export\": [\r\n          \"RawEvents\"\r\n        ],\r\n        \"disabledDataSources\": [],\r\n        \"workspace\": \"/subscriptions/075423e9-7d33-4166-8bdf-3920b04e3735/resourcegroups/michalresourcegroup/providers/microsoft.operationalinsights/workspaces/iothubworkspace-westus\",\r\n        \"additionalWorkspaces\": null,\r\n        \"iotHubs\": [],\r\n        \"userDefinedResources\": {\r\n          \"query\": \"where type != \\\"microsoft.devices/iothubs\\\" | where (subscriptionId == \\\"075423e9-7d33-4166-8bdf-3920b04e3735\\\" and resourceGroup in~ (\\\"michalresourcegroup\\\")) | project id, name, type\",\r\n          \"querySubscriptions\": [\r\n            \"075423e9-7d33-4166-8bdf-3920b04e3735\"\r\n          ]\r\n        },\r\n        \"recommendationsConfiguration\": [\r\n          {\r\n            \"recommendationType\": \"IoT_ACRAuthentication\",\r\n            \"name\": \"Service prinicpal not used with ACR repository\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_AgentSendsUnutilizedMessages\",\r\n            \"name\": \"Agent sending underutilized messages\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_Baseline\",\r\n            \"name\": \"Operating system (OS) baseline validation failure\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_EdgeHubMemOptimize\",\r\n            \"name\": \"IoT Edge Hub memory can be optimized\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_EdgeLoggingOptions\",\r\n            \"name\": \"No logging configured for IoT Edge module\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_InconsistentModuleSettings\",\r\n            \"name\": \"SecurityGroup has inconsistent module settings\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_InstallAgent\",\r\n            \"name\": \"Install the Azure IoT Security agent\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_IPFilter_DenyAll\",\r\n            \"name\": \"Default IP filter policy should be deny\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_IPFilter_PermissiveRule\",\r\n            \"name\": \"IP filter rule includes a large IP range\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_OpenPorts\",\r\n            \"name\": \"Device has open ports\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveFirewallPolicy\",\r\n            \"name\": \"Permissive firewall policy in one of the chains\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveInputFirewallRules\",\r\n            \"name\": \"Permissive firewall rule in the input chain\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveOutputFirewallRules\",\r\n            \"name\": \"Permissive firewall rule in the output chain\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PrivilegedDockerOptions\",\r\n            \"name\": \"High level permissions configured in IoT Edge model twin for IoT Edge module\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_RecommendedIpRulesByBaseLine\",\r\n            \"name\": \"Recommended Rules for ip filter\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_SharedCredentials\",\r\n            \"name\": \"Same authentication credentials used by multiple devices\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_VulnerableTLSCipherSuite\",\r\n            \"name\": \"TLS cipher suite upgrade needed\",\r\n            \"status\": \"Enabled\"\r\n          }\r\n        ],\r\n        \"autoDiscoveredResources\": [],\r\n        \"unmaskedIpLoggingStatus\": \"Enabled\"\r\n      },\r\n      \"tags\": {}\r\n    },\r\n    {\r\n      \"id\": \"/subscriptions/075423e9-7d33-4166-8bdf-3920b04e3735/resourceGroups/michalresourcegroup/providers/Microsoft.Security/IoTSecuritySolutions/michalnewtest13\",\r\n      \"name\": \"michalnewtest13\",\r\n      \"type\": \"Microsoft.Security/IoTSecuritySolutions\",\r\n      \"location\": \"Japan East\",\r\n      \"properties\": {\r\n        \"displayName\": \"MichalNewTest13\",\r\n        \"status\": \"Enabled\",\r\n        \"export\": [\r\n          \"RawEvents\"\r\n        ],\r\n        \"disabledDataSources\": [],\r\n        \"workspace\": \"/subscriptions/075423e9-7d33-4166-8bdf-3920b04e3735/resourcegroups/michalresourcegroup/providers/microsoft.operationalinsights/workspaces/iothubworkspace-japaneast-1575466749138\",\r\n        \"additionalWorkspaces\": null,\r\n        \"iotHubs\": [],\r\n        \"userDefinedResources\": {\r\n          \"query\": \"where type != \\\"microsoft.devices/iothubs\\\" | where (subscriptionId == \\\"075423e9-7d33-4166-8bdf-3920b04e3735\\\" and resourceGroup in~ (\\\"michalresourcegroup\\\")) | project id, name, type\",\r\n          \"querySubscriptions\": [\r\n            \"075423e9-7d33-4166-8bdf-3920b04e3735\"\r\n          ]\r\n        },\r\n        \"recommendationsConfiguration\": [\r\n          {\r\n            \"recommendationType\": \"IoT_ACRAuthentication\",\r\n            \"name\": \"Service prinicpal not used with ACR repository\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_AgentSendsUnutilizedMessages\",\r\n            \"name\": \"Agent sending underutilized messages\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_Baseline\",\r\n            \"name\": \"Operating system (OS) baseline validation failure\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_EdgeHubMemOptimize\",\r\n            \"name\": \"IoT Edge Hub memory can be optimized\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_EdgeLoggingOptions\",\r\n            \"name\": \"No logging configured for IoT Edge module\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_InconsistentModuleSettings\",\r\n            \"name\": \"SecurityGroup has inconsistent module settings\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_InstallAgent\",\r\n            \"name\": \"Install the Azure IoT Security agent\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_IPFilter_DenyAll\",\r\n            \"name\": \"Default IP filter policy should be deny\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_IPFilter_PermissiveRule\",\r\n            \"name\": \"IP filter rule includes a large IP range\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_OpenPorts\",\r\n            \"name\": \"Device has open ports\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveFirewallPolicy\",\r\n            \"name\": \"Permissive firewall policy in one of the chains\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveInputFirewallRules\",\r\n            \"name\": \"Permissive firewall rule in the input chain\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveOutputFirewallRules\",\r\n            \"name\": \"Permissive firewall rule in the output chain\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PrivilegedDockerOptions\",\r\n            \"name\": \"High level permissions configured in IoT Edge model twin for IoT Edge module\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_RecommendedIpRulesByBaseLine\",\r\n            \"name\": \"Recommended Rules for ip filter\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_SharedCredentials\",\r\n            \"name\": \"Same authentication credentials used by multiple devices\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_VulnerableTLSCipherSuite\",\r\n            \"name\": \"TLS cipher suite upgrade needed\",\r\n            \"status\": \"Enabled\"\r\n          }\r\n        ],\r\n        \"autoDiscoveredResources\": [],\r\n        \"unmaskedIpLoggingStatus\": \"Enabled\"\r\n      },\r\n      \"tags\": {}\r\n    },\r\n    {\r\n      \"id\": \"/subscriptions/075423e9-7d33-4166-8bdf-3920b04e3735/resourceGroups/michalresourcegroup/providers/Microsoft.Security/IoTSecuritySolutions/michalnewtest14\",\r\n      \"name\": \"michalnewtest14\",\r\n      \"type\": \"Microsoft.Security/IoTSecuritySolutions\",\r\n      \"location\": \"Central India\",\r\n      \"properties\": {\r\n        \"displayName\": \"MichalNewTest14\",\r\n        \"status\": \"Enabled\",\r\n        \"export\": [\r\n          \"RawEvents\"\r\n        ],\r\n        \"disabledDataSources\": [],\r\n        \"workspace\": \"/subscriptions/075423e9-7d33-4166-8bdf-3920b04e3735/resourcegroups/michalresourcegroup/providers/microsoft.operationalinsights/workspaces/iothubworkspace-centralindia-1575467182276\",\r\n        \"additionalWorkspaces\": null,\r\n        \"iotHubs\": [],\r\n        \"userDefinedResources\": {\r\n          \"query\": \"where type != \\\"microsoft.devices/iothubs\\\" | where (subscriptionId == \\\"075423e9-7d33-4166-8bdf-3920b04e3735\\\" and resourceGroup in~ (\\\"michalresourcegroup\\\")) | project id, name, type\",\r\n          \"querySubscriptions\": [\r\n            \"075423e9-7d33-4166-8bdf-3920b04e3735\"\r\n          ]\r\n        },\r\n        \"recommendationsConfiguration\": [\r\n          {\r\n            \"recommendationType\": \"IoT_ACRAuthentication\",\r\n            \"name\": \"Service prinicpal not used with ACR repository\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_AgentSendsUnutilizedMessages\",\r\n            \"name\": \"Agent sending underutilized messages\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_Baseline\",\r\n            \"name\": \"Operating system (OS) baseline validation failure\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_EdgeHubMemOptimize\",\r\n            \"name\": \"IoT Edge Hub memory can be optimized\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_EdgeLoggingOptions\",\r\n            \"name\": \"No logging configured for IoT Edge module\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_InconsistentModuleSettings\",\r\n            \"name\": \"SecurityGroup has inconsistent module settings\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_InstallAgent\",\r\n            \"name\": \"Install the Azure IoT Security agent\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_IPFilter_DenyAll\",\r\n            \"name\": \"Default IP filter policy should be deny\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_IPFilter_PermissiveRule\",\r\n            \"name\": \"IP filter rule includes a large IP range\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_OpenPorts\",\r\n            \"name\": \"Device has open ports\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveFirewallPolicy\",\r\n            \"name\": \"Permissive firewall policy in one of the chains\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveInputFirewallRules\",\r\n            \"name\": \"Permissive firewall rule in the input chain\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveOutputFirewallRules\",\r\n            \"name\": \"Permissive firewall rule in the output chain\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PrivilegedDockerOptions\",\r\n            \"name\": \"High level permissions configured in IoT Edge model twin for IoT Edge module\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_RecommendedIpRulesByBaseLine\",\r\n            \"name\": \"Recommended Rules for ip filter\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_SharedCredentials\",\r\n            \"name\": \"Same authentication credentials used by multiple devices\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_VulnerableTLSCipherSuite\",\r\n            \"name\": \"TLS cipher suite upgrade needed\",\r\n            \"status\": \"Enabled\"\r\n          }\r\n        ],\r\n        \"autoDiscoveredResources\": [],\r\n        \"unmaskedIpLoggingStatus\": \"Enabled\"\r\n      },\r\n      \"tags\": {}\r\n    },\r\n    {\r\n      \"id\": \"/subscriptions/075423e9-7d33-4166-8bdf-3920b04e3735/resourceGroups/michalresourcegroup/providers/Microsoft.Security/IoTSecuritySolutions/michalbugfixhub\",\r\n      \"name\": \"michalbugfixhub\",\r\n      \"type\": \"Microsoft.Security/IoTSecuritySolutions\",\r\n      \"location\": \"West US\",\r\n      \"properties\": {\r\n        \"displayName\": \"MichalBugFixHub\",\r\n        \"status\": \"Enabled\",\r\n        \"export\": [\r\n          \"RawEvents\"\r\n        ],\r\n        \"disabledDataSources\": [],\r\n        \"workspace\": \"/subscriptions/075423e9-7d33-4166-8bdf-3920b04e3735/resourcegroups/michalresourcegroup/providers/microsoft.operationalinsights/workspaces/iothubworkspace-westus\",\r\n        \"additionalWorkspaces\": null,\r\n        \"iotHubs\": [],\r\n        \"userDefinedResources\": {\r\n          \"query\": \"where type != \\\"microsoft.devices/iothubs\\\" | where (subscriptionId == \\\"075423e9-7d33-4166-8bdf-3920b04e3735\\\" and resourceGroup in~ (\\\"michalresourcegroup\\\")) | project id, name, type\",\r\n          \"querySubscriptions\": [\r\n            \"075423e9-7d33-4166-8bdf-3920b04e3735\"\r\n          ]\r\n        },\r\n        \"recommendationsConfiguration\": [\r\n          {\r\n            \"recommendationType\": \"IoT_ACRAuthentication\",\r\n            \"name\": \"Service prinicpal not used with ACR repository\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_AgentSendsUnutilizedMessages\",\r\n            \"name\": \"Agent sending underutilized messages\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_Baseline\",\r\n            \"name\": \"Operating system (OS) baseline validation failure\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_EdgeHubMemOptimize\",\r\n            \"name\": \"IoT Edge Hub memory can be optimized\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_EdgeLoggingOptions\",\r\n            \"name\": \"No logging configured for IoT Edge module\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_InconsistentModuleSettings\",\r\n            \"name\": \"SecurityGroup has inconsistent module settings\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_InstallAgent\",\r\n            \"name\": \"Install the Azure IoT Security agent\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_IPFilter_DenyAll\",\r\n            \"name\": \"Default IP filter policy should be deny\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_IPFilter_PermissiveRule\",\r\n            \"name\": \"IP filter rule includes a large IP range\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_OpenPorts\",\r\n            \"name\": \"Device has open ports\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveFirewallPolicy\",\r\n            \"name\": \"Permissive firewall policy in one of the chains\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveInputFirewallRules\",\r\n            \"name\": \"Permissive firewall rule in the input chain\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveOutputFirewallRules\",\r\n            \"name\": \"Permissive firewall rule in the output chain\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PrivilegedDockerOptions\",\r\n            \"name\": \"High level permissions configured in IoT Edge model twin for IoT Edge module\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_RecommendedIpRulesByBaseLine\",\r\n            \"name\": \"Recommended Rules for ip filter\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_SharedCredentials\",\r\n            \"name\": \"Same authentication credentials used by multiple devices\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_VulnerableTLSCipherSuite\",\r\n            \"name\": \"TLS cipher suite upgrade needed\",\r\n            \"status\": \"Enabled\"\r\n          }\r\n        ],\r\n        \"autoDiscoveredResources\": [],\r\n        \"unmaskedIpLoggingStatus\": \"Enabled\"\r\n      },\r\n      \"tags\": {}\r\n    },\r\n    {\r\n      \"id\": \"/subscriptions/075423e9-7d33-4166-8bdf-3920b04e3735/resourceGroups/michalresourcegroup/providers/Microsoft.Security/IoTSecuritySolutions/michalbugfixhub1\",\r\n      \"name\": \"michalbugfixhub1\",\r\n      \"type\": \"Microsoft.Security/IoTSecuritySolutions\",\r\n      \"location\": \"Japan West\",\r\n      \"properties\": {\r\n        \"displayName\": \"MichalBugFixHub1\",\r\n        \"status\": \"Enabled\",\r\n        \"export\": [\r\n          \"RawEvents\"\r\n        ],\r\n        \"disabledDataSources\": [],\r\n        \"workspace\": \"/subscriptions/075423e9-7d33-4166-8bdf-3920b04e3735/resourcegroups/galm-iot-hub/providers/microsoft.operationalinsights/workspaces/iothubworkspace-westeurope\",\r\n        \"additionalWorkspaces\": null,\r\n        \"iotHubs\": [],\r\n        \"userDefinedResources\": {\r\n          \"query\": \"where type != \\\"microsoft.devices/iothubs\\\" | where (subscriptionId == \\\"075423e9-7d33-4166-8bdf-3920b04e3735\\\" and resourceGroup in~ (\\\"michalresourcegroup\\\")) | project id, name, type\",\r\n          \"querySubscriptions\": [\r\n            \"075423e9-7d33-4166-8bdf-3920b04e3735\"\r\n          ]\r\n        },\r\n        \"recommendationsConfiguration\": [\r\n          {\r\n            \"recommendationType\": \"IoT_ACRAuthentication\",\r\n            \"name\": \"Service prinicpal not used with ACR repository\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_AgentSendsUnutilizedMessages\",\r\n            \"name\": \"Agent sending underutilized messages\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_Baseline\",\r\n            \"name\": \"Operating system (OS) baseline validation failure\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_EdgeHubMemOptimize\",\r\n            \"name\": \"IoT Edge Hub memory can be optimized\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_EdgeLoggingOptions\",\r\n            \"name\": \"No logging configured for IoT Edge module\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_InconsistentModuleSettings\",\r\n            \"name\": \"SecurityGroup has inconsistent module settings\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_InstallAgent\",\r\n            \"name\": \"Install the Azure IoT Security agent\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_IPFilter_DenyAll\",\r\n            \"name\": \"Default IP filter policy should be deny\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_IPFilter_PermissiveRule\",\r\n            \"name\": \"IP filter rule includes a large IP range\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_OpenPorts\",\r\n            \"name\": \"Device has open ports\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveFirewallPolicy\",\r\n            \"name\": \"Permissive firewall policy in one of the chains\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveInputFirewallRules\",\r\n            \"name\": \"Permissive firewall rule in the input chain\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveOutputFirewallRules\",\r\n            \"name\": \"Permissive firewall rule in the output chain\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PrivilegedDockerOptions\",\r\n            \"name\": \"High level permissions configured in IoT Edge model twin for IoT Edge module\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_RecommendedIpRulesByBaseLine\",\r\n            \"name\": \"Recommended Rules for ip filter\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_SharedCredentials\",\r\n            \"name\": \"Same authentication credentials used by multiple devices\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_VulnerableTLSCipherSuite\",\r\n            \"name\": \"TLS cipher suite upgrade needed\",\r\n            \"status\": \"Enabled\"\r\n          }\r\n        ],\r\n        \"autoDiscoveredResources\": [],\r\n        \"unmaskedIpLoggingStatus\": \"Enabled\"\r\n      },\r\n      \"tags\": {}\r\n    },\r\n    {\r\n      \"id\": \"/subscriptions/075423e9-7d33-4166-8bdf-3920b04e3735/resourceGroups/michalresourcegroup/providers/Microsoft.Security/IoTSecuritySolutions/michalnewtest21\",\r\n      \"name\": \"michalnewtest21\",\r\n      \"type\": \"Microsoft.Security/IoTSecuritySolutions\",\r\n      \"location\": \"Brazil South\",\r\n      \"properties\": {\r\n        \"displayName\": \"MichalNewTest21\",\r\n        \"status\": \"Enabled\",\r\n        \"export\": [\r\n          \"RawEvents\"\r\n        ],\r\n        \"disabledDataSources\": [],\r\n        \"workspace\": \"/subscriptions/075423e9-7d33-4166-8bdf-3920b04e3735/resourcegroups/galm-iot-hub/providers/microsoft.operationalinsights/workspaces/iothubworkspace-westeurope\",\r\n        \"additionalWorkspaces\": null,\r\n        \"iotHubs\": [],\r\n        \"userDefinedResources\": {\r\n          \"query\": \"where type != \\\"microsoft.devices/iothubs\\\" | where (subscriptionId == \\\"075423e9-7d33-4166-8bdf-3920b04e3735\\\" and resourceGroup in~ (\\\"michalresourcegroup\\\")) | project id, name, type\",\r\n          \"querySubscriptions\": [\r\n            \"075423e9-7d33-4166-8bdf-3920b04e3735\"\r\n          ]\r\n        },\r\n        \"recommendationsConfiguration\": [\r\n          {\r\n            \"recommendationType\": \"IoT_ACRAuthentication\",\r\n            \"name\": \"Service prinicpal not used with ACR repository\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_AgentSendsUnutilizedMessages\",\r\n            \"name\": \"Agent sending underutilized messages\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_Baseline\",\r\n            \"name\": \"Operating system (OS) baseline validation failure\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_EdgeHubMemOptimize\",\r\n            \"name\": \"IoT Edge Hub memory can be optimized\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_EdgeLoggingOptions\",\r\n            \"name\": \"No logging configured for IoT Edge module\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_InconsistentModuleSettings\",\r\n            \"name\": \"SecurityGroup has inconsistent module settings\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_InstallAgent\",\r\n            \"name\": \"Install the Azure IoT Security agent\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_IPFilter_DenyAll\",\r\n            \"name\": \"Default IP filter policy should be deny\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_IPFilter_PermissiveRule\",\r\n            \"name\": \"IP filter rule includes a large IP range\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_OpenPorts\",\r\n            \"name\": \"Device has open ports\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveFirewallPolicy\",\r\n            \"name\": \"Permissive firewall policy in one of the chains\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveInputFirewallRules\",\r\n            \"name\": \"Permissive firewall rule in the input chain\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveOutputFirewallRules\",\r\n            \"name\": \"Permissive firewall rule in the output chain\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PrivilegedDockerOptions\",\r\n            \"name\": \"High level permissions configured in IoT Edge model twin for IoT Edge module\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_RecommendedIpRulesByBaseLine\",\r\n            \"name\": \"Recommended Rules for ip filter\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_SharedCredentials\",\r\n            \"name\": \"Same authentication credentials used by multiple devices\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_VulnerableTLSCipherSuite\",\r\n            \"name\": \"TLS cipher suite upgrade needed\",\r\n            \"status\": \"Enabled\"\r\n          }\r\n        ],\r\n        \"autoDiscoveredResources\": [],\r\n        \"unmaskedIpLoggingStatus\": \"Enabled\"\r\n      },\r\n      \"tags\": {}\r\n    },\r\n    {\r\n      \"id\": \"/subscriptions/075423e9-7d33-4166-8bdf-3920b04e3735/resourceGroups/michalresourcegroup/providers/Microsoft.Security/IoTSecuritySolutions/michalnewtest22\",\r\n      \"name\": \"michalnewtest22\",\r\n      \"type\": \"Microsoft.Security/IoTSecuritySolutions\",\r\n      \"location\": \"canadaeast\",\r\n      \"properties\": {\r\n        \"displayName\": \"MichalNewTest22\",\r\n        \"status\": \"Enabled\",\r\n        \"export\": [\r\n          \"RawEvents\"\r\n        ],\r\n        \"disabledDataSources\": [],\r\n        \"workspace\": \"/subscriptions/075423e9-7d33-4166-8bdf-3920b04e3735/resourcegroups/galm-iot-hub/providers/microsoft.operationalinsights/workspaces/iothubworkspace-westeurope\",\r\n        \"additionalWorkspaces\": null,\r\n        \"iotHubs\": [],\r\n        \"userDefinedResources\": {\r\n          \"query\": \"where type != \\\"microsoft.devices/iothubs\\\" | where (subscriptionId == \\\"075423e9-7d33-4166-8bdf-3920b04e3735\\\" and resourceGroup in~ (\\\"michalresourcegroup\\\")) | project id, name, type\",\r\n          \"querySubscriptions\": [\r\n            \"075423e9-7d33-4166-8bdf-3920b04e3735\"\r\n          ]\r\n        },\r\n        \"recommendationsConfiguration\": [\r\n          {\r\n            \"recommendationType\": \"IoT_ACRAuthentication\",\r\n            \"name\": \"Service prinicpal not used with ACR repository\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_AgentSendsUnutilizedMessages\",\r\n            \"name\": \"Agent sending underutilized messages\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_Baseline\",\r\n            \"name\": \"Operating system (OS) baseline validation failure\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_EdgeHubMemOptimize\",\r\n            \"name\": \"IoT Edge Hub memory can be optimized\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_EdgeLoggingOptions\",\r\n            \"name\": \"No logging configured for IoT Edge module\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_InconsistentModuleSettings\",\r\n            \"name\": \"SecurityGroup has inconsistent module settings\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_InstallAgent\",\r\n            \"name\": \"Install the Azure IoT Security agent\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_IPFilter_DenyAll\",\r\n            \"name\": \"Default IP filter policy should be deny\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_IPFilter_PermissiveRule\",\r\n            \"name\": \"IP filter rule includes a large IP range\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_OpenPorts\",\r\n            \"name\": \"Device has open ports\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveFirewallPolicy\",\r\n            \"name\": \"Permissive firewall policy in one of the chains\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveInputFirewallRules\",\r\n            \"name\": \"Permissive firewall rule in the input chain\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveOutputFirewallRules\",\r\n            \"name\": \"Permissive firewall rule in the output chain\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PrivilegedDockerOptions\",\r\n            \"name\": \"High level permissions configured in IoT Edge model twin for IoT Edge module\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_RecommendedIpRulesByBaseLine\",\r\n            \"name\": \"Recommended Rules for ip filter\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_SharedCredentials\",\r\n            \"name\": \"Same authentication credentials used by multiple devices\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_VulnerableTLSCipherSuite\",\r\n            \"name\": \"TLS cipher suite upgrade needed\",\r\n            \"status\": \"Enabled\"\r\n          }\r\n        ],\r\n        \"autoDiscoveredResources\": [],\r\n        \"unmaskedIpLoggingStatus\": \"Enabled\"\r\n      },\r\n      \"tags\": {}\r\n    },\r\n    {\r\n      \"id\": \"/subscriptions/075423e9-7d33-4166-8bdf-3920b04e3735/resourceGroups/michalresourcegroup/providers/Microsoft.Security/IoTSecuritySolutions/michalhubtset100\",\r\n      \"name\": \"michalhubtset100\",\r\n      \"type\": \"Microsoft.Security/IoTSecuritySolutions\",\r\n      \"location\": \"West US\",\r\n      \"properties\": {\r\n        \"displayName\": \"MichalHubTset100\",\r\n        \"status\": \"Enabled\",\r\n        \"export\": [\r\n          \"RawEvents\"\r\n        ],\r\n        \"disabledDataSources\": [],\r\n        \"workspace\": \"/subscriptions/075423e9-7d33-4166-8bdf-3920b04e3735/resourcegroups/michalresourcegroup/providers/microsoft.operationalinsights/workspaces/michalhubworkspace\",\r\n        \"additionalWorkspaces\": null,\r\n        \"iotHubs\": [],\r\n        \"userDefinedResources\": {\r\n          \"query\": null,\r\n          \"querySubscriptions\": null\r\n        },\r\n        \"recommendationsConfiguration\": [\r\n          {\r\n            \"recommendationType\": \"IoT_ACRAuthentication\",\r\n            \"name\": \"Service prinicpal not used with ACR repository\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_AgentSendsUnutilizedMessages\",\r\n            \"name\": \"Agent sending underutilized messages\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_Baseline\",\r\n            \"name\": \"Operating system (OS) baseline validation failure\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_EdgeHubMemOptimize\",\r\n            \"name\": \"IoT Edge Hub memory can be optimized\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_EdgeLoggingOptions\",\r\n            \"name\": \"No logging configured for IoT Edge module\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_InconsistentModuleSettings\",\r\n            \"name\": \"SecurityGroup has inconsistent module settings\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_InstallAgent\",\r\n            \"name\": \"Install the Azure IoT Security agent\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_IPFilter_DenyAll\",\r\n            \"name\": \"Default IP filter policy should be deny\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_IPFilter_PermissiveRule\",\r\n            \"name\": \"IP filter rule includes a large IP range\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_OpenPorts\",\r\n            \"name\": \"Device has open ports\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveFirewallPolicy\",\r\n            \"name\": \"Permissive firewall policy in one of the chains\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveInputFirewallRules\",\r\n            \"name\": \"Permissive firewall rule in the input chain\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveOutputFirewallRules\",\r\n            \"name\": \"Permissive firewall rule in the output chain\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PrivilegedDockerOptions\",\r\n            \"name\": \"High level permissions configured in IoT Edge model twin for IoT Edge module\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_RecommendedIpRulesByBaseLine\",\r\n            \"name\": \"Recommended Rules for ip filter\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_SharedCredentials\",\r\n            \"name\": \"Same authentication credentials used by multiple devices\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_VulnerableTLSCipherSuite\",\r\n            \"name\": \"TLS cipher suite upgrade needed\",\r\n            \"status\": \"Enabled\"\r\n          }\r\n        ],\r\n        \"autoDiscoveredResources\": [],\r\n        \"unmaskedIpLoggingStatus\": \"Enabled\"\r\n      },\r\n      \"tags\": {}\r\n    },\r\n    {\r\n      \"id\": \"/subscriptions/075423e9-7d33-4166-8bdf-3920b04e3735/resourceGroups/michalresourcegroup/providers/Microsoft.Security/IoTSecuritySolutions/michalalertrectest\",\r\n      \"name\": \"michalalertrectest\",\r\n      \"type\": \"Microsoft.Security/IoTSecuritySolutions\",\r\n      \"location\": \"East US\",\r\n      \"properties\": {\r\n        \"displayName\": \"MichalAlertRecTest\",\r\n        \"status\": \"Enabled\",\r\n        \"export\": [\r\n          \"RawEvents\"\r\n        ],\r\n        \"disabledDataSources\": [],\r\n        \"workspace\": \"/subscriptions/075423e9-7d33-4166-8bdf-3920b04e3735/resourcegroups/michalresourcegroup/providers/microsoft.operationalinsights/workspaces/michalalertrectest\",\r\n        \"additionalWorkspaces\": null,\r\n        \"iotHubs\": [\r\n          \"/subscriptions/075423e9-7d33-4166-8bdf-3920b04e3735/resourcegroups/michalresourcegroup/providers/microsoft.devices/iothubs/michalalertrectest\"\r\n        ],\r\n        \"userDefinedResources\": {\r\n          \"query\": \"where type != \\\"microsoft.devices/iothubs\\\" | where (subscriptionId == \\\"075423e9-7d33-4166-8bdf-3920b04e3735\\\" and resourceGroup in~ (\\\"MichalResourceGroup\\\")) | project id, name, type\",\r\n          \"querySubscriptions\": [\r\n            \"075423e9-7d33-4166-8bdf-3920b04e3735\"\r\n          ]\r\n        },\r\n        \"recommendationsConfiguration\": [\r\n          {\r\n            \"recommendationType\": \"IoT_ACRAuthentication\",\r\n            \"name\": \"Service prinicpal not used with ACR repository\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_AgentSendsUnutilizedMessages\",\r\n            \"name\": \"Agent sending underutilized messages\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_Baseline\",\r\n            \"name\": \"Operating system (OS) baseline validation failure\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_EdgeHubMemOptimize\",\r\n            \"name\": \"IoT Edge Hub memory can be optimized\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_EdgeLoggingOptions\",\r\n            \"name\": \"No logging configured for IoT Edge module\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_InconsistentModuleSettings\",\r\n            \"name\": \"SecurityGroup has inconsistent module settings\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_InstallAgent\",\r\n            \"name\": \"Install the Azure IoT Security agent\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_IPFilter_DenyAll\",\r\n            \"name\": \"Default IP filter policy should be deny\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_IPFilter_PermissiveRule\",\r\n            \"name\": \"IP filter rule includes a large IP range\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_OpenPorts\",\r\n            \"name\": \"Device has open ports\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveFirewallPolicy\",\r\n            \"name\": \"Permissive firewall policy in one of the chains\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveInputFirewallRules\",\r\n            \"name\": \"Permissive firewall rule in the input chain\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveOutputFirewallRules\",\r\n            \"name\": \"Permissive firewall rule in the output chain\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PrivilegedDockerOptions\",\r\n            \"name\": \"High level permissions configured in IoT Edge model twin for IoT Edge module\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_RecommendedIpRulesByBaseLine\",\r\n            \"name\": \"Recommended Rules for ip filter\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_SharedCredentials\",\r\n            \"name\": \"Same authentication credentials used by multiple devices\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_VulnerableTLSCipherSuite\",\r\n            \"name\": \"TLS cipher suite upgrade needed\",\r\n            \"status\": \"Enabled\"\r\n          }\r\n        ],\r\n        \"autoDiscoveredResources\": [\r\n          \"/subscriptions/075423e9-7d33-4166-8bdf-3920b04e3735/resourcegroups/michalresourcegroup/providers/microsoft.devices/iothubs/michalalertrectest\"\r\n        ],\r\n        \"unmaskedIpLoggingStatus\": \"Enabled\"\r\n      },\r\n      \"tags\": {}\r\n    },\r\n    {\r\n      \"id\": \"/subscriptions/075423e9-7d33-4166-8bdf-3920b04e3735/resourceGroups/michalresourcegroup/providers/Microsoft.Security/IoTSecuritySolutions/michaldemohub\",\r\n      \"name\": \"michaldemohub\",\r\n      \"type\": \"Microsoft.Security/IoTSecuritySolutions\",\r\n      \"location\": \"West US\",\r\n      \"properties\": {\r\n        \"displayName\": \"MichalDemoHub\",\r\n        \"status\": \"Enabled\",\r\n        \"export\": [],\r\n        \"disabledDataSources\": [],\r\n        \"workspace\": \"/subscriptions/075423e9-7d33-4166-8bdf-3920b04e3735/resourcegroups/michalresourcegroup/providers/microsoft.operationalinsights/workspaces/iothubworkspace\",\r\n        \"additionalWorkspaces\": null,\r\n        \"iotHubs\": [\r\n          \"/subscriptions/075423e9-7d33-4166-8bdf-3920b04e3735/resourcegroups/michalresourcegroup/providers/microsoft.devices/iothubs/michaldemohub\"\r\n        ],\r\n        \"userDefinedResources\": {\r\n          \"query\": null,\r\n          \"querySubscriptions\": null\r\n        },\r\n        \"recommendationsConfiguration\": [\r\n          {\r\n            \"recommendationType\": \"IoT_ACRAuthentication\",\r\n            \"name\": \"Service prinicpal not used with ACR repository\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_AgentSendsUnutilizedMessages\",\r\n            \"name\": \"Agent sending underutilized messages\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_Baseline\",\r\n            \"name\": \"Operating system (OS) baseline validation failure\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_EdgeHubMemOptimize\",\r\n            \"name\": \"IoT Edge Hub memory can be optimized\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_EdgeLoggingOptions\",\r\n            \"name\": \"No logging configured for IoT Edge module\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_InconsistentModuleSettings\",\r\n            \"name\": \"SecurityGroup has inconsistent module settings\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_InstallAgent\",\r\n            \"name\": \"Install the Azure IoT Security agent\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_IPFilter_DenyAll\",\r\n            \"name\": \"Default IP filter policy should be deny\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_IPFilter_PermissiveRule\",\r\n            \"name\": \"IP filter rule includes a large IP range\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_OpenPorts\",\r\n            \"name\": \"Device has open ports\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveFirewallPolicy\",\r\n            \"name\": \"Permissive firewall policy in one of the chains\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveInputFirewallRules\",\r\n            \"name\": \"Permissive firewall rule in the input chain\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveOutputFirewallRules\",\r\n            \"name\": \"Permissive firewall rule in the output chain\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PrivilegedDockerOptions\",\r\n            \"name\": \"High level permissions configured in IoT Edge model twin for IoT Edge module\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_RecommendedIpRulesByBaseLine\",\r\n            \"name\": \"Recommended Rules for ip filter\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_SharedCredentials\",\r\n            \"name\": \"Same authentication credentials used by multiple devices\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_VulnerableTLSCipherSuite\",\r\n            \"name\": \"TLS cipher suite upgrade needed\",\r\n            \"status\": \"Enabled\"\r\n          }\r\n        ],\r\n        \"autoDiscoveredResources\": [\r\n          \"/subscriptions/075423e9-7d33-4166-8bdf-3920b04e3735/resourcegroups/michalresourcegroup/providers/microsoft.devices/iothubs/michaldemohub\"\r\n        ],\r\n        \"unmaskedIpLoggingStatus\": \"Disabled\"\r\n      },\r\n      \"tags\": {}\r\n    },\r\n    {\r\n      \"id\": \"/subscriptions/075423e9-7d33-4166-8bdf-3920b04e3735/resourceGroups/michalresourcegroup/providers/Microsoft.Security/IoTSecuritySolutions/michalhubtest13\",\r\n      \"name\": \"michalhubtest13\",\r\n      \"type\": \"Microsoft.Security/IoTSecuritySolutions\",\r\n      \"location\": \"uksouth\",\r\n      \"properties\": {\r\n        \"displayName\": \"MichalHubTest13\",\r\n        \"status\": \"Enabled\",\r\n        \"export\": [\r\n          \"RawEvents\"\r\n        ],\r\n        \"disabledDataSources\": [],\r\n        \"workspace\": \"/subscriptions/075423e9-7d33-4166-8bdf-3920b04e3735/resourcegroups/michalresourcegroup/providers/microsoft.operationalinsights/workspaces/iothubworkspace-uksouth-1570652161087\",\r\n        \"additionalWorkspaces\": null,\r\n        \"iotHubs\": [],\r\n        \"userDefinedResources\": {\r\n          \"query\": \"where type != \\\"microsoft.devices/iothubs\\\" | where (subscriptionId == \\\"075423e9-7d33-4166-8bdf-3920b04e3735\\\" and resourceGroup in~ (\\\"michalresourcegroup\\\")) | project id, name, type\",\r\n          \"querySubscriptions\": [\r\n            \"075423e9-7d33-4166-8bdf-3920b04e3735\"\r\n          ]\r\n        },\r\n        \"recommendationsConfiguration\": [\r\n          {\r\n            \"recommendationType\": \"IoT_ACRAuthentication\",\r\n            \"name\": \"Service prinicpal not used with ACR repository\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_AgentSendsUnutilizedMessages\",\r\n            \"name\": \"Agent sending underutilized messages\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_Baseline\",\r\n            \"name\": \"Operating system (OS) baseline validation failure\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_EdgeHubMemOptimize\",\r\n            \"name\": \"IoT Edge Hub memory can be optimized\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_EdgeLoggingOptions\",\r\n            \"name\": \"No logging configured for IoT Edge module\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_InconsistentModuleSettings\",\r\n            \"name\": \"SecurityGroup has inconsistent module settings\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_InstallAgent\",\r\n            \"name\": \"Install the Azure IoT Security agent\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_IPFilter_DenyAll\",\r\n            \"name\": \"Default IP filter policy should be deny\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_IPFilter_PermissiveRule\",\r\n            \"name\": \"IP filter rule includes a large IP range\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_OpenPorts\",\r\n            \"name\": \"Device has open ports\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveFirewallPolicy\",\r\n            \"name\": \"Permissive firewall policy in one of the chains\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveInputFirewallRules\",\r\n            \"name\": \"Permissive firewall rule in the input chain\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveOutputFirewallRules\",\r\n            \"name\": \"Permissive firewall rule in the output chain\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PrivilegedDockerOptions\",\r\n            \"name\": \"High level permissions configured in IoT Edge model twin for IoT Edge module\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_RecommendedIpRulesByBaseLine\",\r\n            \"name\": \"Recommended Rules for ip filter\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_SharedCredentials\",\r\n            \"name\": \"Same authentication credentials used by multiple devices\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_VulnerableTLSCipherSuite\",\r\n            \"name\": \"TLS cipher suite upgrade needed\",\r\n            \"status\": \"Enabled\"\r\n          }\r\n        ],\r\n        \"autoDiscoveredResources\": [],\r\n        \"unmaskedIpLoggingStatus\": \"Disabled\"\r\n      },\r\n      \"tags\": {}\r\n    },\r\n    {\r\n      \"id\": \"/subscriptions/075423e9-7d33-4166-8bdf-3920b04e3735/resourceGroups/michalresourcegroup/providers/Microsoft.Security/IoTSecuritySolutions/michalhubtest14\",\r\n      \"name\": \"michalhubtest14\",\r\n      \"type\": \"Microsoft.Security/IoTSecuritySolutions\",\r\n      \"location\": \"uksouth\",\r\n      \"properties\": {\r\n        \"displayName\": \"MichalHubTest14\",\r\n        \"status\": \"Enabled\",\r\n        \"export\": [\r\n          \"RawEvents\"\r\n        ],\r\n        \"disabledDataSources\": [],\r\n        \"workspace\": \"/subscriptions/075423e9-7d33-4166-8bdf-3920b04e3735/resourcegroups/michalresourcegroup/providers/microsoft.operationalinsights/workspaces/iothubworkspace-uksouth-1570652161087\",\r\n        \"additionalWorkspaces\": null,\r\n        \"iotHubs\": [],\r\n        \"userDefinedResources\": {\r\n          \"query\": \"where type != \\\"microsoft.devices/iothubs\\\" | where (subscriptionId == \\\"075423e9-7d33-4166-8bdf-3920b04e3735\\\" and resourceGroup in~ (\\\"michalresourcegroup\\\")) | project id, name, type\",\r\n          \"querySubscriptions\": [\r\n            \"075423e9-7d33-4166-8bdf-3920b04e3735\"\r\n          ]\r\n        },\r\n        \"recommendationsConfiguration\": [\r\n          {\r\n            \"recommendationType\": \"IoT_ACRAuthentication\",\r\n            \"name\": \"Service prinicpal not used with ACR repository\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_AgentSendsUnutilizedMessages\",\r\n            \"name\": \"Agent sending underutilized messages\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_Baseline\",\r\n            \"name\": \"Operating system (OS) baseline validation failure\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_EdgeHubMemOptimize\",\r\n            \"name\": \"IoT Edge Hub memory can be optimized\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_EdgeLoggingOptions\",\r\n            \"name\": \"No logging configured for IoT Edge module\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_InconsistentModuleSettings\",\r\n            \"name\": \"SecurityGroup has inconsistent module settings\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_InstallAgent\",\r\n            \"name\": \"Install the Azure IoT Security agent\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_IPFilter_DenyAll\",\r\n            \"name\": \"Default IP filter policy should be deny\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_IPFilter_PermissiveRule\",\r\n            \"name\": \"IP filter rule includes a large IP range\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_OpenPorts\",\r\n            \"name\": \"Device has open ports\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveFirewallPolicy\",\r\n            \"name\": \"Permissive firewall policy in one of the chains\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveInputFirewallRules\",\r\n            \"name\": \"Permissive firewall rule in the input chain\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveOutputFirewallRules\",\r\n            \"name\": \"Permissive firewall rule in the output chain\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PrivilegedDockerOptions\",\r\n            \"name\": \"High level permissions configured in IoT Edge model twin for IoT Edge module\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_RecommendedIpRulesByBaseLine\",\r\n            \"name\": \"Recommended Rules for ip filter\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_SharedCredentials\",\r\n            \"name\": \"Same authentication credentials used by multiple devices\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_VulnerableTLSCipherSuite\",\r\n            \"name\": \"TLS cipher suite upgrade needed\",\r\n            \"status\": \"Enabled\"\r\n          }\r\n        ],\r\n        \"autoDiscoveredResources\": [],\r\n        \"unmaskedIpLoggingStatus\": \"Disabled\"\r\n      },\r\n      \"tags\": {}\r\n    },\r\n    {\r\n      \"id\": \"/subscriptions/075423e9-7d33-4166-8bdf-3920b04e3735/resourceGroups/michalresourcegroup/providers/Microsoft.Security/IoTSecuritySolutions/michalhubtest19\",\r\n      \"name\": \"michalhubtest19\",\r\n      \"type\": \"Microsoft.Security/IoTSecuritySolutions\",\r\n      \"location\": \"francecentral\",\r\n      \"properties\": {\r\n        \"displayName\": \"MichalHubTest19\",\r\n        \"status\": \"Enabled\",\r\n        \"export\": [\r\n          \"RawEvents\"\r\n        ],\r\n        \"disabledDataSources\": [],\r\n        \"workspace\": \"/subscriptions/075423e9-7d33-4166-8bdf-3920b04e3735/resourcegroups/michalresourcegroup/providers/microsoft.operationalinsights/workspaces/iothubworkspace-francecentral-1570653967117\",\r\n        \"additionalWorkspaces\": null,\r\n        \"iotHubs\": [],\r\n        \"userDefinedResources\": {\r\n          \"query\": \"where type != \\\"microsoft.devices/iothubs\\\" | where (subscriptionId == \\\"075423e9-7d33-4166-8bdf-3920b04e3735\\\" and resourceGroup in~ (\\\"michalresourcegroup\\\")) | project id, name, type\",\r\n          \"querySubscriptions\": [\r\n            \"075423e9-7d33-4166-8bdf-3920b04e3735\"\r\n          ]\r\n        },\r\n        \"recommendationsConfiguration\": [\r\n          {\r\n            \"recommendationType\": \"IoT_ACRAuthentication\",\r\n            \"name\": \"Service prinicpal not used with ACR repository\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_AgentSendsUnutilizedMessages\",\r\n            \"name\": \"Agent sending underutilized messages\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_Baseline\",\r\n            \"name\": \"Operating system (OS) baseline validation failure\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_EdgeHubMemOptimize\",\r\n            \"name\": \"IoT Edge Hub memory can be optimized\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_EdgeLoggingOptions\",\r\n            \"name\": \"No logging configured for IoT Edge module\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_InconsistentModuleSettings\",\r\n            \"name\": \"SecurityGroup has inconsistent module settings\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_InstallAgent\",\r\n            \"name\": \"Install the Azure IoT Security agent\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_IPFilter_DenyAll\",\r\n            \"name\": \"Default IP filter policy should be deny\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_IPFilter_PermissiveRule\",\r\n            \"name\": \"IP filter rule includes a large IP range\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_OpenPorts\",\r\n            \"name\": \"Device has open ports\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveFirewallPolicy\",\r\n            \"name\": \"Permissive firewall policy in one of the chains\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveInputFirewallRules\",\r\n            \"name\": \"Permissive firewall rule in the input chain\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveOutputFirewallRules\",\r\n            \"name\": \"Permissive firewall rule in the output chain\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PrivilegedDockerOptions\",\r\n            \"name\": \"High level permissions configured in IoT Edge model twin for IoT Edge module\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_RecommendedIpRulesByBaseLine\",\r\n            \"name\": \"Recommended Rules for ip filter\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_SharedCredentials\",\r\n            \"name\": \"Same authentication credentials used by multiple devices\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_VulnerableTLSCipherSuite\",\r\n            \"name\": \"TLS cipher suite upgrade needed\",\r\n            \"status\": \"Enabled\"\r\n          }\r\n        ],\r\n        \"autoDiscoveredResources\": [],\r\n        \"unmaskedIpLoggingStatus\": \"Disabled\"\r\n      },\r\n      \"tags\": {}\r\n    },\r\n    {\r\n      \"id\": \"/subscriptions/075423e9-7d33-4166-8bdf-3920b04e3735/resourceGroups/michalresourcegroup/providers/Microsoft.Security/IoTSecuritySolutions/michalhubtest22\",\r\n      \"name\": \"michalhubtest22\",\r\n      \"type\": \"Microsoft.Security/IoTSecuritySolutions\",\r\n      \"location\": \"francecentral\",\r\n      \"properties\": {\r\n        \"displayName\": \"MichalHubTest22\",\r\n        \"status\": \"Enabled\",\r\n        \"export\": [\r\n          \"RawEvents\"\r\n        ],\r\n        \"disabledDataSources\": [],\r\n        \"workspace\": \"/subscriptions/075423e9-7d33-4166-8bdf-3920b04e3735/resourcegroups/michalresourcegroup/providers/microsoft.operationalinsights/workspaces/iothubworkspace-francecentral-1570653967117\",\r\n        \"additionalWorkspaces\": null,\r\n        \"iotHubs\": [],\r\n        \"userDefinedResources\": {\r\n          \"query\": \"where type != \\\"microsoft.devices/iothubs\\\" | where (subscriptionId == \\\"075423e9-7d33-4166-8bdf-3920b04e3735\\\" and resourceGroup in~ (\\\"michalresourcegroup\\\")) | project id, name, type\",\r\n          \"querySubscriptions\": [\r\n            \"075423e9-7d33-4166-8bdf-3920b04e3735\"\r\n          ]\r\n        },\r\n        \"recommendationsConfiguration\": [\r\n          {\r\n            \"recommendationType\": \"IoT_ACRAuthentication\",\r\n            \"name\": \"Service prinicpal not used with ACR repository\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_AgentSendsUnutilizedMessages\",\r\n            \"name\": \"Agent sending underutilized messages\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_Baseline\",\r\n            \"name\": \"Operating system (OS) baseline validation failure\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_EdgeHubMemOptimize\",\r\n            \"name\": \"IoT Edge Hub memory can be optimized\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_EdgeLoggingOptions\",\r\n            \"name\": \"No logging configured for IoT Edge module\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_InconsistentModuleSettings\",\r\n            \"name\": \"SecurityGroup has inconsistent module settings\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_InstallAgent\",\r\n            \"name\": \"Install the Azure IoT Security agent\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_IPFilter_DenyAll\",\r\n            \"name\": \"Default IP filter policy should be deny\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_IPFilter_PermissiveRule\",\r\n            \"name\": \"IP filter rule includes a large IP range\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_OpenPorts\",\r\n            \"name\": \"Device has open ports\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveFirewallPolicy\",\r\n            \"name\": \"Permissive firewall policy in one of the chains\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveInputFirewallRules\",\r\n            \"name\": \"Permissive firewall rule in the input chain\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveOutputFirewallRules\",\r\n            \"name\": \"Permissive firewall rule in the output chain\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PrivilegedDockerOptions\",\r\n            \"name\": \"High level permissions configured in IoT Edge model twin for IoT Edge module\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_RecommendedIpRulesByBaseLine\",\r\n            \"name\": \"Recommended Rules for ip filter\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_SharedCredentials\",\r\n            \"name\": \"Same authentication credentials used by multiple devices\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_VulnerableTLSCipherSuite\",\r\n            \"name\": \"TLS cipher suite upgrade needed\",\r\n            \"status\": \"Enabled\"\r\n          }\r\n        ],\r\n        \"autoDiscoveredResources\": [],\r\n        \"unmaskedIpLoggingStatus\": \"Disabled\"\r\n      },\r\n      \"tags\": {}\r\n    },\r\n    {\r\n      \"id\": \"/subscriptions/075423e9-7d33-4166-8bdf-3920b04e3735/resourceGroups/michalresourcegroup/providers/Microsoft.Security/IoTSecuritySolutions/michalhubtest7\",\r\n      \"name\": \"michalhubtest7\",\r\n      \"type\": \"Microsoft.Security/IoTSecuritySolutions\",\r\n      \"location\": \"North Europe\",\r\n      \"properties\": {\r\n        \"displayName\": \"MichalHubTest7\",\r\n        \"status\": \"Enabled\",\r\n        \"export\": [\r\n          \"RawEvents\"\r\n        ],\r\n        \"disabledDataSources\": [],\r\n        \"workspace\": \"/subscriptions/075423e9-7d33-4166-8bdf-3920b04e3735/resourcegroups/michalresourcegroup/providers/microsoft.operationalinsights/workspaces/iothubworkspace-northeurope-1570457875704\",\r\n        \"additionalWorkspaces\": null,\r\n        \"iotHubs\": [],\r\n        \"userDefinedResources\": {\r\n          \"query\": \"where type != \\\"microsoft.devices/iothubs\\\" | where (subscriptionId == \\\"075423e9-7d33-4166-8bdf-3920b04e3735\\\" and resourceGroup in~ (\\\"michalresourcegroup\\\")) | project id, name, type\",\r\n          \"querySubscriptions\": [\r\n            \"075423e9-7d33-4166-8bdf-3920b04e3735\"\r\n          ]\r\n        },\r\n        \"recommendationsConfiguration\": [\r\n          {\r\n            \"recommendationType\": \"IoT_ACRAuthentication\",\r\n            \"name\": \"Service prinicpal not used with ACR repository\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_AgentSendsUnutilizedMessages\",\r\n            \"name\": \"Agent sending underutilized messages\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_Baseline\",\r\n            \"name\": \"Operating system (OS) baseline validation failure\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_EdgeHubMemOptimize\",\r\n            \"name\": \"IoT Edge Hub memory can be optimized\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_EdgeLoggingOptions\",\r\n            \"name\": \"No logging configured for IoT Edge module\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_InconsistentModuleSettings\",\r\n            \"name\": \"SecurityGroup has inconsistent module settings\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_InstallAgent\",\r\n            \"name\": \"Install the Azure IoT Security agent\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_IPFilter_DenyAll\",\r\n            \"name\": \"Default IP filter policy should be deny\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_IPFilter_PermissiveRule\",\r\n            \"name\": \"IP filter rule includes a large IP range\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_OpenPorts\",\r\n            \"name\": \"Device has open ports\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveFirewallPolicy\",\r\n            \"name\": \"Permissive firewall policy in one of the chains\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveInputFirewallRules\",\r\n            \"name\": \"Permissive firewall rule in the input chain\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveOutputFirewallRules\",\r\n            \"name\": \"Permissive firewall rule in the output chain\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PrivilegedDockerOptions\",\r\n            \"name\": \"High level permissions configured in IoT Edge model twin for IoT Edge module\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_RecommendedIpRulesByBaseLine\",\r\n            \"name\": \"Recommended Rules for ip filter\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_SharedCredentials\",\r\n            \"name\": \"Same authentication credentials used by multiple devices\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_VulnerableTLSCipherSuite\",\r\n            \"name\": \"TLS cipher suite upgrade needed\",\r\n            \"status\": \"Enabled\"\r\n          }\r\n        ],\r\n        \"autoDiscoveredResources\": [],\r\n        \"unmaskedIpLoggingStatus\": \"Disabled\"\r\n      },\r\n      \"tags\": {}\r\n    },\r\n    {\r\n      \"id\": \"/subscriptions/075423e9-7d33-4166-8bdf-3920b04e3735/resourceGroups/michalresourcegroup/providers/Microsoft.Security/IoTSecuritySolutions/michalnewhub\",\r\n      \"name\": \"michalnewhub\",\r\n      \"type\": \"Microsoft.Security/IoTSecuritySolutions\",\r\n      \"location\": \"uksouth\",\r\n      \"properties\": {\r\n        \"displayName\": \"MichalNewHub\",\r\n        \"status\": \"Enabled\",\r\n        \"export\": [\r\n          \"RawEvents\"\r\n        ],\r\n        \"disabledDataSources\": [],\r\n        \"workspace\": \"/subscriptions/075423e9-7d33-4166-8bdf-3920b04e3735/resourcegroups/michalresourcegroup/providers/microsoft.operationalinsights/workspaces/iothubworkspace-uksouth-1570652161087\",\r\n        \"additionalWorkspaces\": null,\r\n        \"iotHubs\": [],\r\n        \"userDefinedResources\": {\r\n          \"query\": \"where type != \\\"microsoft.devices/iothubs\\\" | where (subscriptionId == \\\"075423e9-7d33-4166-8bdf-3920b04e3735\\\" and resourceGroup in~ (\\\"michalresourcegroup\\\")) | project id, name, type\",\r\n          \"querySubscriptions\": [\r\n            \"075423e9-7d33-4166-8bdf-3920b04e3735\"\r\n          ]\r\n        },\r\n        \"recommendationsConfiguration\": [\r\n          {\r\n            \"recommendationType\": \"IoT_ACRAuthentication\",\r\n            \"name\": \"Service prinicpal not used with ACR repository\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_AgentSendsUnutilizedMessages\",\r\n            \"name\": \"Agent sending underutilized messages\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_Baseline\",\r\n            \"name\": \"Operating system (OS) baseline validation failure\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_EdgeHubMemOptimize\",\r\n            \"name\": \"IoT Edge Hub memory can be optimized\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_EdgeLoggingOptions\",\r\n            \"name\": \"No logging configured for IoT Edge module\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_InconsistentModuleSettings\",\r\n            \"name\": \"SecurityGroup has inconsistent module settings\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_InstallAgent\",\r\n            \"name\": \"Install the Azure IoT Security agent\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_IPFilter_DenyAll\",\r\n            \"name\": \"Default IP filter policy should be deny\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_IPFilter_PermissiveRule\",\r\n            \"name\": \"IP filter rule includes a large IP range\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_OpenPorts\",\r\n            \"name\": \"Device has open ports\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveFirewallPolicy\",\r\n            \"name\": \"Permissive firewall policy in one of the chains\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveInputFirewallRules\",\r\n            \"name\": \"Permissive firewall rule in the input chain\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveOutputFirewallRules\",\r\n            \"name\": \"Permissive firewall rule in the output chain\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PrivilegedDockerOptions\",\r\n            \"name\": \"High level permissions configured in IoT Edge model twin for IoT Edge module\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_RecommendedIpRulesByBaseLine\",\r\n            \"name\": \"Recommended Rules for ip filter\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_SharedCredentials\",\r\n            \"name\": \"Same authentication credentials used by multiple devices\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_VulnerableTLSCipherSuite\",\r\n            \"name\": \"TLS cipher suite upgrade needed\",\r\n            \"status\": \"Enabled\"\r\n          }\r\n        ],\r\n        \"autoDiscoveredResources\": [],\r\n        \"unmaskedIpLoggingStatus\": \"Enabled\"\r\n      },\r\n      \"tags\": {}\r\n    },\r\n    {\r\n      \"id\": \"/subscriptions/075423e9-7d33-4166-8bdf-3920b04e3735/resourceGroups/michalresourcegroup/providers/Microsoft.Security/IoTSecuritySolutions/michalnewtest12\",\r\n      \"name\": \"michalnewtest12\",\r\n      \"type\": \"Microsoft.Security/IoTSecuritySolutions\",\r\n      \"location\": \"ukwest\",\r\n      \"properties\": {\r\n        \"displayName\": \"MichalNewTest12\",\r\n        \"status\": \"Enabled\",\r\n        \"export\": [\r\n          \"RawEvents\"\r\n        ],\r\n        \"disabledDataSources\": [],\r\n        \"workspace\": \"/subscriptions/075423e9-7d33-4166-8bdf-3920b04e3735/resourcegroups/michalresourcegroup/providers/microsoft.operationalinsights/workspaces/iothubworkspace-ukwest-1575466457570\",\r\n        \"additionalWorkspaces\": null,\r\n        \"iotHubs\": [],\r\n        \"userDefinedResources\": {\r\n          \"query\": \"where type != \\\"microsoft.devices/iothubs\\\" | where (subscriptionId == \\\"075423e9-7d33-4166-8bdf-3920b04e3735\\\" and resourceGroup in~ (\\\"michalresourcegroup\\\")) | project id, name, type\",\r\n          \"querySubscriptions\": [\r\n            \"075423e9-7d33-4166-8bdf-3920b04e3735\"\r\n          ]\r\n        },\r\n        \"recommendationsConfiguration\": [\r\n          {\r\n            \"recommendationType\": \"IoT_ACRAuthentication\",\r\n            \"name\": \"Service prinicpal not used with ACR repository\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_AgentSendsUnutilizedMessages\",\r\n            \"name\": \"Agent sending underutilized messages\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_Baseline\",\r\n            \"name\": \"Operating system (OS) baseline validation failure\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_EdgeHubMemOptimize\",\r\n            \"name\": \"IoT Edge Hub memory can be optimized\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_EdgeLoggingOptions\",\r\n            \"name\": \"No logging configured for IoT Edge module\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_InconsistentModuleSettings\",\r\n            \"name\": \"SecurityGroup has inconsistent module settings\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_InstallAgent\",\r\n            \"name\": \"Install the Azure IoT Security agent\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_IPFilter_DenyAll\",\r\n            \"name\": \"Default IP filter policy should be deny\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_IPFilter_PermissiveRule\",\r\n            \"name\": \"IP filter rule includes a large IP range\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_OpenPorts\",\r\n            \"name\": \"Device has open ports\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveFirewallPolicy\",\r\n            \"name\": \"Permissive firewall policy in one of the chains\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveInputFirewallRules\",\r\n            \"name\": \"Permissive firewall rule in the input chain\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveOutputFirewallRules\",\r\n            \"name\": \"Permissive firewall rule in the output chain\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PrivilegedDockerOptions\",\r\n            \"name\": \"High level permissions configured in IoT Edge model twin for IoT Edge module\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_RecommendedIpRulesByBaseLine\",\r\n            \"name\": \"Recommended Rules for ip filter\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_SharedCredentials\",\r\n            \"name\": \"Same authentication credentials used by multiple devices\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_VulnerableTLSCipherSuite\",\r\n            \"name\": \"TLS cipher suite upgrade needed\",\r\n            \"status\": \"Enabled\"\r\n          }\r\n        ],\r\n        \"autoDiscoveredResources\": [],\r\n        \"unmaskedIpLoggingStatus\": \"Enabled\"\r\n      },\r\n      \"tags\": {}\r\n    },\r\n    {\r\n      \"id\": \"/subscriptions/075423e9-7d33-4166-8bdf-3920b04e3735/resourceGroups/michalresourcegroup/providers/Microsoft.Security/IoTSecuritySolutions/michalnewtest20\",\r\n      \"name\": \"michalnewtest20\",\r\n      \"type\": \"Microsoft.Security/IoTSecuritySolutions\",\r\n      \"location\": \"ukwest\",\r\n      \"properties\": {\r\n        \"displayName\": \"MichalNewTest20\",\r\n        \"status\": \"Enabled\",\r\n        \"export\": [\r\n          \"RawEvents\"\r\n        ],\r\n        \"disabledDataSources\": [],\r\n        \"workspace\": \"/subscriptions/075423e9-7d33-4166-8bdf-3920b04e3735/resourcegroups/michalresourcegroup/providers/microsoft.operationalinsights/workspaces/iothubworkspace-ukwest-1575466457570\",\r\n        \"additionalWorkspaces\": null,\r\n        \"iotHubs\": [],\r\n        \"userDefinedResources\": {\r\n          \"query\": \"where type != \\\"microsoft.devices/iothubs\\\" | where (subscriptionId == \\\"075423e9-7d33-4166-8bdf-3920b04e3735\\\" and resourceGroup in~ (\\\"michalresourcegroup\\\")) | project id, name, type\",\r\n          \"querySubscriptions\": [\r\n            \"075423e9-7d33-4166-8bdf-3920b04e3735\"\r\n          ]\r\n        },\r\n        \"recommendationsConfiguration\": [\r\n          {\r\n            \"recommendationType\": \"IoT_ACRAuthentication\",\r\n            \"name\": \"Service prinicpal not used with ACR repository\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_AgentSendsUnutilizedMessages\",\r\n            \"name\": \"Agent sending underutilized messages\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_Baseline\",\r\n            \"name\": \"Operating system (OS) baseline validation failure\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_EdgeHubMemOptimize\",\r\n            \"name\": \"IoT Edge Hub memory can be optimized\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_EdgeLoggingOptions\",\r\n            \"name\": \"No logging configured for IoT Edge module\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_InconsistentModuleSettings\",\r\n            \"name\": \"SecurityGroup has inconsistent module settings\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_InstallAgent\",\r\n            \"name\": \"Install the Azure IoT Security agent\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_IPFilter_DenyAll\",\r\n            \"name\": \"Default IP filter policy should be deny\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_IPFilter_PermissiveRule\",\r\n            \"name\": \"IP filter rule includes a large IP range\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_OpenPorts\",\r\n            \"name\": \"Device has open ports\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveFirewallPolicy\",\r\n            \"name\": \"Permissive firewall policy in one of the chains\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveInputFirewallRules\",\r\n            \"name\": \"Permissive firewall rule in the input chain\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveOutputFirewallRules\",\r\n            \"name\": \"Permissive firewall rule in the output chain\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PrivilegedDockerOptions\",\r\n            \"name\": \"High level permissions configured in IoT Edge model twin for IoT Edge module\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_RecommendedIpRulesByBaseLine\",\r\n            \"name\": \"Recommended Rules for ip filter\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_SharedCredentials\",\r\n            \"name\": \"Same authentication credentials used by multiple devices\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_VulnerableTLSCipherSuite\",\r\n            \"name\": \"TLS cipher suite upgrade needed\",\r\n            \"status\": \"Enabled\"\r\n          }\r\n        ],\r\n        \"autoDiscoveredResources\": [],\r\n        \"unmaskedIpLoggingStatus\": \"Enabled\"\r\n      },\r\n      \"tags\": {}\r\n    },\r\n    {\r\n      \"id\": \"/subscriptions/075423e9-7d33-4166-8bdf-3920b04e3735/resourceGroups/michalresourcegroup/providers/Microsoft.Security/IoTSecuritySolutions/michaliothubbugbash\",\r\n      \"name\": \"michaliothubbugbash\",\r\n      \"type\": \"Microsoft.Security/IoTSecuritySolutions\",\r\n      \"location\": \"centraluseuap\",\r\n      \"properties\": {\r\n        \"displayName\": \"MichalIoTHubBugBash\",\r\n        \"status\": \"Enabled\",\r\n        \"export\": [\r\n          \"RawEvents\"\r\n        ],\r\n        \"disabledDataSources\": [],\r\n        \"workspace\": \"/subscriptions/075423e9-7d33-4166-8bdf-3920b04e3735/resourcegroups/michalresourcegroup/providers/microsoft.operationalinsights/workspaces/michalla\",\r\n        \"additionalWorkspaces\": null,\r\n        \"iotHubs\": [],\r\n        \"userDefinedResources\": {\r\n          \"query\": null,\r\n          \"querySubscriptions\": null\r\n        },\r\n        \"recommendationsConfiguration\": [\r\n          {\r\n            \"recommendationType\": \"IoT_ACRAuthentication\",\r\n            \"name\": \"Service prinicpal not used with ACR repository\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_AgentSendsUnutilizedMessages\",\r\n            \"name\": \"Agent sending underutilized messages\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_Baseline\",\r\n            \"name\": \"Operating system (OS) baseline validation failure\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_EdgeHubMemOptimize\",\r\n            \"name\": \"IoT Edge Hub memory can be optimized\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_EdgeLoggingOptions\",\r\n            \"name\": \"No logging configured for IoT Edge module\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_InconsistentModuleSettings\",\r\n            \"name\": \"SecurityGroup has inconsistent module settings\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_InstallAgent\",\r\n            \"name\": \"Install the Azure IoT Security agent\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_IPFilter_DenyAll\",\r\n            \"name\": \"Default IP filter policy should be deny\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_IPFilter_PermissiveRule\",\r\n            \"name\": \"IP filter rule includes a large IP range\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_OpenPorts\",\r\n            \"name\": \"Device has open ports\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveFirewallPolicy\",\r\n            \"name\": \"Permissive firewall policy in one of the chains\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveInputFirewallRules\",\r\n            \"name\": \"Permissive firewall rule in the input chain\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveOutputFirewallRules\",\r\n            \"name\": \"Permissive firewall rule in the output chain\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PrivilegedDockerOptions\",\r\n            \"name\": \"High level permissions configured in IoT Edge model twin for IoT Edge module\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_RecommendedIpRulesByBaseLine\",\r\n            \"name\": \"Recommended Rules for ip filter\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_SharedCredentials\",\r\n            \"name\": \"Same authentication credentials used by multiple devices\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_VulnerableTLSCipherSuite\",\r\n            \"name\": \"TLS cipher suite upgrade needed\",\r\n            \"status\": \"Enabled\"\r\n          }\r\n        ],\r\n        \"autoDiscoveredResources\": [],\r\n        \"unmaskedIpLoggingStatus\": \"Disabled\"\r\n      },\r\n      \"tags\": {}\r\n    },\r\n    {\r\n      \"id\": \"/subscriptions/075423e9-7d33-4166-8bdf-3920b04e3735/resourceGroups/michalresourcegroup/providers/Microsoft.Security/IoTSecuritySolutions/michaltestmichaltestmichaltestmichaltest\",\r\n      \"name\": \"michaltestmichaltestmichaltestmichaltest\",\r\n      \"type\": \"Microsoft.Security/IoTSecuritySolutions\",\r\n      \"location\": \"eastus2euap\",\r\n      \"properties\": {\r\n        \"displayName\": \"MichalTestMichalTestMichalTestMichalTest\",\r\n        \"status\": \"Enabled\",\r\n        \"export\": [\r\n          \"RawEvents\"\r\n        ],\r\n        \"disabledDataSources\": [],\r\n        \"workspace\": \"/subscriptions/075423e9-7d33-4166-8bdf-3920b04e3735/resourcegroups/michaele-canary/providers/microsoft.operationalinsights/workspaces/iothubworkspace-eastus-1574595138284\",\r\n        \"additionalWorkspaces\": null,\r\n        \"iotHubs\": [],\r\n        \"userDefinedResources\": {\r\n          \"query\": \"where type != \\\"microsoft.devices/iothubs\\\" | where (subscriptionId == \\\"075423e9-7d33-4166-8bdf-3920b04e3735\\\" and resourceGroup in~ (\\\"michalresourcegroup\\\")) | project id, name, type\",\r\n          \"querySubscriptions\": [\r\n            \"075423e9-7d33-4166-8bdf-3920b04e3735\"\r\n          ]\r\n        },\r\n        \"recommendationsConfiguration\": [\r\n          {\r\n            \"recommendationType\": \"IoT_ACRAuthentication\",\r\n            \"name\": \"Service prinicpal not used with ACR repository\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_AgentSendsUnutilizedMessages\",\r\n            \"name\": \"Agent sending underutilized messages\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_Baseline\",\r\n            \"name\": \"Operating system (OS) baseline validation failure\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_EdgeHubMemOptimize\",\r\n            \"name\": \"IoT Edge Hub memory can be optimized\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_EdgeLoggingOptions\",\r\n            \"name\": \"No logging configured for IoT Edge module\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_InconsistentModuleSettings\",\r\n            \"name\": \"SecurityGroup has inconsistent module settings\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_InstallAgent\",\r\n            \"name\": \"Install the Azure IoT Security agent\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_IPFilter_DenyAll\",\r\n            \"name\": \"Default IP filter policy should be deny\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_IPFilter_PermissiveRule\",\r\n            \"name\": \"IP filter rule includes a large IP range\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_OpenPorts\",\r\n            \"name\": \"Device has open ports\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveFirewallPolicy\",\r\n            \"name\": \"Permissive firewall policy in one of the chains\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveInputFirewallRules\",\r\n            \"name\": \"Permissive firewall rule in the input chain\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveOutputFirewallRules\",\r\n            \"name\": \"Permissive firewall rule in the output chain\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PrivilegedDockerOptions\",\r\n            \"name\": \"High level permissions configured in IoT Edge model twin for IoT Edge module\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_RecommendedIpRulesByBaseLine\",\r\n            \"name\": \"Recommended Rules for ip filter\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_SharedCredentials\",\r\n            \"name\": \"Same authentication credentials used by multiple devices\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_VulnerableTLSCipherSuite\",\r\n            \"name\": \"TLS cipher suite upgrade needed\",\r\n            \"status\": \"Enabled\"\r\n          }\r\n        ],\r\n        \"autoDiscoveredResources\": [],\r\n        \"unmaskedIpLoggingStatus\": \"Enabled\"\r\n      },\r\n      \"tags\": {}\r\n    },\r\n    {\r\n      \"id\": \"/subscriptions/075423e9-7d33-4166-8bdf-3920b04e3735/resourceGroups/michalresourcegroup/providers/Microsoft.Security/IoTSecuritySolutions/michalhubtest200\",\r\n      \"name\": \"michalhubtest200\",\r\n      \"type\": \"Microsoft.Security/IoTSecuritySolutions\",\r\n      \"location\": \"centraluseuap\",\r\n      \"properties\": {\r\n        \"displayName\": \"MichalHubTest200\",\r\n        \"status\": \"Enabled\",\r\n        \"export\": [\r\n          \"RawEvents\"\r\n        ],\r\n        \"disabledDataSources\": [],\r\n        \"workspace\": \"/subscriptions/075423e9-7d33-4166-8bdf-3920b04e3735/resourcegroups/michaele-canary/providers/microsoft.operationalinsights/workspaces/iothubworkspace-eastus-1574595138284\",\r\n        \"additionalWorkspaces\": null,\r\n        \"iotHubs\": [],\r\n        \"userDefinedResources\": {\r\n          \"query\": \"where type != \\\"microsoft.devices/iothubs\\\" | where (subscriptionId == \\\"075423e9-7d33-4166-8bdf-3920b04e3735\\\" and resourceGroup in~ (\\\"michalresourcegroup\\\")) | project id, name, type\",\r\n          \"querySubscriptions\": [\r\n            \"075423e9-7d33-4166-8bdf-3920b04e3735\"\r\n          ]\r\n        },\r\n        \"recommendationsConfiguration\": [\r\n          {\r\n            \"recommendationType\": \"IoT_ACRAuthentication\",\r\n            \"name\": \"Service prinicpal not used with ACR repository\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_AgentSendsUnutilizedMessages\",\r\n            \"name\": \"Agent sending underutilized messages\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_Baseline\",\r\n            \"name\": \"Operating system (OS) baseline validation failure\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_EdgeHubMemOptimize\",\r\n            \"name\": \"IoT Edge Hub memory can be optimized\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_EdgeLoggingOptions\",\r\n            \"name\": \"No logging configured for IoT Edge module\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_InconsistentModuleSettings\",\r\n            \"name\": \"SecurityGroup has inconsistent module settings\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_InstallAgent\",\r\n            \"name\": \"Install the Azure IoT Security agent\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_IPFilter_DenyAll\",\r\n            \"name\": \"Default IP filter policy should be deny\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_IPFilter_PermissiveRule\",\r\n            \"name\": \"IP filter rule includes a large IP range\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_OpenPorts\",\r\n            \"name\": \"Device has open ports\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveFirewallPolicy\",\r\n            \"name\": \"Permissive firewall policy in one of the chains\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveInputFirewallRules\",\r\n            \"name\": \"Permissive firewall rule in the input chain\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveOutputFirewallRules\",\r\n            \"name\": \"Permissive firewall rule in the output chain\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PrivilegedDockerOptions\",\r\n            \"name\": \"High level permissions configured in IoT Edge model twin for IoT Edge module\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_RecommendedIpRulesByBaseLine\",\r\n            \"name\": \"Recommended Rules for ip filter\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_SharedCredentials\",\r\n            \"name\": \"Same authentication credentials used by multiple devices\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_VulnerableTLSCipherSuite\",\r\n            \"name\": \"TLS cipher suite upgrade needed\",\r\n            \"status\": \"Enabled\"\r\n          }\r\n        ],\r\n        \"autoDiscoveredResources\": [],\r\n        \"unmaskedIpLoggingStatus\": \"Enabled\"\r\n      },\r\n      \"tags\": {}\r\n    },\r\n    {\r\n      \"id\": \"/subscriptions/075423e9-7d33-4166-8bdf-3920b04e3735/resourceGroups/michalresourcegroup/providers/Microsoft.Security/IoTSecuritySolutions/michalhubrec\",\r\n      \"name\": \"michalhubrec\",\r\n      \"type\": \"Microsoft.Security/IoTSecuritySolutions\",\r\n      \"location\": \"centraluseuap\",\r\n      \"properties\": {\r\n        \"displayName\": \"MichalHubRec\",\r\n        \"status\": \"Enabled\",\r\n        \"export\": [],\r\n        \"disabledDataSources\": [],\r\n        \"workspace\": \"/subscriptions/075423e9-7d33-4166-8bdf-3920b04e3735/resourcegroups/michalresourcegroup/providers/microsoft.operationalinsights/workspaces/075423e9-7d33-4166-8bdf-3920b04e3735-iothubworkspace1\",\r\n        \"additionalWorkspaces\": null,\r\n        \"iotHubs\": [\r\n          \"/subscriptions/075423e9-7d33-4166-8bdf-3920b04e3735/resourcegroups/michalresourcegroup/providers/microsoft.devices/iothubs/michalhubrec\"\r\n        ],\r\n        \"userDefinedResources\": {\r\n          \"query\": null,\r\n          \"querySubscriptions\": null\r\n        },\r\n        \"recommendationsConfiguration\": [\r\n          {\r\n            \"recommendationType\": \"IoT_ACRAuthentication\",\r\n            \"name\": \"Service prinicpal not used with ACR repository\",\r\n            \"status\": \"Disabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_AgentSendsUnutilizedMessages\",\r\n            \"name\": \"Agent sending underutilized messages\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_Baseline\",\r\n            \"name\": \"Operating system (OS) baseline validation failure\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_EdgeHubMemOptimize\",\r\n            \"name\": \"IoT Edge Hub memory can be optimized\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_EdgeLoggingOptions\",\r\n            \"name\": \"No logging configured for IoT Edge module\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_InconsistentModuleSettings\",\r\n            \"name\": \"SecurityGroup has inconsistent module settings\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_InstallAgent\",\r\n            \"name\": \"Install the Azure IoT Security agent\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_IPFilter_DenyAll\",\r\n            \"name\": \"Default IP filter policy should be deny\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_IPFilter_PermissiveRule\",\r\n            \"name\": \"IP filter rule includes a large IP range\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_OpenPorts\",\r\n            \"name\": \"Device has open ports\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveFirewallPolicy\",\r\n            \"name\": \"Permissive firewall policy in one of the chains\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveInputFirewallRules\",\r\n            \"name\": \"Permissive firewall rule in the input chain\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveOutputFirewallRules\",\r\n            \"name\": \"Permissive firewall rule in the output chain\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PrivilegedDockerOptions\",\r\n            \"name\": \"High level permissions configured in IoT Edge model twin for IoT Edge module\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_RecommendedIpRulesByBaseLine\",\r\n            \"name\": \"Recommended Rules for ip filter\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_SharedCredentials\",\r\n            \"name\": \"Same authentication credentials used by multiple devices\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_VulnerableTLSCipherSuite\",\r\n            \"name\": \"TLS cipher suite upgrade needed\",\r\n            \"status\": \"Enabled\"\r\n          }\r\n        ],\r\n        \"autoDiscoveredResources\": [\r\n          \"/subscriptions/075423e9-7d33-4166-8bdf-3920b04e3735/resourcegroups/michalresourcegroup/providers/microsoft.devices/iothubs/michalhubrec\"\r\n        ],\r\n        \"unmaskedIpLoggingStatus\": \"Enabled\"\r\n      },\r\n      \"tags\": {}\r\n    },\r\n    {\r\n      \"id\": \"/subscriptions/075423e9-7d33-4166-8bdf-3920b04e3735/resourceGroups/michalresourcegroup/providers/Microsoft.Security/IoTSecuritySolutions/michalhubdemo\",\r\n      \"name\": \"michalhubdemo\",\r\n      \"type\": \"Microsoft.Security/IoTSecuritySolutions\",\r\n      \"location\": \"centraluseuap\",\r\n      \"properties\": {\r\n        \"displayName\": \"MichalHubDemo\",\r\n        \"status\": \"Enabled\",\r\n        \"export\": [\r\n          \"RawEvents\"\r\n        ],\r\n        \"disabledDataSources\": [],\r\n        \"workspace\": \"/subscriptions/075423e9-7d33-4166-8bdf-3920b04e3735/resourcegroups/michaele-canary/providers/microsoft.operationalinsights/workspaces/iothubworkspace-eastus-1574595138284\",\r\n        \"additionalWorkspaces\": null,\r\n        \"iotHubs\": [\r\n          \"/subscriptions/075423e9-7d33-4166-8bdf-3920b04e3735/resourcegroups/michalresourcegroup/providers/microsoft.devices/iothubs/michalhubdemo\"\r\n        ],\r\n        \"userDefinedResources\": {\r\n          \"query\": null,\r\n          \"querySubscriptions\": null\r\n        },\r\n        \"recommendationsConfiguration\": [\r\n          {\r\n            \"recommendationType\": \"IoT_ACRAuthentication\",\r\n            \"name\": \"Service prinicpal not used with ACR repository\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_AgentSendsUnutilizedMessages\",\r\n            \"name\": \"Agent sending underutilized messages\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_Baseline\",\r\n            \"name\": \"Operating system (OS) baseline validation failure\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_EdgeHubMemOptimize\",\r\n            \"name\": \"IoT Edge Hub memory can be optimized\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_EdgeLoggingOptions\",\r\n            \"name\": \"No logging configured for IoT Edge module\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_InconsistentModuleSettings\",\r\n            \"name\": \"SecurityGroup has inconsistent module settings\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_InstallAgent\",\r\n            \"name\": \"Install the Azure IoT Security agent\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_IPFilter_DenyAll\",\r\n            \"name\": \"Default IP filter policy should be deny\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_IPFilter_PermissiveRule\",\r\n            \"name\": \"IP filter rule includes a large IP range\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_OpenPorts\",\r\n            \"name\": \"Device has open ports\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveFirewallPolicy\",\r\n            \"name\": \"Permissive firewall policy in one of the chains\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveInputFirewallRules\",\r\n            \"name\": \"Permissive firewall rule in the input chain\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveOutputFirewallRules\",\r\n            \"name\": \"Permissive firewall rule in the output chain\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PrivilegedDockerOptions\",\r\n            \"name\": \"High level permissions configured in IoT Edge model twin for IoT Edge module\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_RecommendedIpRulesByBaseLine\",\r\n            \"name\": \"Recommended Rules for ip filter\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_SharedCredentials\",\r\n            \"name\": \"Same authentication credentials used by multiple devices\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_VulnerableTLSCipherSuite\",\r\n            \"name\": \"TLS cipher suite upgrade needed\",\r\n            \"status\": \"Enabled\"\r\n          }\r\n        ],\r\n        \"autoDiscoveredResources\": [\r\n          \"/subscriptions/075423e9-7d33-4166-8bdf-3920b04e3735/resourcegroups/michalresourcegroup/providers/microsoft.devices/iothubs/michalhubdemo\"\r\n        ],\r\n        \"unmaskedIpLoggingStatus\": \"Enabled\"\r\n      },\r\n      \"tags\": {}\r\n    },\r\n    {\r\n      \"id\": \"/subscriptions/075423e9-7d33-4166-8bdf-3920b04e3735/resourceGroups/michalresourcegroup/providers/Microsoft.Security/IoTSecuritySolutions/michalhubdemo1\",\r\n      \"name\": \"michalhubdemo1\",\r\n      \"type\": \"Microsoft.Security/IoTSecuritySolutions\",\r\n      \"location\": \"centraluseuap\",\r\n      \"properties\": {\r\n        \"displayName\": \"MichalHubDemo1\",\r\n        \"status\": \"Enabled\",\r\n        \"export\": [\r\n          \"RawEvents\"\r\n        ],\r\n        \"disabledDataSources\": [],\r\n        \"workspace\": \"/subscriptions/075423e9-7d33-4166-8bdf-3920b04e3735/resourcegroups/michaele-canary/providers/microsoft.operationalinsights/workspaces/iothubworkspace-eastus-1574595138284\",\r\n        \"additionalWorkspaces\": null,\r\n        \"iotHubs\": [],\r\n        \"userDefinedResources\": {\r\n          \"query\": \"where type != \\\"microsoft.devices/iothubs\\\" | where (subscriptionId == \\\"075423e9-7d33-4166-8bdf-3920b04e3735\\\" and resourceGroup in~ (\\\"michalresourcegroup\\\")) | project id, name, type\",\r\n          \"querySubscriptions\": [\r\n            \"075423e9-7d33-4166-8bdf-3920b04e3735\"\r\n          ]\r\n        },\r\n        \"recommendationsConfiguration\": [\r\n          {\r\n            \"recommendationType\": \"IoT_ACRAuthentication\",\r\n            \"name\": \"Service prinicpal not used with ACR repository\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_AgentSendsUnutilizedMessages\",\r\n            \"name\": \"Agent sending underutilized messages\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_Baseline\",\r\n            \"name\": \"Operating system (OS) baseline validation failure\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_EdgeHubMemOptimize\",\r\n            \"name\": \"IoT Edge Hub memory can be optimized\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_EdgeLoggingOptions\",\r\n            \"name\": \"No logging configured for IoT Edge module\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_InconsistentModuleSettings\",\r\n            \"name\": \"SecurityGroup has inconsistent module settings\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_InstallAgent\",\r\n            \"name\": \"Install the Azure IoT Security agent\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_IPFilter_DenyAll\",\r\n            \"name\": \"Default IP filter policy should be deny\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_IPFilter_PermissiveRule\",\r\n            \"name\": \"IP filter rule includes a large IP range\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_OpenPorts\",\r\n            \"name\": \"Device has open ports\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveFirewallPolicy\",\r\n            \"name\": \"Permissive firewall policy in one of the chains\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveInputFirewallRules\",\r\n            \"name\": \"Permissive firewall rule in the input chain\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveOutputFirewallRules\",\r\n            \"name\": \"Permissive firewall rule in the output chain\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PrivilegedDockerOptions\",\r\n            \"name\": \"High level permissions configured in IoT Edge model twin for IoT Edge module\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_RecommendedIpRulesByBaseLine\",\r\n            \"name\": \"Recommended Rules for ip filter\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_SharedCredentials\",\r\n            \"name\": \"Same authentication credentials used by multiple devices\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_VulnerableTLSCipherSuite\",\r\n            \"name\": \"TLS cipher suite upgrade needed\",\r\n            \"status\": \"Enabled\"\r\n          }\r\n        ],\r\n        \"autoDiscoveredResources\": [],\r\n        \"unmaskedIpLoggingStatus\": \"Enabled\"\r\n      },\r\n      \"tags\": {}\r\n    },\r\n    {\r\n      \"id\": \"/subscriptions/075423e9-7d33-4166-8bdf-3920b04e3735/resourceGroups/michalresourcegroup/providers/Microsoft.Security/IoTSecuritySolutions/michalhubdemo2\",\r\n      \"name\": \"michalhubdemo2\",\r\n      \"type\": \"Microsoft.Security/IoTSecuritySolutions\",\r\n      \"location\": \"centraluseuap\",\r\n      \"properties\": {\r\n        \"displayName\": \"MichalHubDemo2\",\r\n        \"status\": \"Enabled\",\r\n        \"export\": [\r\n          \"RawEvents\"\r\n        ],\r\n        \"disabledDataSources\": [],\r\n        \"workspace\": \"/subscriptions/075423e9-7d33-4166-8bdf-3920b04e3735/resourcegroups/michaele-canary/providers/microsoft.operationalinsights/workspaces/iothubworkspace-eastus-1574595138284\",\r\n        \"additionalWorkspaces\": null,\r\n        \"iotHubs\": [],\r\n        \"userDefinedResources\": {\r\n          \"query\": \"where type != \\\"microsoft.devices/iothubs\\\" | where (subscriptionId == \\\"075423e9-7d33-4166-8bdf-3920b04e3735\\\" and resourceGroup in~ (\\\"michalresourcegroup\\\")) | project id, name, type\",\r\n          \"querySubscriptions\": [\r\n            \"075423e9-7d33-4166-8bdf-3920b04e3735\"\r\n          ]\r\n        },\r\n        \"recommendationsConfiguration\": [\r\n          {\r\n            \"recommendationType\": \"IoT_ACRAuthentication\",\r\n            \"name\": \"Service prinicpal not used with ACR repository\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_AgentSendsUnutilizedMessages\",\r\n            \"name\": \"Agent sending underutilized messages\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_Baseline\",\r\n            \"name\": \"Operating system (OS) baseline validation failure\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_EdgeHubMemOptimize\",\r\n            \"name\": \"IoT Edge Hub memory can be optimized\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_EdgeLoggingOptions\",\r\n            \"name\": \"No logging configured for IoT Edge module\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_InconsistentModuleSettings\",\r\n            \"name\": \"SecurityGroup has inconsistent module settings\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_InstallAgent\",\r\n            \"name\": \"Install the Azure IoT Security agent\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_IPFilter_DenyAll\",\r\n            \"name\": \"Default IP filter policy should be deny\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_IPFilter_PermissiveRule\",\r\n            \"name\": \"IP filter rule includes a large IP range\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_OpenPorts\",\r\n            \"name\": \"Device has open ports\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveFirewallPolicy\",\r\n            \"name\": \"Permissive firewall policy in one of the chains\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveInputFirewallRules\",\r\n            \"name\": \"Permissive firewall rule in the input chain\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PermissiveOutputFirewallRules\",\r\n            \"name\": \"Permissive firewall rule in the output chain\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_PrivilegedDockerOptions\",\r\n            \"name\": \"High level permissions configured in IoT Edge model twin for IoT Edge module\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_RecommendedIpRulesByBaseLine\",\r\n            \"name\": \"Recommended Rules for ip filter\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_SharedCredentials\",\r\n            \"name\": \"Same authentication credentials used by multiple devices\",\r\n            \"status\": \"Enabled\"\r\n          },\r\n          {\r\n            \"recommendationType\": \"IoT_VulnerableTLSCipherSuite\",\r\n            \"name\": \"TLS cipher suite upgrade needed\",\r\n            \"status\": \"Enabled\"\r\n          }\r\n        ],\r\n        \"autoDiscoveredResources\": [],\r\n        \"unmaskedIpLoggingStatus\": \"Enabled\"\r\n      },\r\n      \"tags\": {}\r\n    }\r\n  ]\r\n}",
      "StatusCode": 200
    }
  ],
  "Names": {},
  "Variables": {
    "SubscriptionId": "075423e9-7d33-4166-8bdf-3920b04e3735"
  }
}