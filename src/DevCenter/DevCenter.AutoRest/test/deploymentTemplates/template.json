{
    "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
    "contentVersion": "1.0.0.0",
    "parameters": {
        "managedIdentityName": {
            "type": "string"
        },
        "subscriptionId": {
            "type": "string"
        },
        "resourceGroup": {
            "type": "string"
        },
        "devCenterName": {
            "type": "string"
        },
        "devCenterNameDelete": {
            "type": "string"
        },
        "projectName": {
            "type": "string"
        },
        "location": {
            "type": "string"
        },
        "subnetId": {
            "type": "string"
        },
        "keyVaultSecret": {
            "type": "string"
        },
        "networkConnectionName": {
            "type": "string"
        },
        "networkConnectionNameDelete": {
            "type": "string"
        },
        "catalogName": {
            "type": "string"
        },
        "gitHubRepo": {
            "type": "string"
        },
        "attachedNetworkName": {
            "type": "string"
        },
        "devBoxDefinitionName": {
            "type": "string"
        },
        "imageReferenceId": {
            "type": "string"
        },
        "skuName": {
            "type": "string"
        },
        "keyVaultName": {
            "type": "string"
        },
        "environmentTypeName": {
            "type": "string"
        },
        "poolName": {
            "type": "string"
        },
        "sigId": {
            "type": "string"

        },
        "sigName2": {
            "type": "string"

        },
        "sigName3": {
            "type": "string"

        },
        "sigName4": {
            "type": "string"

        },
        "sigName5": {
            "type": "string"

        },
        "galleryName": {
            "type": "string"

        },
        "roleNameGuid": {
            "type": "string",
            "defaultValue": "[newGuid()]",
            "metadata": {
                "description": "A new GUID used to identify the role assignment"
            }
        },
        "roleNameGuid2": {
            "type": "string",
            "defaultValue": "[newGuid()]",
            "metadata": {
                "description": "A new GUID used to identify the role assignment"
            }
        },
        "roleNameGuid3": {
            "type": "string",
            "defaultValue": "[newGuid()]",
            "metadata": {
                "description": "A new GUID used to identify the role assignment"
            }
        },
        "roleNameGuid4": {
            "type": "string",
            "defaultValue": "[newGuid()]",
            "metadata": {
                "description": "A new GUID used to identify the role assignment"
            }
        },
        "roleNameGuid5": {
            "type": "string",
            "defaultValue": "[newGuid()]",
            "metadata": {
                "description": "A new GUID used to identify the role assignment"
            }
        },
        "roleNameGuid6": {
            "type": "string",
            "defaultValue": "[newGuid()]",
            "metadata": {
                "description": "A new GUID used to identify the role assignment"
            }
        },
        "projectNameDelete": {
            "type": "string"

        },
        "catalogNameDelete": {
            "type": "string"

        },
        "attachedNetworkNameDelete": {
            "type": "string"

        },
        "devBoxDefinitionNameDelete": {
            "type": "string"

        },
        "environmentTypeNameDelete": {
            "type": "string"

        },
        "galleryNameDelete": {
            "type": "string"

        },
        "poolNameDelete": {
            "type": "string"
        },
        "osStorageType": {
            "type": "string"

        },
        "envForProjEnvTypeNew": {
            "type": "string"
        },
        "envForProjEnvTypeNew2": {
            "type": "string"
        },
        "poolForScheduleNew": {
            "type": "string"
        },
        "poolForScheduleNew2": {
            "type": "string"
        },
        "projectNameDelete2": {
            "type": "string"
        },
        "catalogNameDelete2": {
            "type": "string"
        },
        "environmentTypeNameDelete2": {
            "type": "string"
        },
        "projEnvironmentTypeNameDelete": {
            "type": "string"
        },
        "projEnvironmentTypeNameDelete2": {
            "type": "string"
        },
        "devBoxDefinitionNameDelete2": {
            "type": "string"
        },
        "galleryNameDelete2": {
            "type": "string"
        },
        "poolNameDelete2": {
            "type": "string"
        },
        "networkConnectionNameDelete2": {
            "type": "string"
        },
        "attachedNetworkNameDelete2": {
            "type": "string"
        },
        "devCenterNameDelete2": {
            "type": "string"
        },
        "poolForScheduleDelete": {
            "type": "string"
        },
        "poolForScheduleDelete2": {
            "type": "string"
        },
        "catalogSet": {
            "type": "string"
        },
        "devBoxDefinitionSet": {
            "type": "string"
        },
        "devCenterSet": {
            "type": "string"
        },
        "environmentTypeSet": {
            "type": "string"
        },
        "networkConnectionSet": {
            "type": "string"
        },
        "poolSet": {
            "type": "string"
        },
        "projectSet": {
            "type": "string"
        },
        "projectEnvironmentTypeSet": {
            "type": "string"
        },
        "scheduleSet": {
            "type": "string"
        },
        "catalogUpdate": {
            "type": "string"
        },
        "devBoxDefinitionUpdate": {
            "type": "string"
        },
        "devCenterUpdate": {
            "type": "string"
        },
        "environmentTypeUpdate": {
            "type": "string"
        },
        "networkConnectionUpdate": {
            "type": "string"
        },
        "poolUpdate": {
            "type": "string"
        },
        "projectUpdate": {
            "type": "string"
        },
        "projectEnvironmentTypeUpdate": {
            "type": "string"
        },
        "scheduleUpdate": {
            "type": "string"
        },
        "networkConnectionHybridSet": {
            "type": "string"
        },
        "networkConnectionHybridUpdate": {
            "type": "string"
        }
    },
    "functions": [],
    "variables": {},
    "resources": [
        {
            "name": "[parameters('managedIdentityName')]",
            "type": "Microsoft.ManagedIdentity/userAssignedIdentities",
            "apiVersion": "2023-01-31",
            "location": "[parameters('location')]"
        },
        {
            "type": "Microsoft.DevCenter/devcenters",
            "name": "[parameters('devCenterNameDelete')]",
            "apiVersion": "2024-05-01-preview",
            "location": "[parameters('location')]"
        },
        {
            "type": "Microsoft.DevCenter/devcenters",
            "name": "[parameters('devCenterNameDelete2')]",
            "apiVersion": "2024-05-01-preview",
            "location": "[parameters('location')]"
        },
        {
            "type": "Microsoft.DevCenter/devcenters",
            "name": "[parameters('devCenterSet')]",
            "apiVersion": "2024-05-01-preview",
            "location": "[parameters('location')]"
        },
        {
            "type": "Microsoft.DevCenter/devcenters",
            "name": "[parameters('devCenterUpdate')]",
            "apiVersion": "2024-05-01-preview",
            "location": "[parameters('location')]"
        },
        {
            "type": "Microsoft.DevCenter/networkconnections",
            "name": "[parameters('networkConnectionNameDelete')]",
            "apiVersion": "2024-05-01-preview",
            "location": "[parameters('location')]",
            "properties": {
                "subnetId": "[parameters('subnetId')]",
                "domainJoinType": "AzureADJoin"
            }
        },
        {
            "type": "Microsoft.DevCenter/networkconnections",
            "name": "[parameters('networkConnectionNameDelete2')]",
            "apiVersion": "2024-05-01-preview",
            "location": "[parameters('location')]",
            "properties": {
                "subnetId": "[parameters('subnetId')]",
                "domainJoinType": "AzureADJoin"
            }
        },
                {
            "type": "Microsoft.DevCenter/networkconnections",
            "name": "[parameters('networkConnectionSet')]",
            "apiVersion": "2024-05-01-preview",
            "location": "[parameters('location')]",
            "properties": {
                "subnetId": "[parameters('subnetId')]",
                "domainJoinType": "AzureADJoin"
            }
        },
        {
            "type": "Microsoft.DevCenter/networkconnections",
            "name": "[parameters('networkConnectionUpdate')]",
            "apiVersion": "2024-05-01-preview",
            "location": "[parameters('location')]",
            "properties": {
                "subnetId": "[parameters('subnetId')]",
                "domainJoinType": "AzureADJoin"
            }
        },
        {
            "type": "Microsoft.DevCenter/networkconnections",
            "name": "[parameters('networkConnectionHybridSet')]",
            "apiVersion": "2024-05-01-preview",
            "location": "[parameters('location')]",
            "properties": {
                "subnetId": "[parameters('subnetId')]",
                "domainJoinType": "HybridAzureADJoin",
                "domainName": "fidalgoppe010.local",
                "domainUsername": "testuser@fidalgoppe010.local",
                "domainPassword": "fakePassword"
            }
        },
        {
            "type": "Microsoft.DevCenter/networkconnections",
            "name": "[parameters('networkConnectionHybridUpdate')]",
            "apiVersion": "2024-05-01-preview",
            "location": "[parameters('location')]",
            "properties": {
                "subnetId": "[parameters('subnetId')]",
                "domainJoinType": "HybridAzureADJoin",
                "domainName": "fidalgoppe010.local",
                "domainUsername": "testuser@fidalgoppe010.local",
                "domainPassword": "fakePassword"
            }
        },
        {
            "name": "createParentResources",
            "type": "Microsoft.Resources/deployments",
            "apiVersion": "2022-09-01",
            "subscriptionId": "[parameters('subscriptionId')]",
            "resourceGroup": "[parameters('resourceGroup')]",
            "dependsOn": [
                "[resourceId('Microsoft.ManagedIdentity/userAssignedIdentities', parameters('managedIdentityName'))]"
            ],
            "properties": {
                "mode": "Incremental",
                "template": {
                    "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                    "contentVersion": "1.0.0.0",
                    "resources": [
                        {
                            "type": "Microsoft.DevCenter/devcenters",
                            "name": "[parameters('devCenterName')]",
                            "apiVersion": "2024-05-01-preview",
                            "location": "[parameters('location')]",
                            "identity": {
                                "type": "UserAssigned",
                                "userAssignedIdentities": {
                                    "[resourceId('Microsoft.ManagedIdentity/userAssignedIdentities', parameters('managedIdentityName'))]": {}
                                }
                            }
                        },
                        {
                            "type": "Microsoft.DevCenter/projects",
                            "name": "[parameters('projectName')]",
                            "apiVersion": "2024-05-01-preview",
                            "location": "[parameters('location')]",
                            "properties": {
                                "devCenterId": "[resourceId('Microsoft.DevCenter/devcenters', parameters('devCenterName'))]",
                                "maxDevBoxesPerUser": 3

                            },
                            "dependsOn": [
                                "[resourceId('Microsoft.DevCenter/devcenters', parameters('devCenterName'))]"
                            ]
                        },
                        {
                            "type": "Microsoft.DevCenter/projects",
                            "name": "[parameters('projectNameDelete')]",
                            "apiVersion": "2024-05-01-preview",
                            "location": "[parameters('location')]",
                            "properties": {
                                "devCenterId": "[resourceId('Microsoft.DevCenter/devcenters', parameters('devCenterName'))]",
                                "maxDevBoxesPerUser": 3

                            },
                            "dependsOn": [
                                "[resourceId('Microsoft.DevCenter/devcenters', parameters('devCenterName'))]"
                            ]
                        },
                        {
                            "type": "Microsoft.DevCenter/projects",
                            "name": "[parameters('projectNameDelete2')]",
                            "apiVersion": "2024-05-01-preview",
                            "location": "[parameters('location')]",
                            "properties": {
                                "devCenterId": "[resourceId('Microsoft.DevCenter/devcenters', parameters('devCenterName'))]",
                                "maxDevBoxesPerUser": 3

                            },
                            "dependsOn": [
                                "[resourceId('Microsoft.DevCenter/devcenters', parameters('devCenterName'))]"
                            ]
                        },
                        {
                            "type": "Microsoft.DevCenter/projects",
                            "name": "[parameters('projectSet')]",
                            "apiVersion": "2024-05-01-preview",
                            "location": "[parameters('location')]",
                            "properties": {
                                "devCenterId": "[resourceId('Microsoft.DevCenter/devcenters', parameters('devCenterName'))]",
                                "maxDevBoxesPerUser": 3

                            },
                            "dependsOn": [
                                "[resourceId('Microsoft.DevCenter/devcenters', parameters('devCenterName'))]"
                            ]
                        },
                        {
                            "type": "Microsoft.DevCenter/projects",
                            "name": "[parameters('projectUpdate')]",
                            "apiVersion": "2024-05-01-preview",
                            "location": "[parameters('location')]",
                            "properties": {
                                "devCenterId": "[resourceId('Microsoft.DevCenter/devcenters', parameters('devCenterName'))]",
                                "maxDevBoxesPerUser": 3

                            },
                            "dependsOn": [
                                "[resourceId('Microsoft.DevCenter/devcenters', parameters('devCenterName'))]"
                            ]
                        },
                        {
                            "type": "Microsoft.DevCenter/networkconnections",
                            "name": "[parameters('networkConnectionName')]",
                            "apiVersion": "2024-05-01-preview",
                            "location": "[parameters('location')]",
                            "properties": {
                                "subnetId": "[parameters('subnetId')]",
                                "domainJoinType": "AzureADJoin"

                            }
                        }
                    ]
                }
            }
        },
        {
            "name": "createSigs",
            "type": "Microsoft.Resources/deployments",
            "apiVersion": "2022-09-01",
            "subscriptionId": "[parameters('subscriptionId')]",
            "resourceGroup": "[parameters('resourceGroup')]",
            "dependsOn": [
                "[resourceId('Microsoft.ManagedIdentity/userAssignedIdentities', parameters('managedIdentityName'))]"
            ],
            "properties": {
                "mode": "Incremental",
                "template": {
                    "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                    "contentVersion": "1.0.0.0",
                    "resources": [
                        {
                            "type": "Microsoft.Compute/galleries",
                            "name": "[parameters('sigName2')]",
                            "apiVersion": "2022-03-03",
                            "location": "[parameters('location')]"
                        },
                        {
                            "type": "Microsoft.Compute/galleries",
                            "name": "[parameters('sigName3')]",
                            "apiVersion": "2022-03-03",
                            "location": "[parameters('location')]"
                        },
                        {
                            "type": "Microsoft.Compute/galleries",
                            "name": "[parameters('sigName4')]",
                            "apiVersion": "2022-03-03",
                            "location": "[parameters('location')]"
                        },
                        {
                            "type": "Microsoft.Compute/galleries",
                            "name": "[parameters('sigName5')]",
                            "apiVersion": "2022-03-03",
                            "location": "[parameters('location')]"
                        },
                        {
                            "type": "Microsoft.Authorization/roleAssignments",
                            "apiVersion": "2022-04-01",
                            "name": "[parameters('roleNameGuid2')]",
                            "scope": "[resourceId('Microsoft.Compute/galleries', parameters('sigName2'))]",
                            "properties": {
                                "roleDefinitionId": "[concat('/subscriptions/', subscription().subscriptionId, '/providers/Microsoft.Authorization/roleDefinitions/', 'b24988ac-6180-42a0-ab88-20f7382dd24c')]",
                                "principalId": "[reference(parameters('managedIdentityName')).principalId]",
                                "principalType": "ServicePrincipal"
                            },
                            "dependsOn": [
                                "[resourceId('Microsoft.Compute/galleries', parameters('sigName2'))]"
                            ]
                        },
                        {
                            "type": "Microsoft.Authorization/roleAssignments",
                            "apiVersion": "2022-04-01",
                            "name": "[parameters('roleNameGuid3')]",
                            "scope": "[resourceId('Microsoft.Compute/galleries', parameters('sigName3'))]",
                            "properties": {
                                "roleDefinitionId": "[concat('/subscriptions/', subscription().subscriptionId, '/providers/Microsoft.Authorization/roleDefinitions/', 'b24988ac-6180-42a0-ab88-20f7382dd24c')]",
                                "principalId": "[reference(parameters('managedIdentityName')).principalId]",
                                "principalType": "ServicePrincipal"
                            },
                            "dependsOn": [
                                "[resourceId('Microsoft.Compute/galleries', parameters('sigName3'))]"
                            ]
                        },
                        {
                            "type": "Microsoft.Authorization/roleAssignments",
                            "apiVersion": "2022-04-01",
                            "name": "[parameters('roleNameGuid4')]",
                            "scope": "[resourceId('Microsoft.Compute/galleries', parameters('sigName4'))]",
                            "properties": {
                                "roleDefinitionId": "[concat('/subscriptions/', subscription().subscriptionId, '/providers/Microsoft.Authorization/roleDefinitions/', 'b24988ac-6180-42a0-ab88-20f7382dd24c')]",
                                "principalId": "[reference(parameters('managedIdentityName')).principalId]",
                                "principalType": "ServicePrincipal"
                            },
                            "dependsOn": [
                                "[resourceId('Microsoft.Compute/galleries', parameters('sigName4'))]"
                            ]
                        },
                        {
                            "type": "Microsoft.Authorization/roleAssignments",
                            "apiVersion": "2022-04-01",
                            "name": "[parameters('roleNameGuid5')]",
                            "scope": "[resourceId('Microsoft.Compute/galleries', parameters('sigName5'))]",
                            "properties": {
                                "roleDefinitionId": "[concat('/subscriptions/', subscription().subscriptionId, '/providers/Microsoft.Authorization/roleDefinitions/', 'b24988ac-6180-42a0-ab88-20f7382dd24c')]",
                                "principalId": "[reference(parameters('managedIdentityName')).principalId]",
                                "principalType": "ServicePrincipal"
                            },
                            "dependsOn": [
                                "[resourceId('Microsoft.Compute/galleries', parameters('sigName5'))]"
                            ]
                        }
                    ]
                }
            }
        },
        {
            "name": "createPolicies",
            "type": "Microsoft.Resources/deployments",
            "apiVersion": "2022-09-01",
            "subscriptionId": "[parameters('subscriptionId')]",
            "resourceGroup": "amlim-test",
            "dependsOn": [
                "[resourceId('Microsoft.ManagedIdentity/userAssignedIdentities', parameters('managedIdentityName'))]"
            ],
            "properties": {
                "mode": "Incremental",
                "template": {
                    "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                    "contentVersion": "1.0.0.0",
                    "resources": [
                        {
                            "type": "Microsoft.Authorization/roleAssignments",
                            "apiVersion": "2022-04-01",
                            "name": "[parameters('roleNameGuid6')]",
                            "scope": "[resourceId('Microsoft.KeyVault/vaults', parameters('keyVaultName'))]",
                            "properties": {
                                "roleDefinitionId": "[concat('/subscriptions/', subscription().subscriptionId, '/providers/Microsoft.Authorization/roleDefinitions/', 'b86a8fe4-44ce-4948-aee5-eccb2c155cd7')]",
                                "principalId": "[reference(parameters('managedIdentityName')).principalId]",
                                "principalType": "ServicePrincipal"
                            }
                        },
                        {
                            "type": "Microsoft.Authorization/roleAssignments",
                            "apiVersion": "2022-04-01",
                            "name": "[parameters('roleNameGuid')]",
                            "scope": "[parameters('sigId')]",
                            "properties": {
                                "roleDefinitionId": "[concat('/subscriptions/', subscription().subscriptionId, '/providers/Microsoft.Authorization/roleDefinitions/', 'b24988ac-6180-42a0-ab88-20f7382dd24c')]",
                                "principalId": "[reference(parameters('managedIdentityName')).principalId]",
                                "principalType": "ServicePrincipal"
                            }
                        }
                    ]
                }
            }
        },
        {
            "name": "createDcDependencies",
            "type": "Microsoft.Resources/deployments",
            "apiVersion": "2022-09-01",
            "subscriptionId": "[parameters('subscriptionId')]",
            "resourceGroup": "[parameters('resourceGroup')]",
            "dependsOn": [
                "[resourceId('Microsoft.Resources/deployments', 'createParentResources')]",
                "[resourceId('Microsoft.Resources/deployments', 'createSigs')]",
                "[resourceId('amlim-test', 'Microsoft.Resources/deployments', 'createPolicies')]"
            ],
            "properties": {
                "mode": "Incremental",
                "template": {
                    "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                    "contentVersion": "1.0.0.0",
                    "resources": [
                        {
                            "type": "microsoft.devcenter/devcenters/catalogs",
                            "name": "[concat(parameters('devCenterName'), '/', parameters('catalogName'))]",
                            "apiVersion": "2024-05-01-preview",
                            "properties": {
                                "gitHub": {
                                    "uri": "[parameters('gitHubRepo')]",
                                    "branch": "main",
                                    "secretIdentifier": "[parameters('keyVaultSecret')]",
                                    "path": "/Environments"
                                }
                            }
                        },
                        {
                            "type": "microsoft.devcenter/devcenters/catalogs",
                            "name": "[concat(parameters('devCenterName') ,'/', parameters('catalogNameDelete'))]",
                            "apiVersion": "2024-05-01-preview",
                            "properties": {
                                "gitHub": {
                                    "uri": "[parameters('gitHubRepo')]",
                                    "branch": "main",
                                    "secretIdentifier": "[parameters('keyVaultSecret')]",
                                    "path": "/Environments"
                                }
                            }
                        },
                        {
                            "type": "microsoft.devcenter/devcenters/catalogs",
                            "name": "[concat(parameters('devCenterName') ,'/', parameters('catalogNameDelete2'))]",
                            "apiVersion": "2024-05-01-preview",
                            "properties": {
                                "gitHub": {
                                    "uri": "[parameters('gitHubRepo')]",
                                    "branch": "main",
                                    "secretIdentifier": "[parameters('keyVaultSecret')]",
                                    "path": "/Environments"
                                }
                            }
                        },
                        {
                            "type": "microsoft.devcenter/devcenters/catalogs",
                            "name": "[concat(parameters('devCenterName') ,'/', parameters('catalogSet'))]",
                            "apiVersion": "2024-05-01-preview",
                            "properties": {
                                "gitHub": {
                                    "uri": "[parameters('gitHubRepo')]",
                                    "branch": "main",
                                    "secretIdentifier": "[parameters('keyVaultSecret')]",
                                    "path": "/Environments"
                                }
                            }
                        },
                        {
                            "type": "microsoft.devcenter/devcenters/catalogs",
                            "name": "[concat(parameters('devCenterName') ,'/', parameters('catalogUpdate'))]",
                            "apiVersion": "2024-05-01-preview",
                            "properties": {
                                "gitHub": {
                                    "uri": "[parameters('gitHubRepo')]",
                                    "branch": "main",
                                    "secretIdentifier": "[parameters('keyVaultSecret')]",
                                    "path": "/Environments"
                                }
                            }
                        },
                        {
                            "type": "microsoft.devcenter/devcenters/attachednetworks",
                            "name": "[concat(parameters('devCenterName'), '/', parameters('attachedNetworkName'))]",
                            "apiVersion": "2024-05-01-preview",
                            "properties": {
                                "networkConnectionId": "[resourceId('Microsoft.DevCenter/networkConnections', parameters('networkConnectionName'))]"
                            }
                        },
                        {
                            "type": "microsoft.devcenter/devcenters/attachednetworks",
                            "name": "[concat(parameters('devCenterName'), '/', parameters('attachedNetworkNameDelete'))]",
                            "apiVersion": "2024-05-01-preview",
                            "properties": {
                                "networkConnectionId": "[resourceId('Microsoft.DevCenter/networkConnections', parameters('networkConnectionName'))]"
                            }
                        },
                        {
                            "type": "microsoft.devcenter/devcenters/attachednetworks",
                            "name": "[concat(parameters('devCenterName'), '/', parameters('attachedNetworkNameDelete2'))]",
                            "apiVersion": "2024-05-01-preview",
                            "properties": {
                                "networkConnectionId": "[resourceId('Microsoft.DevCenter/networkConnections', parameters('networkConnectionName'))]"
                            }
                        },
                        {
                            "type": "microsoft.devcenter/devcenters/devboxdefinitions",
                            "name": "[concat(parameters('devCenterName'), '/', parameters('devBoxDefinitionName'))]",
                            "location": "[parameters('location')]",
                            "apiVersion": "2024-05-01-preview",
                            "properties": {
                                "imageReference": {
                                    "id": "[parameters('imageReferenceId')]"
                                },
                                "sku": {
                                    "name": "[parameters('skuName')]"
                                },
                                "osStorageType": "[parameters('osStorageType')]",
                                "hibernateSupport": "Enabled"
                            }
                        },
                        {
                            "type": "microsoft.devcenter/devcenters/devboxdefinitions",
                            "name": "[concat(parameters('devCenterName'), '/', parameters('devBoxDefinitionNameDelete'))]",
                            "location": "[parameters('location')]",
                            "apiVersion": "2024-05-01-preview",
                            "properties": {
                                "imageReference": {
                                    "id": "[parameters('imageReferenceId')]"
                                },
                                "sku": {
                                    "name": "[parameters('skuName')]"
                                },
                                "osStorageType": "[parameters('osStorageType')]",
                                "hibernateSupport": "Enabled"
                            }
                        },
                        {
                            "type": "microsoft.devcenter/devcenters/devboxdefinitions",
                            "name": "[concat(parameters('devCenterName'), '/', parameters('devBoxDefinitionNameDelete2'))]",
                            "location": "[parameters('location')]",
                            "apiVersion": "2024-05-01-preview",
                            "properties": {
                                "imageReference": {
                                    "id": "[parameters('imageReferenceId')]"
                                },
                                "sku": {
                                    "name": "[parameters('skuName')]"
                                },
                                "osStorageType": "[parameters('osStorageType')]",
                                "hibernateSupport": "Enabled"
                            }
                        },
                        {
                            "type": "microsoft.devcenter/devcenters/devboxdefinitions",
                            "name": "[concat(parameters('devCenterName'), '/', parameters('devBoxDefinitionUpdate'))]",
                            "location": "[parameters('location')]",
                            "apiVersion": "2024-05-01-preview",
                            "properties": {
                                "imageReference": {
                                    "id": "[parameters('imageReferenceId')]"
                                },
                                "sku": {
                                    "name": "[parameters('skuName')]"
                                },
                                "osStorageType": "[parameters('osStorageType')]",
                                "hibernateSupport": "Enabled"
                            }
                        },
                        {
                            "type": "microsoft.devcenter/devcenters/devboxdefinitions",
                            "name": "[concat(parameters('devCenterName'), '/', parameters('devBoxDefinitionSet'))]",
                            "location": "[parameters('location')]",
                            "apiVersion": "2024-05-01-preview",
                            "properties": {
                                "imageReference": {
                                    "id": "[parameters('imageReferenceId')]"
                                },
                                "sku": {
                                    "name": "[parameters('skuName')]"
                                },
                                "osStorageType": "[parameters('osStorageType')]",
                                "hibernateSupport": "Enabled"
                            }
                        },
                        {
                            "type": "microsoft.devcenter/devcenters/environmenttypes",
                            "name": "[concat(parameters('devCenterName'), '/', parameters('environmentTypeName'))]",
                            "apiVersion": "2024-05-01-preview"
                        },
                        {
                            "type": "microsoft.devcenter/devcenters/environmenttypes",
                            "name": "[concat(parameters('devCenterName'), '/', parameters('environmentTypeNameDelete'))]",
                            "apiVersion": "2024-05-01-preview"
                        },
                        {
                            "type": "microsoft.devcenter/devcenters/environmenttypes",
                            "name": "[concat(parameters('devCenterName'), '/', parameters('environmentTypeNameDelete2'))]",
                            "apiVersion": "2024-05-01-preview"
                        },
                        {
                            "type": "microsoft.devcenter/devcenters/environmenttypes",
                            "name": "[concat(parameters('devCenterName'), '/', parameters('projEnvironmentTypeNameDelete'))]",
                            "apiVersion": "2024-05-01-preview"
                        },
                        {
                            "type": "microsoft.devcenter/devcenters/environmenttypes",
                            "name": "[concat(parameters('devCenterName'), '/', parameters('projEnvironmentTypeNameDelete2'))]",
                            "apiVersion": "2024-05-01-preview"
                        },
                        {
                            "type": "microsoft.devcenter/devcenters/environmenttypes",
                            "name": "[concat(parameters('devCenterName'), '/', parameters('envForProjEnvTypeNew'))]",
                            "apiVersion": "2024-05-01-preview"
                        },
                        {
                            "type": "microsoft.devcenter/devcenters/environmenttypes",
                            "name": "[concat(parameters('devCenterName'), '/', parameters('envForProjEnvTypeNew2'))]",
                            "apiVersion": "2024-05-01-preview"
                        },
                        {
                            "type": "microsoft.devcenter/devcenters/environmenttypes",
                            "name": "[concat(parameters('devCenterName'), '/', parameters('environmentTypeSet'))]",
                            "apiVersion": "2024-05-01-preview"
                        },
                        {
                            "type": "microsoft.devcenter/devcenters/environmenttypes",
                            "name": "[concat(parameters('devCenterName'), '/', parameters('environmentTypeUpdate'))]",
                            "apiVersion": "2024-05-01-preview"
                        },
                        {
                            "type": "microsoft.devcenter/devcenters/environmenttypes",
                            "name": "[concat(parameters('devCenterName'), '/', parameters('projectEnvironmentTypeSet'))]",
                            "apiVersion": "2024-05-01-preview"
                        },
                        {
                            "type": "microsoft.devcenter/devcenters/environmenttypes",
                            "name": "[concat(parameters('devCenterName'), '/', parameters('projectEnvironmentTypeUpdate'))]",
                            "apiVersion": "2024-05-01-preview"
                        },
                        {
                            "type": "microsoft.devcenter/devcenters/galleries",
                            "name": "[concat(parameters('devCenterName'), '/', parameters('galleryName'))]",
                            "apiVersion": "2024-05-01-preview",
                            "properties": {
                                "galleryResourceId": "[parameters('sigId')]"
                            }
                        },
                        {
                            "type": "microsoft.devcenter/devcenters/galleries",
                            "name": "[concat(parameters('devCenterName'), '/', parameters('galleryNameDelete'))]",
                            "apiVersion": "2024-05-01-preview",
                            "properties": {
                                "galleryResourceId": "[resourceId('Microsoft.Compute/galleries', parameters('sigName2'))]"
                            }
                        },
                        {
                            "type": "microsoft.devcenter/devcenters/galleries",
                            "name": "[concat(parameters('devCenterName'), '/', parameters('galleryNameDelete2'))]",
                            "apiVersion": "2024-05-01-preview",
                            "properties": {
                                "galleryResourceId": "[resourceId('Microsoft.Compute/galleries', parameters('sigName3'))]"
                            }
                        }
                    ]
                }
            }
        },
        {
            "name": "createProjDependencies",
            "type": "Microsoft.Resources/deployments",
            "apiVersion": "2022-09-01",
            "subscriptionId": "[parameters('subscriptionId')]",
            "resourceGroup": "[parameters('resourceGroup')]",
            "dependsOn": [
                "[resourceId('Microsoft.Resources/deployments', 'createDcDependencies')]"
            ],
            "properties": {
                "mode": "Incremental",
                "template": {
                    "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                    "contentVersion": "1.0.0.0",
                    "resources": [
                        {
                            "type": "microsoft.devcenter/projects/pools",
                            "name": "[concat(parameters('projectName'), '/', parameters('poolName'))]",
                            "apiVersion": "2024-05-01-preview",
                            "location": "[parameters('location')]",
                            "properties": {
                                "devBoxDefinitionName": "[parameters('devBoxDefinitionName')]",
                                "networkConnectionName": "[parameters('attachedNetworkName')]",
                                "licenseType": "Windows_Client",
                                "localAdministrator": "Enabled",
                                "stopOnDisconnect": {
                                    "status": "Enabled",
                                    "gracePeriodMinutes": 60
                                }

                            }
                        },
                        {
                            "type": "microsoft.devcenter/projects/pools",
                            "name": "[concat(parameters('projectName'), '/', parameters('poolNameDelete'))]",
                            "apiVersion": "2024-05-01-preview",
                            "location": "[parameters('location')]",
                            "properties": {
                                "devBoxDefinitionName": "[parameters('devBoxDefinitionName')]",
                                "networkConnectionName": "[parameters('attachedNetworkName')]",
                                "licenseType": "Windows_Client",
                                "localAdministrator": "Enabled",
                                "stopOnDisconnect": {
                                    "status": "Enabled",
                                    "gracePeriodMinutes": 60
                                }

                            }
                        },
                        {
                            "type": "microsoft.devcenter/projects/pools",
                            "name": "[concat(parameters('projectName'), '/', parameters('poolNameDelete2'))]",
                            "apiVersion": "2024-05-01-preview",
                            "location": "[parameters('location')]",
                            "properties": {
                                "devBoxDefinitionName": "[parameters('devBoxDefinitionName')]",
                                "networkConnectionName": "[parameters('attachedNetworkName')]",
                                "licenseType": "Windows_Client",
                                "localAdministrator": "Enabled",
                                "stopOnDisconnect": {
                                    "status": "Enabled",
                                    "gracePeriodMinutes": 60
                                }

                            }
                        },
                        {
                            "type": "microsoft.devcenter/projects/pools",
                            "name": "[concat(parameters('projectName'), '/', parameters('poolForScheduleNew'))]",
                            "apiVersion": "2024-05-01-preview",
                            "location": "[parameters('location')]",
                            "properties": {
                                "devBoxDefinitionName": "[parameters('devBoxDefinitionName')]",
                                "networkConnectionName": "[parameters('attachedNetworkName')]",
                                "licenseType": "Windows_Client",
                                "localAdministrator": "Enabled",
                                "stopOnDisconnect": {
                                    "status": "Enabled",
                                    "gracePeriodMinutes": 60
                                }

                            }
                        },
                        {
                            "type": "microsoft.devcenter/projects/pools",
                            "name": "[concat(parameters('projectName'), '/', parameters('poolForScheduleNew2'))]",
                            "apiVersion": "2024-05-01-preview",
                            "location": "[parameters('location')]",
                            "properties": {
                                "devBoxDefinitionName": "[parameters('devBoxDefinitionName')]",
                                "networkConnectionName": "[parameters('attachedNetworkName')]",
                                "licenseType": "Windows_Client",
                                "localAdministrator": "Enabled",
                                "stopOnDisconnect": {
                                    "status": "Enabled",
                                    "gracePeriodMinutes": 60
                                }

                            }
                        },
                        {
                            "type": "microsoft.devcenter/projects/pools",
                            "name": "[concat(parameters('projectName'), '/', parameters('poolForScheduleDelete'))]",
                            "apiVersion": "2024-05-01-preview",
                            "location": "[parameters('location')]",
                            "properties": {
                                "devBoxDefinitionName": "[parameters('devBoxDefinitionName')]",
                                "networkConnectionName": "[parameters('attachedNetworkName')]",
                                "licenseType": "Windows_Client",
                                "localAdministrator": "Enabled",
                                "stopOnDisconnect": {
                                    "status": "Enabled",
                                    "gracePeriodMinutes": 60
                                }

                            }
                        },
                        {
                            "type": "microsoft.devcenter/projects/pools",
                            "name": "[concat(parameters('projectName'), '/', parameters('poolForScheduleDelete2'))]",
                            "apiVersion": "2024-05-01-preview",
                            "location": "[parameters('location')]",
                            "properties": {
                                "devBoxDefinitionName": "[parameters('devBoxDefinitionName')]",
                                "networkConnectionName": "[parameters('attachedNetworkName')]",
                                "licenseType": "Windows_Client",
                                "localAdministrator": "Enabled",
                                "stopOnDisconnect": {
                                    "status": "Enabled",
                                    "gracePeriodMinutes": 60
                                }

                            }
                        },
                        {
                            "type": "microsoft.devcenter/projects/pools",
                            "name": "[concat(parameters('projectName'), '/', parameters('poolSet'))]",
                            "apiVersion": "2024-05-01-preview",
                            "location": "[parameters('location')]",
                            "properties": {
                                "devBoxDefinitionName": "[parameters('devBoxDefinitionName')]",
                                "networkConnectionName": "[parameters('attachedNetworkName')]",
                                "licenseType": "Windows_Client",
                                "localAdministrator": "Enabled",
                                "stopOnDisconnect": {
                                    "status": "Enabled",
                                    "gracePeriodMinutes": 60
                                }

                            }
                        },
                        {
                            "type": "microsoft.devcenter/projects/pools",
                            "name": "[concat(parameters('projectName'), '/', parameters('poolUpdate'))]",
                            "apiVersion": "2024-05-01-preview",
                            "location": "[parameters('location')]",
                            "properties": {
                                "devBoxDefinitionName": "[parameters('devBoxDefinitionName')]",
                                "networkConnectionName": "[parameters('attachedNetworkName')]",
                                "licenseType": "Windows_Client",
                                "localAdministrator": "Enabled",
                                "stopOnDisconnect": {
                                    "status": "Enabled",
                                    "gracePeriodMinutes": 60
                                }

                            }
                        },
                        {
                            "type": "microsoft.devcenter/projects/pools",
                            "name": "[concat(parameters('projectName'), '/', parameters('scheduleSet'))]",
                            "apiVersion": "2024-05-01-preview",
                            "location": "[parameters('location')]",
                            "properties": {
                                "devBoxDefinitionName": "[parameters('devBoxDefinitionName')]",
                                "networkConnectionName": "[parameters('attachedNetworkName')]",
                                "licenseType": "Windows_Client",
                                "localAdministrator": "Enabled",
                                "stopOnDisconnect": {
                                    "status": "Enabled",
                                    "gracePeriodMinutes": 60
                                }

                            }
                        },
                        {
                            "type": "microsoft.devcenter/projects/pools",
                            "name": "[concat(parameters('projectName'), '/', parameters('scheduleUpdate'))]",
                            "apiVersion": "2024-05-01-preview",
                            "location": "[parameters('location')]",
                            "properties": {
                                "devBoxDefinitionName": "[parameters('devBoxDefinitionName')]",
                                "networkConnectionName": "[parameters('attachedNetworkName')]",
                                "licenseType": "Windows_Client",
                                "localAdministrator": "Enabled",
                                "stopOnDisconnect": {
                                    "status": "Enabled",
                                    "gracePeriodMinutes": 60
                                }

                            }
                        },
                        {
                            "type": "microsoft.devcenter/projects/environmenttypes",
                            "name": "[concat(parameters('projectName'), '/', parameters('environmentTypeName'))]",
                            "apiVersion": "2024-05-01-preview",
                            "properties": {
                                "deploymentTargetId": "[concat('/subscriptions/', parameters('subscriptionId'))]",
                                "status": "Enabled",
                                "creatorRoleAssignment": {
                                    "roles": {
                                        "8e3af657-a8ff-443c-a75c-2fe8c4bcb635": {}
                                    }
                                },
                                "userRoleAssignments": {
                                    "[reference(parameters('managedIdentityName')).principalId]": {
                                        "roles": {
                                            "8e3af657-a8ff-443c-a75c-2fe8c4bcb635": {}
                                        }
                                    }
                                }
                            },
                            "identity": {
                                "type": "UserAssigned",
                                "userAssignedIdentities": {
                                    "[resourceId('Microsoft.ManagedIdentity/userAssignedIdentities', parameters('managedIdentityName'))]": {}
                                }
                            }
                        },
                        {
                            "type": "microsoft.devcenter/projects/environmenttypes",
                            "name": "[concat(parameters('projectName'), '/', parameters('projEnvironmentTypeNameDelete'))]",
                            "apiVersion": "2024-05-01-preview",
                            "properties": {
                                "deploymentTargetId": "[concat('/subscriptions/', parameters('subscriptionId'))]",
                                "status": "Enabled",
                                "creatorRoleAssignment": {
                                    "roles": {
                                        "8e3af657-a8ff-443c-a75c-2fe8c4bcb635": {}
                                    }
                                },
                                "userRoleAssignments": {
                                    "[reference(parameters('managedIdentityName')).principalId]": {
                                        "roles": {
                                            "8e3af657-a8ff-443c-a75c-2fe8c4bcb635": {}
                                        }
                                    }
                                }
                            },
                            "identity": {
                                "type": "UserAssigned",
                                "userAssignedIdentities": {
                                    "[resourceId('Microsoft.ManagedIdentity/userAssignedIdentities', parameters('managedIdentityName'))]": {}
                                }
                            }
                        },
                        {
                            "type": "microsoft.devcenter/projects/environmenttypes",
                            "name": "[concat(parameters('projectName'), '/', parameters('projEnvironmentTypeNameDelete2'))]",
                            "apiVersion": "2024-05-01-preview",
                            "properties": {
                                "deploymentTargetId": "[concat('/subscriptions/', parameters('subscriptionId'))]",
                                "status": "Enabled",
                                "creatorRoleAssignment": {
                                    "roles": {
                                        "8e3af657-a8ff-443c-a75c-2fe8c4bcb635": {}
                                    }
                                },
                                "userRoleAssignments": {
                                    "[reference(parameters('managedIdentityName')).principalId]": {
                                        "roles": {
                                            "8e3af657-a8ff-443c-a75c-2fe8c4bcb635": {}
                                        }
                                    }
                                }
                            },
                            "identity": {
                                "type": "UserAssigned",
                                "userAssignedIdentities": {
                                    "[resourceId('Microsoft.ManagedIdentity/userAssignedIdentities', parameters('managedIdentityName'))]": {}
                                }
                            }
                        },
                        {
                            "type": "microsoft.devcenter/projects/environmenttypes",
                            "name": "[concat(parameters('projectName'), '/', parameters('projectEnvironmentTypeSet'))]",
                            "apiVersion": "2024-05-01-preview",
                            "properties": {
                                "deploymentTargetId": "[concat('/subscriptions/', parameters('subscriptionId'))]",
                                "status": "Enabled",
                                "creatorRoleAssignment": {
                                    "roles": {
                                        "8e3af657-a8ff-443c-a75c-2fe8c4bcb635": {}
                                    }
                                },
                                "userRoleAssignments": {
                                    "[reference(parameters('managedIdentityName')).principalId]": {
                                        "roles": {
                                            "8e3af657-a8ff-443c-a75c-2fe8c4bcb635": {}
                                        }
                                    }
                                }
                            },
                            "identity": {
                                "type": "UserAssigned",
                                "userAssignedIdentities": {
                                    "[resourceId('Microsoft.ManagedIdentity/userAssignedIdentities', parameters('managedIdentityName'))]": {}
                                }
                            }
                        },
                        {
                            "type": "microsoft.devcenter/projects/environmenttypes",
                            "name": "[concat(parameters('projectName'), '/', parameters('projectEnvironmentTypeUpdate'))]",
                            "apiVersion": "2024-05-01-preview",
                            "properties": {
                                "deploymentTargetId": "[concat('/subscriptions/', parameters('subscriptionId'))]",
                                "status": "Enabled",
                                "creatorRoleAssignment": {
                                    "roles": {
                                        "8e3af657-a8ff-443c-a75c-2fe8c4bcb635": {}
                                    }
                                },
                                "userRoleAssignments": {
                                    "[reference(parameters('managedIdentityName')).principalId]": {
                                        "roles": {
                                            "8e3af657-a8ff-443c-a75c-2fe8c4bcb635": {}
                                        }
                                    }
                                }
                            },
                            "identity": {
                                "type": "UserAssigned",
                                "userAssignedIdentities": {
                                    "[resourceId('Microsoft.ManagedIdentity/userAssignedIdentities', parameters('managedIdentityName'))]": {}
                                }
                            }
                        },
                        {
                            "type": "microsoft.devcenter/projects/pools/schedules",
                            "name": "[concat(parameters('projectName'), '/', parameters('poolName'), '/default')]",
                            "apiVersion": "2024-05-01-preview",
                            "properties": {
                                "frequency": "Daily",
                                "state": "Enabled",
                                "time": "18:30",
                                "timeZone": "America/Los_Angeles",
                                "type": "StopDevBox"
                            },
                            "dependsOn": [
                                "[resourceId('Microsoft.DevCenter/projects/pools', parameters('projectName'), parameters('poolName'))]"
                            ]
                        },
                        {
                            "type": "microsoft.devcenter/projects/pools/schedules",
                            "name": "[concat(parameters('projectName'), '/', parameters('poolForScheduleDelete'), '/default')]",
                            "apiVersion": "2024-05-01-preview",
                            "properties": {
                                "frequency": "Daily",
                                "state": "Enabled",
                                "time": "18:30",
                                "timeZone": "America/Los_Angeles",
                                "type": "StopDevBox"
                            },
                            "dependsOn": [
                                "[resourceId('Microsoft.DevCenter/projects/pools', parameters('projectName'), parameters('poolForScheduleDelete'))]"
                            ]
                        },
                        {
                            "type": "microsoft.devcenter/projects/pools/schedules",
                            "name": "[concat(parameters('projectName'), '/', parameters('poolForScheduleDelete2'), '/default')]",
                            "apiVersion": "2024-05-01-preview",
                            "properties": {
                                "frequency": "Daily",
                                "state": "Enabled",
                                "time": "18:30",
                                "timeZone": "America/Los_Angeles",
                                "type": "StopDevBox"
                            },
                            "dependsOn": [
                                "[resourceId('Microsoft.DevCenter/projects/pools', parameters('projectName'), parameters('poolForScheduleDelete2'))]"
                            ]
                        },
                        {
                            "type": "microsoft.devcenter/projects/pools/schedules",
                            "name": "[concat(parameters('projectName'), '/', parameters('scheduleSet'), '/default')]",
                            "apiVersion": "2024-05-01-preview",
                            "properties": {
                                "frequency": "Daily",
                                "state": "Enabled",
                                "time": "18:30",
                                "timeZone": "America/Los_Angeles",
                                "type": "StopDevBox"
                            },
                            "dependsOn": [
                                "[resourceId('Microsoft.DevCenter/projects/pools', parameters('projectName'), parameters('scheduleSet'))]"
                            ]
                        },
                        {
                            "type": "microsoft.devcenter/projects/pools/schedules",
                            "name": "[concat(parameters('projectName'), '/', parameters('scheduleUpdate'), '/default')]",
                            "apiVersion": "2024-05-01-preview",
                            "properties": {
                                "frequency": "Daily",
                                "state": "Enabled",
                                "time": "18:30",
                                "timeZone": "America/Los_Angeles",
                                "type": "StopDevBox"
                            },
                            "dependsOn": [
                                "[resourceId('Microsoft.DevCenter/projects/pools', parameters('projectName'), parameters('scheduleUpdate'))]"
                            ]
                        }
                    ]
                }
            }
        }

    ],
    "outputs": {}
}