<!-- region Generated -->
# Az.CloudHsm
This directory contains the PowerShell module for the CloudHsm service.

---
## Info
- Modifiable: yes
- Generated: all
- Committed: yes
- Packaged: yes

---
## Detail
This module was primarily generated via [AutoRest](https://github.com/Azure/autorest) using the [PowerShell](https://github.com/Azure/autorest.powershell) extension.

## Module Requirements
- [Az.Accounts module](https://www.powershellgallery.com/packages/Az.Accounts/), version 2.7.5 or greater

## Authentication
AutoRest does not generate authentication code for the module. Authentication is handled via Az.Accounts by altering the HTTP payload before it is sent.

## Development
For information on how to develop for `Az.CloudHsm`, see [how-to.md](how-to.md).
<!-- endregion -->

### AutoRest Configuration

> see https://aka.ms/autorest

```yaml
# pin the swagger version by using the commit id instead of branch name
commit: 55cb134eeb9f92c8df1f6437a9e1130c4c2c4cc5
require:
# readme.azure.noprofile.md is the common configuration file
  - $(this-folder)/../../readme.azure.noprofile.md
  #- $(repo)/specification/xxx/resource-manager/readme.md
# If the swagger has not been put in the repo, you may uncomment the following line and refer to it locally
# - (this-folder)/relative-path-to-your-local-readme.md

input-file: 
    - $(repo)/specification/hardwaresecuritymodules/resource-manager/Microsoft.HardwareSecurityModules/stable/2025-03-31/cloudhsm.json
try-require: 
  - $(repo)/specification/hardwaresecuritymodules/resource-manager/readme.powershell.md

# For new RP, the version is 0.1.0
module-version: 0.1.0
# Normally, title is the service name
title: CloudHsm

# The next three configurations are exclusive to v3, and in v4, they are activated by default. If you are still using v3, please uncomment them.
# identity-correction-for-post: true
# resourcegroup-append: true
# nested-object-to-string: true

directive:
  # Following are common directives which are normally required in all the RPs
  # 1. Remove the unexpanded parameter set
  # 2. For New-* cmdlets, ViaIdentity is not required
  # Following two directives are v4 specific
  - where:
      variant: ^(Create|Update)(?!.*?(Expanded))
    remove: true
  - where:
      variant: ^CreateViaIdentity$|^CreateViaIdentityExpanded$|^UpdateViaIdentityExpanded$|^CreateViaJsonString$|^CreateViaJsonFilePath$
    remove: true
  # Follow directive is v3 specific. If you are using v3, uncomment following directive and comments out two directives above
  #- where:
  #    variant: ^Create$|^CreateViaIdentity$|^CreateViaIdentityExpanded$|^Update$|^UpdateViaIdentity$
  #  remove: true

  #Remove ViaIdentity, ViaIdentityExpaned, JsonString and JsonFilePath commands 
  - where:
      variant: ^(Backup|BackupViaIdentityExpanded|Restore|RestoreViaIdentityExpanded|GetViaIdentity|DeleteViaIdentity)(?!.*?(Expanded))
    remove: true

  # Remove the set-* cmdlet
  - where:
      verb: Set
    remove: true

  # Remove the Private Endpoint cmdlet that are autogenerated
  - where:
      subject: PrivateEndpointConnection|PrivateLinkResource
    remove: true

    # Remove the Private Endpoint cmdlet that are autogenerated
  - where:
      verb: Test
    remove: true

    # Remove SkuCapacity, EnableSystemAssignedIdentity, PublicNetworkAccess and Token parameters from all commansd
  - where:
      parameter-name: SkuCapacity|EnableSystemAssignedIdentity|PublicNetworkAccess|Token
    hide: true

    # Rename CloudHsmClusterName parameter to Name.
  - where:
      parameter-name: CloudHsmClusterName
    set:
     parameter-name: Name
 
    # Both commands have property EnableSystemAssignedIdentity as mandatory because in Swaggger spec we specify ManagedIdentity which by default has Both User and System Assign Identity Enums. 
    # Our service only allows UserAssign Identity and to remove the extra property EnableSystemAssignedIdentity we need to: 
    # 1. Hide New and Update commands. 
    # 2. Get the internal version of the commands from CloudHsm.Autorest/internal/
    # 3. Copy the files to CloudHsm.Autorest/internal
    # 4. Remove the extra property and build

  - where:
      verb: ^New$|^Update$|^Get$|^Backup$|^Restore$|^Get$|^Remove$
    hide: true

    # Make SKU parameter required for New-AzCloudHsm command 
  - where:
      verb: ^New$
      parameter-name: SkuName
      required: true
    set:
      parameter-name: Sku
      default: 
        script: '"Standard_B1"'

    # Rename Backup, Restore, New, Update and Remove commands to remove 'Cluster' prefix from the command name. ex: New-AzCloudHsmCluster to New-AzCloudHsm
  - where:
      verb: ^Backup$|^Restore$|^New$|^Update$|^Remove$
      subject: ''
    set:
      subject-prefix: ''
      subject: CloudHsm

    # Rename Backup, Restore, New, Update and Remove commands to remove 'Cluster' prefix from the command name. ex: New-AzCloudHsmCluster to New-AzCloudHsm
  - where:
      verb: ^Backup$|^Restore$
      parameter-name: Name
    set:
      parameter-name: ClusterName

    # Rename name property of Backup, Restore commands
  - where:
      verb: ^Backup$|^Restore$
      subject: ''
      parameter-name: Name
    set:
      parameter-name: SkuName

    # Rename property in backup and restore commands 
  - where:
      verb: ^Backup$|^Restore$
      subject: ''
      parameter-name: AzureStorageBlobContainerUri
    set:
      parameter-name: BlobContainerUri
  
    # Rename Get-CloudHsmClusterBackupStatus commands to Get-CloudHsmBackupStatus
  - where: 
      verb: ^Get$
      subject: CloudHsmClusterBackupStatus
    remove: true

    # Rename Get-CloudHsmClusterRestoreStatus commands to Get-CloudHsmRestoreStatus
  - where: 
      verb: ^Get$
      subject: CloudHsmClusterRestoreStatus
    remove: true
  
    # Rename Get-CloudHsmCluster commands to Get-CloudHsm
  - where: 
      verb: ^Get$
      subject: CloudHsmCluster
    set:
      subject-prefix: ''
      subject: CloudHsm

  - where:
      parameter-name: SkuName
    set:
      parameter-name: Sku

  - where: 
      verb: Update
      parameter-name: AutoGeneratedDomainNameLabelScope
    hide: true

  - where: 
      parameter-name: AutoGeneratedDomainNameLabelScope
    set:
      parameter-name: DomainNameLabelScope

```
