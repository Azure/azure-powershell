# Breaking Changes Attribute Help

Below are descriptionsof the various types of Breaking Change Attributes (custom attributes) that can be used to decorate the cmdlet or its paramters to call out various [types of deprecations](https://github.com/praries880/azure-powershell/blob/breakingchangeattribute/documentation/breaking-changes/breaking-changes-definition.md).

## The different types of attributes

- [Common stuff](#common-stuff)
- [Cmdlet deprecation marker attribute](#cmdletdeprecationmarkerattribute)

## Common stuff

All of the attributes have the following common traits:
- The attribute (when added to the cmdlet/parameter of the cmdlet) is used for the following purposes
  - At runtime, if the cmdlet is used, we will print out a message for each breaking change attribute present in the cmdlet and its properties.
  - We use these attributes to generate the breaking change document for the cmdlet.
- Each attribute has two additional constructors thet take the following params in addition to the ones the attribute mentions:
  - The "deprecatedByVersion" is the version number the breaking change is going to be done in.
  - The "changeInEfectByDate" is the date the breaking change is goind to go in effet on. The string formati is "mm/dd/yyyy", as an example : "02/25/2018"
- Each attribute accepts these two properties by name (you cant have one or the other, you need to speciffy both for the usage message to be generated) :
   - OldWay : The way to call the cmdlet before the breaking change takes effect
   - NewWay : If there is a workaround to the breaking change, or if the same functionality can be achieved in another manner

The properties "deprecatedByVersion" and "changeInEfectByDate" are infotmation only (for the end user) as of now.

- If the user desires to not see the warning messages generated by the attirbutes at runtime, they can set the env variable "SuppressAzurePowerShellBreakingChangeWarnings" to "true".


### Examples
With "deprecatedByVersion"
```cs
    [AttributeName(param1, param2, "5.0.0.0")]
    class AzureRMTestCmdletWithChangeAttribute : AzureRMCmdlet
    {

    }
```

With "deprecatedByVersion" and "changeInEfectByDate"
```cs
    [AttributeName(param1, param2, "5.0.0.0", "02/13/2018")]
    class AzureRMTestCmdletWithChangeAttribute : AzureRMCmdlet
    {

    }
```

With OldWay/NewWay
```cs
    [AttributeName(param1, param2, OldWay = "Get-SomeObjectD -Param1=\"blah\"", NewWay = "Get-SomeObjectE -Param1=\"blah\" -Param2=\"Yo Yo\"")]
    class AzureRMTestCmdletWithMetadataChangeAttribute : AzureRMCmdlet
    {

    }
```

## CmdletDeprecationMarkerAttribute

This attribute marks a cmdlet for deprecation.

### Usage

#### When there is a replacement cmdlet for the one that is being deprecated :
```cs
[CmdletDeprecationMarker("Get-SomeObjectA", "Get-SomeObjectC")]
[Cmdlet(VerbsCommon.Get, "SomeObjectA"), OutputType(typeof(Foo))]
public class GetSomeObjectA : Cmdlet
{
    protected override void BeginProcessing()
    {
        // cmdlet logic
    }
}
```

#### When there is no replacement cmdlet
```cs
[CmdletDeprecationMarker("Get-SomeObjectB")]
[Cmdlet(VerbsCommon.Get, "SomeObjectB"), OutputType(typeof(Foo))]
public class GetSomeObjectB : AzureRMCmdlet
{
    protected override void BeginProcessing()
    {
        // cmdlet logic
    }
}
```

#### When there is a deprecation in effect version specified :
```cs
[CmdletDeprecationMarker("Get-SomeObjectD", "Get-SomeObjectC", "5.0.0.0")]
[Cmdlet(VerbsCommon.Get, "SomeObjectD"), OutputType(typeof(Foo))]
public class GetSomeObjectE : Cmdlet
{
    protected override void BeginProcessing()
    {
        // cmdlet logic
    }
}
```

#### When there is a deprecation in effect version and date specified :
```cs
[CmdletDeprecationMarker("Get-SomeObjectE", "Get-SomeObjectC", "5.0.0.0", "02/13/2018")]
[Cmdlet(VerbsCommon.Get, "SomeObjectE"), OutputType(typeof(Foo))]
public class GetSomeObjectA : Cmdlet
{
    protected override void BeginProcessing()
    {
        // cmdlet logic
    }
}
```

### Effect at runtime

When a cmdlet with the "CmdletDeprecationMarker" attribute added is run the following output is generated on the console at runtime :

#### Attribute specified with a replacement cmdlet:
```powershell
Get-SomeObjectA <parms here>
...
The cmdlet 'Get-SomeObjectC' is replacing the cmdlet'Get-SomeObjectA'
```

#### Attribute specified without a replacement:
```powershell
Get-SomeObjectB <params here>
...
The cmdlet 'Get-SomeObjectB' is beind deprecated. There will be no replacement for it.
```

#### Attribute specified with a replacement cmdlet and a deprecation in effect version specified:
```powershell
Get-SomeObjectD <parms here>
...
The cmdlet 'Get-SomeObjectC' is replacing the cmdlet'Get-SomeObjectD'
The change is expected to take effect from the version : 5.0.0.0
```

#### Attribute specified with a replacement cmdlet and a deprecation in effect version and date specified:
```powershell
Get-SomeObjectD <parms here>
...
The cmdlet 'Get-SomeObjectC' is replacing the cmdlet'Get-SomeObjectD'
NOTE : This change will take effect on '02/13/2018'
The change is expected to take effect from the version : 5.0.0.0
```

## CmdletMetadataChangeMarkerAttribute
This attribute can be used to mark changes with the metadata in the cmdlet. For e.g. if a parameter set is being expired in a cmdlet.

### Usage
#### Vanilla
```cs
[CmdletMetadataChangeMarker("Get-SomeObjectA", "Parameterset1", "Parameterset1 is being deprecated")]
[Cmdlet(VerbsCommon.Get, "SomeObjectA"), OutputType(typeof(Foo))]
public class GetSomeObjectA : Cmdlet
{
    protected override void BeginProcessing()
    {
        // cmdlet logic
    }
}
```

#### When there is a deprecation in effect version specified :
```cs
[CmdletMetadataChangeMarker("Get-SomeObjectB", "Parameterset1", "Parameterset1 is being deprecated", "5.0.0.0")]
[Cmdlet(VerbsCommon.Get, "SomeObjectB"), OutputType(typeof(Foo))]
public class GetSomeObjectA : Cmdlet
{
    protected override void BeginProcessing()
    {
        // cmdlet logic
    }
}
```

#### When there is a deprecation in effect version and date specified :
```cs
[CmdletMetadataChangeMarker("Get-SomeObjectC", "Parameterset1", "Parameterset1 is being deprecated", "5.0.0.0", "02/13/2018")]
[Cmdlet(VerbsCommon.Get, "SomeObjectC"), OutputType(typeof(Foo))]
public class GetSomeObjectA : Cmdlet
{
    protected override void BeginProcessing()
    {
        // cmdlet logic
    }
}
```

### Effect at runtime
When a cmdlet with the "CmdletMetadataChangeMarkerAttribute" attribute added is run the following output is generated on the console at runtime :

#### Vanilla
```powershell
Get-SomeObjectA <parms here>
...
The cmdlet 'Get-SomeObjectA'  has the following change to the metadata  'Parameterset1' :
    Parameterset1 is being deprecated
```

#### Attribute specified with a deprecation in effect version specified:
```powershell
Get-SomeObjectB <parms here>
...
The cmdlet 'Get-SomeObjectB'  has the following change to the metadata  'Parameterset1' :
    Parameterset1 is being deprecated
The change is expected to take effect from the version : 5.0.0.0
```

#### Attribute specified with a deprecation in effect version and date specified:
```powershell
Get-SomeObjectC <parms here>
...
The cmdlet 'Get-SomeObjectC'  has the following change to the metadata  'Parameterset1' :
    Parameterset1 is being deprecated
NOTE : This change will take effect on '02/13/2018'
The change is expected to take effect from the version : 5.0.0.0
```